<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png"><link rel="icon" href="/img/favicon.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="Fulequn"><meta name="keywords" content=""><meta name="description" content="原文链接：https:&#x2F;&#x2F;blog.csdn.net&#x2F;wangshuang1631&#x2F;article&#x2F;details&#x2F;52276189 本文是对官方网站上《10 Minutes to pandas》的一个简单的翻译，原文地址是：http:&#x2F;&#x2F;pandas.pydata.org&#x2F;pandas-docs&#x2F;stable&#x2F;10min.html 这篇文章是对pandas的一个简单的介绍，由于出身非英语专业，错"><meta property="og:type" content="article"><meta property="og:title" content="10 Minutes to pandas----十分钟搞定Pandas"><meta property="og:url" content="https://fulequn.github.io/2020/08/Article202008221/index.html"><meta property="og:site_name" content="FuLeQun&#39;s Blog"><meta property="og:description" content="原文链接：https:&#x2F;&#x2F;blog.csdn.net&#x2F;wangshuang1631&#x2F;article&#x2F;details&#x2F;52276189 本文是对官方网站上《10 Minutes to pandas》的一个简单的翻译，原文地址是：http:&#x2F;&#x2F;pandas.pydata.org&#x2F;pandas-docs&#x2F;stable&#x2F;10min.html 这篇文章是对pandas的一个简单的介绍，由于出身非英语专业，错"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306212026632.png"><meta property="og:image" content="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306212026633.png"><meta property="article:published_time" content="2020-08-22T12:51:05.000Z"><meta property="article:modified_time" content="2024-05-30T00:16:16.000Z"><meta property="article:author" content="Fulequn"><meta property="article:tag" content="Python"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306212026632.png"><title>10 Minutes to pandas----十分钟搞定Pandas - FuLeQun&#39;s Blog</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var CONFIG={hostname:"fulequn.github.io",root:"/",version:"1.9.7",typing:{enable:!0,typeSpeed:60,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!1,follow_dnt:!0,baidu:null,google:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1},gtag:null,tajs:null},search_path:"/local-search.xml",include_content_in_search:!0};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css"><meta name="generator" content="Hexo 7.3.0"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>FuLeQun&#39;s Blog</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/" target="_self"><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/" target="_self"><i class="iconfont icon-archive-fill"></i> <span>归档</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/" target="_self"><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/" target="_self"><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class="nav-item"><a class="nav-link" href="/about/" target="_self"><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/default.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="10 Minutes to pandas----十分钟搞定Pandas"></span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2020-08-22 20:51" pubdate>2020年8月22日 晚上</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i>5.4k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i>46 分钟</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 id="seo-header">10 Minutes to pandas----十分钟搞定Pandas</h1><div class="markdown-body"><p>原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/wangshuang1631/article/details/52276189">https://blog.csdn.net/wangshuang1631/article/details/52276189</a></p><p>本文是对官方网站上《10 Minutes to pandas》的一个简单的翻译，原文地址是：<a target="_blank" rel="noopener" href="http://pandas.pydata.org/pandas-docs/stable/10min.html">http://pandas.pydata.org/pandas-docs/stable/10min.html</a></p><p>这篇文章是对pandas的一个简单的介绍，由于出身非英语专业，错误在所难免，还望指正。</p><p><strong>中肯建议：英语水平只要是还说的过去的，建议看官方文档，翻译的毕竟和原文有出入！！！</strong></p><p>习惯上，我们会按下面格式引入所需要的包：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">1</span>]: <span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><br>In [<span class="hljs-number">2</span>]: <span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br>In [<span class="hljs-number">3</span>]: <span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br></code></pre></td></tr></table></figure><h2 id="一-创建对象"><a class="markdownIt-Anchor" href="#一-创建对象"></a> 一、创建对象</h2><p>1、可以通过传递一个list对象来创建一个Series，pandas会默认创建整型索引：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">4</span>]: s = pd.Series([<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,np.nan,<span class="hljs-number">6</span>,<span class="hljs-number">8</span>])<br><br>In [<span class="hljs-number">5</span>]: s<br>Out[<span class="hljs-number">5</span>]: <br><span class="hljs-number">0</span>    <span class="hljs-number">1.0</span><br><span class="hljs-number">1</span>    <span class="hljs-number">3.0</span><br><span class="hljs-number">2</span>    <span class="hljs-number">5.0</span><br><span class="hljs-number">3</span>    NaN<br><span class="hljs-number">4</span>    <span class="hljs-number">6.0</span><br><span class="hljs-number">5</span>    <span class="hljs-number">8.0</span><br>dtype: float64<br></code></pre></td></tr></table></figure><p>2、通过传递一个numpy array，时间索引以及列标签来创建一个DataFrame：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">6</span>]: dates = pd.date_range(<span class="hljs-string">&#x27;20130101&#x27;</span>, periods=<span class="hljs-number">6</span>)<br><br>In [<span class="hljs-number">7</span>]: dates<br>Out[<span class="hljs-number">7</span>]: <br>DatetimeIndex([<span class="hljs-string">&#x27;2013-01-01&#x27;</span>, <span class="hljs-string">&#x27;2013-01-02&#x27;</span>, <span class="hljs-string">&#x27;2013-01-03&#x27;</span>, <span class="hljs-string">&#x27;2013-01-04&#x27;</span>,<br>               <span class="hljs-string">&#x27;2013-01-05&#x27;</span>, <span class="hljs-string">&#x27;2013-01-06&#x27;</span>],<br>              dtype=<span class="hljs-string">&#x27;datetime64[ns]&#x27;</span>, freq=<span class="hljs-string">&#x27;D&#x27;</span>)<br><br>In [<span class="hljs-number">8</span>]: df = pd.DataFrame(np.random.randn(<span class="hljs-number">6</span>,<span class="hljs-number">4</span>), index=dates, columns=<span class="hljs-built_in">list</span>(<span class="hljs-string">&#x27;ABCD&#x27;</span>))<br><br>In [<span class="hljs-number">9</span>]: df<br>Out[<span class="hljs-number">9</span>]: <br>                   A         B         C         D<br><span class="hljs-number">2013</span>-01-01  <span class="hljs-number">0.469112</span> -<span class="hljs-number">0.282863</span> -<span class="hljs-number">1.509059</span> -<span class="hljs-number">1.135632</span><br><span class="hljs-number">2013</span>-01-02  <span class="hljs-number">1.212112</span> -<span class="hljs-number">0.173215</span>  <span class="hljs-number">0.119209</span> -<span class="hljs-number">1.044236</span><br><span class="hljs-number">2013</span>-01-03 -<span class="hljs-number">0.861849</span> -<span class="hljs-number">2.104569</span> -<span class="hljs-number">0.494929</span>  <span class="hljs-number">1.071804</span><br><span class="hljs-number">2013</span>-01-04  <span class="hljs-number">0.721555</span> -<span class="hljs-number">0.706771</span> -<span class="hljs-number">1.039575</span>  <span class="hljs-number">0.271860</span><br><span class="hljs-number">2013</span>-01-05 -<span class="hljs-number">0.424972</span>  <span class="hljs-number">0.567020</span>  <span class="hljs-number">0.276232</span> -<span class="hljs-number">1.087401</span><br><span class="hljs-number">2013</span>-01-06 -<span class="hljs-number">0.673690</span>  <span class="hljs-number">0.113648</span> -<span class="hljs-number">1.478427</span>  <span class="hljs-number">0.524988</span><br></code></pre></td></tr></table></figure><p>3、通过传递一个能够被转换成类似序列结构的字典对象来创建一个DataFrame：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">10</span>]: df2 = pd.DataFrame(&#123; <span class="hljs-string">&#x27;A&#x27;</span> : <span class="hljs-number">1.</span>,<br>   ....:                      <span class="hljs-string">&#x27;B&#x27;</span> : pd.Timestamp(<span class="hljs-string">&#x27;20130102&#x27;</span>),<br>   ....:                      <span class="hljs-string">&#x27;C&#x27;</span> : pd.Series(<span class="hljs-number">1</span>,index=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)),dtype=<span class="hljs-string">&#x27;float32&#x27;</span>),<br>   ....:                      <span class="hljs-string">&#x27;D&#x27;</span> : np.array([<span class="hljs-number">3</span>] * <span class="hljs-number">4</span>,dtype=<span class="hljs-string">&#x27;int32&#x27;</span>),<br>   ....:                      <span class="hljs-string">&#x27;E&#x27;</span> : pd.Categorical([<span class="hljs-string">&quot;test&quot;</span>,<span class="hljs-string">&quot;train&quot;</span>,<span class="hljs-string">&quot;test&quot;</span>,<span class="hljs-string">&quot;train&quot;</span>]),<br>   ....:                      <span class="hljs-string">&#x27;F&#x27;</span> : <span class="hljs-string">&#x27;foo&#x27;</span> &#125;)<br>   ....: <br><br>In [<span class="hljs-number">11</span>]: df2<br>Out[<span class="hljs-number">11</span>]: <br>     A          B    C  D      E    F<br><span class="hljs-number">0</span>  <span class="hljs-number">1.0</span> <span class="hljs-number">2013</span>-01-02  <span class="hljs-number">1.0</span>  <span class="hljs-number">3</span>   test  foo<br><span class="hljs-number">1</span>  <span class="hljs-number">1.0</span> <span class="hljs-number">2013</span>-01-02  <span class="hljs-number">1.0</span>  <span class="hljs-number">3</span>  train  foo<br><span class="hljs-number">2</span>  <span class="hljs-number">1.0</span> <span class="hljs-number">2013</span>-01-02  <span class="hljs-number">1.0</span>  <span class="hljs-number">3</span>   test  foo<br><span class="hljs-number">3</span>  <span class="hljs-number">1.0</span> <span class="hljs-number">2013</span>-01-02  <span class="hljs-number">1.0</span>  <span class="hljs-number">3</span>  train  foo<br></code></pre></td></tr></table></figure><p>4、查看不同列的数据类型：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">12</span>]: df2.dtypes<br>Out[<span class="hljs-number">12</span>]: <br>A           float64<br>B    datetime64[ns]<br>C           float32<br>D             int32<br>E          category<br>F            <span class="hljs-built_in">object</span><br>dtype: <span class="hljs-built_in">object</span><br></code></pre></td></tr></table></figure><p>5、如果你使用的是IPython，使用Tab自动补全功能会自动识别所有的属性以及自定义的列，下图中是所有能够被自动识别的属性的一个子集：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs stylus">In <span class="hljs-selector-attr">[13]</span>: df2.&lt;TAB&gt;<br>df2<span class="hljs-selector-class">.A</span>                  df2<span class="hljs-selector-class">.boxplot</span><br>df2<span class="hljs-selector-class">.abs</span>                df2<span class="hljs-selector-class">.C</span><br>df2<span class="hljs-selector-class">.add</span>                df2<span class="hljs-selector-class">.clip</span><br>df2<span class="hljs-selector-class">.add_prefix</span>         df2<span class="hljs-selector-class">.clip_lower</span><br>df2<span class="hljs-selector-class">.add_suffix</span>         df2<span class="hljs-selector-class">.clip_upper</span><br>df2<span class="hljs-selector-class">.align</span>              df2<span class="hljs-selector-class">.columns</span><br>df2<span class="hljs-selector-class">.all</span>                df2<span class="hljs-selector-class">.combine</span><br>df2<span class="hljs-selector-class">.any</span>                df2<span class="hljs-selector-class">.combineAdd</span><br>df2<span class="hljs-selector-class">.append</span>             df2<span class="hljs-selector-class">.combine_first</span><br>df2<span class="hljs-selector-class">.apply</span>              df2<span class="hljs-selector-class">.combineMult</span><br>df2<span class="hljs-selector-class">.applymap</span>           df2<span class="hljs-selector-class">.compound</span><br>df2<span class="hljs-selector-class">.as_blocks</span>          df2<span class="hljs-selector-class">.consolidate</span><br>df2<span class="hljs-selector-class">.asfreq</span>             df2<span class="hljs-selector-class">.convert_objects</span><br>df2<span class="hljs-selector-class">.as_matrix</span>          df2<span class="hljs-selector-class">.copy</span><br>df2<span class="hljs-selector-class">.astype</span>             df2<span class="hljs-selector-class">.corr</span><br>df2<span class="hljs-selector-class">.at</span>                 df2<span class="hljs-selector-class">.corrwith</span><br>df2<span class="hljs-selector-class">.at_time</span>            df2<span class="hljs-selector-class">.count</span><br>df2<span class="hljs-selector-class">.axes</span>               df2<span class="hljs-selector-class">.cov</span><br>df2<span class="hljs-selector-class">.B</span>                  df2<span class="hljs-selector-class">.cummax</span><br>df2<span class="hljs-selector-class">.between_time</span>       df2<span class="hljs-selector-class">.cummin</span><br>df2<span class="hljs-selector-class">.bfill</span>              df2<span class="hljs-selector-class">.cumprod</span><br>df2<span class="hljs-selector-class">.blocks</span>             df2<span class="hljs-selector-class">.cumsum</span><br>df2<span class="hljs-selector-class">.bool</span>               df2.D<br></code></pre></td></tr></table></figure><p>正如你所看到的,列A,B,C,D的标签自动生成，E的也是。而其余的属性已经做了简要的截断。</p><h2 id="二-查看数据"><a class="markdownIt-Anchor" href="#二-查看数据"></a> 二、查看数据</h2><p>1、 查看frame中头部和尾部的行：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">14</span>]: df.head()<br>Out[<span class="hljs-number">14</span>]: <br>                   A         B         C         D<br><span class="hljs-number">2013</span>-01-01  <span class="hljs-number">0.469112</span> -<span class="hljs-number">0.282863</span> -<span class="hljs-number">1.509059</span> -<span class="hljs-number">1.135632</span><br><span class="hljs-number">2013</span>-01-02  <span class="hljs-number">1.212112</span> -<span class="hljs-number">0.173215</span>  <span class="hljs-number">0.119209</span> -<span class="hljs-number">1.044236</span><br><span class="hljs-number">2013</span>-01-03 -<span class="hljs-number">0.861849</span> -<span class="hljs-number">2.104569</span> -<span class="hljs-number">0.494929</span>  <span class="hljs-number">1.071804</span><br><span class="hljs-number">2013</span>-01-04  <span class="hljs-number">0.721555</span> -<span class="hljs-number">0.706771</span> -<span class="hljs-number">1.039575</span>  <span class="hljs-number">0.271860</span><br><span class="hljs-number">2013</span>-01-05 -<span class="hljs-number">0.424972</span>  <span class="hljs-number">0.567020</span>  <span class="hljs-number">0.276232</span> -<span class="hljs-number">1.087401</span><br><br>In [<span class="hljs-number">15</span>]: df.tail(<span class="hljs-number">3</span>)<br>Out[<span class="hljs-number">15</span>]: <br>                   A         B         C         D<br><span class="hljs-number">2013</span>-01-04  <span class="hljs-number">0.721555</span> -<span class="hljs-number">0.706771</span> -<span class="hljs-number">1.039575</span>  <span class="hljs-number">0.271860</span><br><span class="hljs-number">2013</span>-01-05 -<span class="hljs-number">0.424972</span>  <span class="hljs-number">0.567020</span>  <span class="hljs-number">0.276232</span> -<span class="hljs-number">1.087401</span><br><span class="hljs-number">2013</span>-01-06 -<span class="hljs-number">0.673690</span>  <span class="hljs-number">0.113648</span> -<span class="hljs-number">1.478427</span>  <span class="hljs-number">0.524988</span><br></code></pre></td></tr></table></figure><p>2、 显示索引、列和底层的numpy数据：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">16</span>]: df.index<br>Out[<span class="hljs-number">16</span>]: <br>DatetimeIndex([<span class="hljs-string">&#x27;2013-01-01&#x27;</span>, <span class="hljs-string">&#x27;2013-01-02&#x27;</span>, <span class="hljs-string">&#x27;2013-01-03&#x27;</span>, <span class="hljs-string">&#x27;2013-01-04&#x27;</span>,<br>               <span class="hljs-string">&#x27;2013-01-05&#x27;</span>, <span class="hljs-string">&#x27;2013-01-06&#x27;</span>],<br>              dtype=<span class="hljs-string">&#x27;datetime64[ns]&#x27;</span>, freq=<span class="hljs-string">&#x27;D&#x27;</span>)<br><br>In [<span class="hljs-number">17</span>]: df.columns<br>Out[<span class="hljs-number">17</span>]: Index([<span class="hljs-string">u&#x27;A&#x27;</span>, <span class="hljs-string">u&#x27;B&#x27;</span>, <span class="hljs-string">u&#x27;C&#x27;</span>, <span class="hljs-string">u&#x27;D&#x27;</span>], dtype=<span class="hljs-string">&#x27;object&#x27;</span>)<br><br>In [<span class="hljs-number">18</span>]: df.values<br>Out[<span class="hljs-number">18</span>]: <br>array([[ <span class="hljs-number">0.4691</span>, -<span class="hljs-number">0.2829</span>, -<span class="hljs-number">1.5091</span>, -<span class="hljs-number">1.1356</span>],<br>       [ <span class="hljs-number">1.2121</span>, -<span class="hljs-number">0.1732</span>,  <span class="hljs-number">0.1192</span>, -<span class="hljs-number">1.0442</span>],<br>       [-<span class="hljs-number">0.8618</span>, -<span class="hljs-number">2.1046</span>, -<span class="hljs-number">0.4949</span>,  <span class="hljs-number">1.0718</span>],<br>       [ <span class="hljs-number">0.7216</span>, -<span class="hljs-number">0.7068</span>, -<span class="hljs-number">1.0396</span>,  <span class="hljs-number">0.2719</span>],<br>       [-<span class="hljs-number">0.425</span> ,  <span class="hljs-number">0.567</span> ,  <span class="hljs-number">0.2762</span>, -<span class="hljs-number">1.0874</span>],<br>       [-<span class="hljs-number">0.6737</span>,  <span class="hljs-number">0.1136</span>, -<span class="hljs-number">1.4784</span>,  <span class="hljs-number">0.525</span> ]])<br></code></pre></td></tr></table></figure><p>3、 describe()函数对于数据的快速统计汇总：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">19</span>]: df.describe()<br>Out[<span class="hljs-number">19</span>]: <br>              A         B         C         D<br>count  <span class="hljs-number">6.000000</span>  <span class="hljs-number">6.000000</span>  <span class="hljs-number">6.000000</span>  <span class="hljs-number">6.000000</span><br>mean   <span class="hljs-number">0.073711</span> -<span class="hljs-number">0.431125</span> -<span class="hljs-number">0.687758</span> -<span class="hljs-number">0.233103</span><br>std    <span class="hljs-number">0.843157</span>  <span class="hljs-number">0.922818</span>  <span class="hljs-number">0.779887</span>  <span class="hljs-number">0.973118</span><br><span class="hljs-built_in">min</span>   -<span class="hljs-number">0.861849</span> -<span class="hljs-number">2.104569</span> -<span class="hljs-number">1.509059</span> -<span class="hljs-number">1.135632</span><br><span class="hljs-number">25</span>%   -<span class="hljs-number">0.611510</span> -<span class="hljs-number">0.600794</span> -<span class="hljs-number">1.368714</span> -<span class="hljs-number">1.076610</span><br><span class="hljs-number">50</span>%    <span class="hljs-number">0.022070</span> -<span class="hljs-number">0.228039</span> -<span class="hljs-number">0.767252</span> -<span class="hljs-number">0.386188</span><br><span class="hljs-number">75</span>%    <span class="hljs-number">0.658444</span>  <span class="hljs-number">0.041933</span> -<span class="hljs-number">0.034326</span>  <span class="hljs-number">0.461706</span><br><span class="hljs-built_in">max</span>    <span class="hljs-number">1.212112</span>  <span class="hljs-number">0.567020</span>  <span class="hljs-number">0.276232</span>  <span class="hljs-number">1.071804</span><br></code></pre></td></tr></table></figure><p>4、 对数据的转置：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">20</span>]: df.T<br>Out[<span class="hljs-number">20</span>]: <br>   <span class="hljs-number">2013</span>-01-01  <span class="hljs-number">2013</span>-01-02  <span class="hljs-number">2013</span>-01-03  <span class="hljs-number">2013</span>-01-04  <span class="hljs-number">2013</span>-01-05  <span class="hljs-number">2013</span>-01-06<br>A    <span class="hljs-number">0.469112</span>    <span class="hljs-number">1.212112</span>   -<span class="hljs-number">0.861849</span>    <span class="hljs-number">0.721555</span>   -<span class="hljs-number">0.424972</span>   -<span class="hljs-number">0.673690</span><br>B   -<span class="hljs-number">0.282863</span>   -<span class="hljs-number">0.173215</span>   -<span class="hljs-number">2.104569</span>   -<span class="hljs-number">0.706771</span>    <span class="hljs-number">0.567020</span>    <span class="hljs-number">0.113648</span><br>C   -<span class="hljs-number">1.509059</span>    <span class="hljs-number">0.119209</span>   -<span class="hljs-number">0.494929</span>   -<span class="hljs-number">1.039575</span>    <span class="hljs-number">0.276232</span>   -<span class="hljs-number">1.478427</span><br>D   -<span class="hljs-number">1.135632</span>   -<span class="hljs-number">1.044236</span>    <span class="hljs-number">1.071804</span>    <span class="hljs-number">0.271860</span>   -<span class="hljs-number">1.087401</span>    <span class="hljs-number">0.524988</span><br></code></pre></td></tr></table></figure><p>5、 按轴进行排序</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">21</span>]: df.sort_index(axis=<span class="hljs-number">1</span>, ascending=<span class="hljs-literal">False</span>)<br>Out[<span class="hljs-number">21</span>]: <br>                   D         C         B         A<br><span class="hljs-number">2013</span>-01-01 -<span class="hljs-number">1.135632</span> -<span class="hljs-number">1.509059</span> -<span class="hljs-number">0.282863</span>  <span class="hljs-number">0.469112</span><br><span class="hljs-number">2013</span>-01-02 -<span class="hljs-number">1.044236</span>  <span class="hljs-number">0.119209</span> -<span class="hljs-number">0.173215</span>  <span class="hljs-number">1.212112</span><br><span class="hljs-number">2013</span>-01-03  <span class="hljs-number">1.071804</span> -<span class="hljs-number">0.494929</span> -<span class="hljs-number">2.104569</span> -<span class="hljs-number">0.861849</span><br><span class="hljs-number">2013</span>-01-04  <span class="hljs-number">0.271860</span> -<span class="hljs-number">1.039575</span> -<span class="hljs-number">0.706771</span>  <span class="hljs-number">0.721555</span><br><span class="hljs-number">2013</span>-01-05 -<span class="hljs-number">1.087401</span>  <span class="hljs-number">0.276232</span>  <span class="hljs-number">0.567020</span> -<span class="hljs-number">0.424972</span><br><span class="hljs-number">2013</span>-01-06  <span class="hljs-number">0.524988</span> -<span class="hljs-number">1.478427</span>  <span class="hljs-number">0.113648</span> -<span class="hljs-number">0.673690</span><br></code></pre></td></tr></table></figure><p>6、 按值进行排序</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">22</span>]: df.sort_values(by=<span class="hljs-string">&#x27;B&#x27;</span>)<br>Out[<span class="hljs-number">22</span>]: <br>                   A         B         C         D<br><span class="hljs-number">2013</span>-01-03 -<span class="hljs-number">0.861849</span> -<span class="hljs-number">2.104569</span> -<span class="hljs-number">0.494929</span>  <span class="hljs-number">1.071804</span><br><span class="hljs-number">2013</span>-01-04  <span class="hljs-number">0.721555</span> -<span class="hljs-number">0.706771</span> -<span class="hljs-number">1.039575</span>  <span class="hljs-number">0.271860</span><br><span class="hljs-number">2013</span>-01-01  <span class="hljs-number">0.469112</span> -<span class="hljs-number">0.282863</span> -<span class="hljs-number">1.509059</span> -<span class="hljs-number">1.135632</span><br><span class="hljs-number">2013</span>-01-02  <span class="hljs-number">1.212112</span> -<span class="hljs-number">0.173215</span>  <span class="hljs-number">0.119209</span> -<span class="hljs-number">1.044236</span><br><span class="hljs-number">2013</span>-01-06 -<span class="hljs-number">0.673690</span>  <span class="hljs-number">0.113648</span> -<span class="hljs-number">1.478427</span>  <span class="hljs-number">0.524988</span><br><span class="hljs-number">2013</span>-01-05 -<span class="hljs-number">0.424972</span>  <span class="hljs-number">0.567020</span>  <span class="hljs-number">0.276232</span> -<span class="hljs-number">1.087401</span><br></code></pre></td></tr></table></figure><h2 id="三-选择"><a class="markdownIt-Anchor" href="#三-选择"></a> 三、选择</h2><p>虽然标准的Python/Numpy的选择和设置表达式都能够直接派上用场，但是作为工程使用的代码，我们推荐使用经过优化的pandas数据访问方式： .at, .iat, .loc, .iloc 和 .ix</p><h3 id="获取"><a class="markdownIt-Anchor" href="#获取"></a> 获取</h3><p>1、 选择一个单独的列，这将会返回一个Series，等同于df.A：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">23</span>]: df[<span class="hljs-string">&#x27;A&#x27;</span>]<br>Out[<span class="hljs-number">23</span>]: <br><span class="hljs-number">2013</span>-01-01    <span class="hljs-number">0.469112</span><br><span class="hljs-number">2013</span>-01-02    <span class="hljs-number">1.212112</span><br><span class="hljs-number">2013</span>-01-03   -<span class="hljs-number">0.861849</span><br><span class="hljs-number">2013</span>-01-04    <span class="hljs-number">0.721555</span><br><span class="hljs-number">2013</span>-01-05   -<span class="hljs-number">0.424972</span><br><span class="hljs-number">2013</span>-01-06   -<span class="hljs-number">0.673690</span><br>Freq: D, Name: A, dtype: float64<br></code></pre></td></tr></table></figure><p>2、 通过[]进行选择，这将会对行进行切片</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">24</span>]: df[<span class="hljs-number">0</span>:<span class="hljs-number">3</span>]<br>Out[<span class="hljs-number">24</span>]: <br>                   A         B         C         D<br><span class="hljs-number">2013</span>-01-01  <span class="hljs-number">0.469112</span> -<span class="hljs-number">0.282863</span> -<span class="hljs-number">1.509059</span> -<span class="hljs-number">1.135632</span><br><span class="hljs-number">2013</span>-01-02  <span class="hljs-number">1.212112</span> -<span class="hljs-number">0.173215</span>  <span class="hljs-number">0.119209</span> -<span class="hljs-number">1.044236</span><br><span class="hljs-number">2013</span>-01-03 -<span class="hljs-number">0.861849</span> -<span class="hljs-number">2.104569</span> -<span class="hljs-number">0.494929</span>  <span class="hljs-number">1.071804</span><br><br>In [<span class="hljs-number">25</span>]: df[<span class="hljs-string">&#x27;20130102&#x27;</span>:<span class="hljs-string">&#x27;20130104&#x27;</span>]<br>Out[<span class="hljs-number">25</span>]: <br>                   A         B         C         D<br><span class="hljs-number">2013</span>-01-02  <span class="hljs-number">1.212112</span> -<span class="hljs-number">0.173215</span>  <span class="hljs-number">0.119209</span> -<span class="hljs-number">1.044236</span><br><span class="hljs-number">2013</span>-01-03 -<span class="hljs-number">0.861849</span> -<span class="hljs-number">2.104569</span> -<span class="hljs-number">0.494929</span>  <span class="hljs-number">1.071804</span><br><span class="hljs-number">2013</span>-01-04  <span class="hljs-number">0.721555</span> -<span class="hljs-number">0.706771</span> -<span class="hljs-number">1.039575</span>  <span class="hljs-number">0.271860</span><br></code></pre></td></tr></table></figure><h3 id="通过标签选择"><a class="markdownIt-Anchor" href="#通过标签选择"></a> 通过标签选择</h3><p>1、 使用标签来获取一个交叉的区域</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">26</span>]: df.loc[dates[<span class="hljs-number">0</span>]]<br>Out[<span class="hljs-number">26</span>]: <br>A    <span class="hljs-number">0.469112</span><br>B   -<span class="hljs-number">0.282863</span><br>C   -<span class="hljs-number">1.509059</span><br>D   -<span class="hljs-number">1.135632</span><br>Name: <span class="hljs-number">2013</span>-01-01 <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>, dtype: float64<br></code></pre></td></tr></table></figure><p>2、 通过标签来在多个轴上进行选择</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">27</span>]: df.loc[:,[<span class="hljs-string">&#x27;A&#x27;</span>,<span class="hljs-string">&#x27;B&#x27;</span>]]<br>Out[<span class="hljs-number">27</span>]: <br>                   A         B<br><span class="hljs-number">2013</span>-01-01  <span class="hljs-number">0.469112</span> -<span class="hljs-number">0.282863</span><br><span class="hljs-number">2013</span>-01-02  <span class="hljs-number">1.212112</span> -<span class="hljs-number">0.173215</span><br><span class="hljs-number">2013</span>-01-03 -<span class="hljs-number">0.861849</span> -<span class="hljs-number">2.104569</span><br><span class="hljs-number">2013</span>-01-04  <span class="hljs-number">0.721555</span> -<span class="hljs-number">0.706771</span><br><span class="hljs-number">2013</span>-01-05 -<span class="hljs-number">0.424972</span>  <span class="hljs-number">0.567020</span><br><span class="hljs-number">2013</span>-01-06 -<span class="hljs-number">0.673690</span>  <span class="hljs-number">0.113648</span><br></code></pre></td></tr></table></figure><p>3、 标签切片</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">28</span>]: df.loc[<span class="hljs-string">&#x27;20130102&#x27;</span>:<span class="hljs-string">&#x27;20130104&#x27;</span>,[<span class="hljs-string">&#x27;A&#x27;</span>,<span class="hljs-string">&#x27;B&#x27;</span>]]<br>Out[<span class="hljs-number">28</span>]: <br>                   A         B<br><span class="hljs-number">2013</span>-01-02  <span class="hljs-number">1.212112</span> -<span class="hljs-number">0.173215</span><br><span class="hljs-number">2013</span>-01-03 -<span class="hljs-number">0.861849</span> -<span class="hljs-number">2.104569</span><br><span class="hljs-number">2013</span>-01-04  <span class="hljs-number">0.721555</span> -<span class="hljs-number">0.706771</span><br></code></pre></td></tr></table></figure><p>4、 对于返回的对象进行维度缩减</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">29</span>]: df.loc[<span class="hljs-string">&#x27;20130102&#x27;</span>,[<span class="hljs-string">&#x27;A&#x27;</span>,<span class="hljs-string">&#x27;B&#x27;</span>]]<br>Out[<span class="hljs-number">29</span>]: <br>A    <span class="hljs-number">1.212112</span><br>B   -<span class="hljs-number">0.173215</span><br>Name: <span class="hljs-number">2013</span>-01-02 <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>, dtype: float64<br></code></pre></td></tr></table></figure><p>5、 获取一个标量</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">30</span>]: df.loc[dates[<span class="hljs-number">0</span>],<span class="hljs-string">&#x27;A&#x27;</span>]<br>Out[<span class="hljs-number">30</span>]: <span class="hljs-number">0.46911229990718628</span><br></code></pre></td></tr></table></figure><p>6、 快速访问一个标量（与上一个方法等价）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">31</span>]: df.at[dates[<span class="hljs-number">0</span>],<span class="hljs-string">&#x27;A&#x27;</span>]<br>Out[<span class="hljs-number">31</span>]: <span class="hljs-number">0.46911229990718628</span><br></code></pre></td></tr></table></figure><h3 id="通过位置选择"><a class="markdownIt-Anchor" href="#通过位置选择"></a> 通过位置选择</h3><p>1、 通过传递数值进行位置选择（选择的是行）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">32</span>]: df.iloc[<span class="hljs-number">3</span>]<br>Out[<span class="hljs-number">32</span>]: <br>A    <span class="hljs-number">0.721555</span><br>B   -<span class="hljs-number">0.706771</span><br>C   -<span class="hljs-number">1.039575</span><br>D    <span class="hljs-number">0.271860</span><br>Name: <span class="hljs-number">2013</span>-01-04 <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>, dtype: float64<br></code></pre></td></tr></table></figure><p>2、 通过数值进行切片，与numpy/python中的情况类似</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">In</span><span class="hljs-meta"> [33]: df.iloc[3:5,0:2]</span><br><span class="hljs-attribute">Out</span>[<span class="hljs-number">33</span>]: <br>                   <span class="hljs-attribute">A</span>         B<br><span class="hljs-attribute">2013</span>-<span class="hljs-number">01</span>-<span class="hljs-number">04</span>  <span class="hljs-number">0</span>.<span class="hljs-number">721555</span> -<span class="hljs-number">0</span>.<span class="hljs-number">706771</span><br><span class="hljs-attribute">2013</span>-<span class="hljs-number">01</span>-<span class="hljs-number">05</span> -<span class="hljs-number">0</span>.<span class="hljs-number">424972</span>  <span class="hljs-number">0</span>.<span class="hljs-number">567020</span><br></code></pre></td></tr></table></figure><p>3、 通过指定一个位置的列表，与numpy/python中的情况类似</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">34</span>]: df.iloc[[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">2</span>]]<br>Out[<span class="hljs-number">34</span>]: <br>                   A         C<br><span class="hljs-number">2013</span>-01-02  <span class="hljs-number">1.212112</span>  <span class="hljs-number">0.119209</span><br><span class="hljs-number">2013</span>-01-03 -<span class="hljs-number">0.861849</span> -<span class="hljs-number">0.494929</span><br><span class="hljs-number">2013</span>-01-05 -<span class="hljs-number">0.424972</span>  <span class="hljs-number">0.276232</span><br></code></pre></td></tr></table></figure><p>4、 对行进行切片</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">35</span>]: df.iloc[<span class="hljs-number">1</span>:<span class="hljs-number">3</span>,:]<br>Out[<span class="hljs-number">35</span>]: <br>                   A         B         C         D<br><span class="hljs-number">2013</span>-01-02  <span class="hljs-number">1.212112</span> -<span class="hljs-number">0.173215</span>  <span class="hljs-number">0.119209</span> -<span class="hljs-number">1.044236</span><br><span class="hljs-number">2013</span>-01-03 -<span class="hljs-number">0.861849</span> -<span class="hljs-number">2.104569</span> -<span class="hljs-number">0.494929</span>  <span class="hljs-number">1.071804</span><br></code></pre></td></tr></table></figure><p>5、 对列进行切片</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">36</span>]: df.iloc[:,<span class="hljs-number">1</span>:<span class="hljs-number">3</span>]<br>Out[<span class="hljs-number">36</span>]: <br>                   B         C<br><span class="hljs-number">2013</span>-01-01 -<span class="hljs-number">0.282863</span> -<span class="hljs-number">1.509059</span><br><span class="hljs-number">2013</span>-01-02 -<span class="hljs-number">0.173215</span>  <span class="hljs-number">0.119209</span><br><span class="hljs-number">2013</span>-01-03 -<span class="hljs-number">2.104569</span> -<span class="hljs-number">0.494929</span><br><span class="hljs-number">2013</span>-01-04 -<span class="hljs-number">0.706771</span> -<span class="hljs-number">1.039575</span><br><span class="hljs-number">2013</span>-01-05  <span class="hljs-number">0.567020</span>  <span class="hljs-number">0.276232</span><br><span class="hljs-number">2013</span>-01-06  <span class="hljs-number">0.113648</span> -<span class="hljs-number">1.478427</span><br></code></pre></td></tr></table></figure><p>6、 获取特定的值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">37</span>]: df.iloc[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>]<br>Out[<span class="hljs-number">37</span>]: -<span class="hljs-number">0.17321464905330858</span><br></code></pre></td></tr></table></figure><p>获得快速访问的一个标量（等同于以前的做法）</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">In</span><span class="hljs-meta"> [38]: df.iat[1,1]</span><br><span class="hljs-attribute">Out</span>[<span class="hljs-number">38</span>]: -<span class="hljs-number">0</span>.<span class="hljs-number">17321464905330858</span><br></code></pre></td></tr></table></figure><h3 id="布尔索引"><a class="markdownIt-Anchor" href="#布尔索引"></a> 布尔索引</h3><p>1、 使用一个单独列的值来选择数据：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">39</span>]: df[df.A &gt; <span class="hljs-number">0</span>]<br>Out[<span class="hljs-number">39</span>]: <br>                   A         B         C         D<br><span class="hljs-number">2013</span>-01-01  <span class="hljs-number">0.469112</span> -<span class="hljs-number">0.282863</span> -<span class="hljs-number">1.509059</span> -<span class="hljs-number">1.135632</span><br><span class="hljs-number">2013</span>-01-02  <span class="hljs-number">1.212112</span> -<span class="hljs-number">0.173215</span>  <span class="hljs-number">0.119209</span> -<span class="hljs-number">1.044236</span><br><span class="hljs-number">2013</span>-01-04  <span class="hljs-number">0.721555</span> -<span class="hljs-number">0.706771</span> -<span class="hljs-number">1.039575</span>  <span class="hljs-number">0.271860</span><br></code></pre></td></tr></table></figure><p>2、 使用where操作来选择数据：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">40</span>]: df[df &gt; <span class="hljs-number">0</span>]<br>Out[<span class="hljs-number">40</span>]: <br>                   A         B         C         D<br><span class="hljs-number">2013</span>-01-01  <span class="hljs-number">0.469112</span>       NaN       NaN       NaN<br><span class="hljs-number">2013</span>-01-02  <span class="hljs-number">1.212112</span>       NaN  <span class="hljs-number">0.119209</span>       NaN<br><span class="hljs-number">2013</span>-01-03       NaN       NaN       NaN  <span class="hljs-number">1.071804</span><br><span class="hljs-number">2013</span>-01-04  <span class="hljs-number">0.721555</span>       NaN       NaN  <span class="hljs-number">0.271860</span><br><span class="hljs-number">2013</span>-01-05       NaN  <span class="hljs-number">0.567020</span>  <span class="hljs-number">0.276232</span>       NaN<br><span class="hljs-number">2013</span>-01-06       NaN  <span class="hljs-number">0.113648</span>       NaN  <span class="hljs-number">0.524988</span><br></code></pre></td></tr></table></figure><p>3、 使用isin()方法来过滤：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">41</span>]: df2 = df.copy()<br><br>In [<span class="hljs-number">42</span>]: df2[<span class="hljs-string">&#x27;E&#x27;</span>] = [<span class="hljs-string">&#x27;one&#x27;</span>, <span class="hljs-string">&#x27;one&#x27;</span>,<span class="hljs-string">&#x27;two&#x27;</span>,<span class="hljs-string">&#x27;three&#x27;</span>,<span class="hljs-string">&#x27;four&#x27;</span>,<span class="hljs-string">&#x27;three&#x27;</span>]<br><br>In [<span class="hljs-number">43</span>]: df2<br>Out[<span class="hljs-number">43</span>]: <br>                   A         B         C         D      E<br><span class="hljs-number">2013</span>-01-01  <span class="hljs-number">0.469112</span> -<span class="hljs-number">0.282863</span> -<span class="hljs-number">1.509059</span> -<span class="hljs-number">1.135632</span>    one<br><span class="hljs-number">2013</span>-01-02  <span class="hljs-number">1.212112</span> -<span class="hljs-number">0.173215</span>  <span class="hljs-number">0.119209</span> -<span class="hljs-number">1.044236</span>    one<br><span class="hljs-number">2013</span>-01-03 -<span class="hljs-number">0.861849</span> -<span class="hljs-number">2.104569</span> -<span class="hljs-number">0.494929</span>  <span class="hljs-number">1.071804</span>    two<br><span class="hljs-number">2013</span>-01-04  <span class="hljs-number">0.721555</span> -<span class="hljs-number">0.706771</span> -<span class="hljs-number">1.039575</span>  <span class="hljs-number">0.271860</span>  three<br><span class="hljs-number">2013</span>-01-05 -<span class="hljs-number">0.424972</span>  <span class="hljs-number">0.567020</span>  <span class="hljs-number">0.276232</span> -<span class="hljs-number">1.087401</span>   four<br><span class="hljs-number">2013</span>-01-06 -<span class="hljs-number">0.673690</span>  <span class="hljs-number">0.113648</span> -<span class="hljs-number">1.478427</span>  <span class="hljs-number">0.524988</span>  three<br><br>In [<span class="hljs-number">44</span>]: df2[df2[<span class="hljs-string">&#x27;E&#x27;</span>].isin([<span class="hljs-string">&#x27;two&#x27;</span>,<span class="hljs-string">&#x27;four&#x27;</span>])]<br>Out[<span class="hljs-number">44</span>]: <br>                   A         B         C         D     E<br><span class="hljs-number">2013</span>-01-03 -<span class="hljs-number">0.861849</span> -<span class="hljs-number">2.104569</span> -<span class="hljs-number">0.494929</span>  <span class="hljs-number">1.071804</span>   two<br><span class="hljs-number">2013</span>-01-05 -<span class="hljs-number">0.424972</span>  <span class="hljs-number">0.567020</span>  <span class="hljs-number">0.276232</span> -<span class="hljs-number">1.087401</span>  four<br></code></pre></td></tr></table></figure><h3 id="设置"><a class="markdownIt-Anchor" href="#设置"></a> 设置</h3><p>1、 设置一个新的列：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">45</span>]: s1 = pd.Series([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>], index=pd.date_range(<span class="hljs-string">&#x27;20130102&#x27;</span>, periods=<span class="hljs-number">6</span>))<br><br>In [<span class="hljs-number">46</span>]: s1<br>Out[<span class="hljs-number">46</span>]: <br><span class="hljs-number">2013</span>-01-02    <span class="hljs-number">1</span><br><span class="hljs-number">2013</span>-01-03    <span class="hljs-number">2</span><br><span class="hljs-number">2013</span>-01-04    <span class="hljs-number">3</span><br><span class="hljs-number">2013</span>-01-05    <span class="hljs-number">4</span><br><span class="hljs-number">2013</span>-01-06    <span class="hljs-number">5</span><br><span class="hljs-number">2013</span>-01-07    <span class="hljs-number">6</span><br>Freq: D, dtype: int64<br><br>In [<span class="hljs-number">47</span>]: df[<span class="hljs-string">&#x27;F&#x27;</span>] = s1<br></code></pre></td></tr></table></figure><p>2、 通过标签设置新的值：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">48</span>]: df.at[dates[<span class="hljs-number">0</span>],<span class="hljs-string">&#x27;A&#x27;</span>] = <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p>3、 通过位置设置新的值：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">49</span>]: df.iat[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>] = <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p>4、 通过一个numpy数组设置一组新值：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">50</span>]: df.loc[:,<span class="hljs-string">&#x27;D&#x27;</span>] = np.array([<span class="hljs-number">5</span>] * <span class="hljs-built_in">len</span>(df))<br></code></pre></td></tr></table></figure><p>上述操作结果如下：</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs dns">In [<span class="hljs-number">51</span>]: df<br>Out[<span class="hljs-number">51</span>]: <br>                   <span class="hljs-keyword">A</span>         B         C  D    F<br><span class="hljs-number">2013-01-01</span>  <span class="hljs-number">0.000000</span>  <span class="hljs-number">0.000000</span> -<span class="hljs-number">1.509059</span>  <span class="hljs-number">5</span>  NaN<br><span class="hljs-number">2013-01-02</span>  <span class="hljs-number">1.212112</span> -<span class="hljs-number">0.173215</span>  <span class="hljs-number">0.119209</span>  <span class="hljs-number">5</span>  <span class="hljs-number">1</span>.<span class="hljs-number">0</span><br><span class="hljs-number">2013-01-03</span> -<span class="hljs-number">0.861849</span> -<span class="hljs-number">2.104569</span> -<span class="hljs-number">0.494929</span>  <span class="hljs-number">5</span>  <span class="hljs-number">2</span>.<span class="hljs-number">0</span><br><span class="hljs-number">2013-01-04</span>  <span class="hljs-number">0.721555</span> -<span class="hljs-number">0.706771</span> -<span class="hljs-number">1.039575</span>  <span class="hljs-number">5</span>  <span class="hljs-number">3</span>.<span class="hljs-number">0</span><br><span class="hljs-number">2013-01-05</span> -<span class="hljs-number">0.424972</span>  <span class="hljs-number">0.567020</span>  <span class="hljs-number">0.276232</span>  <span class="hljs-number">5</span>  <span class="hljs-number">4</span>.<span class="hljs-number">0</span><br><span class="hljs-number">2013-01-06</span> -<span class="hljs-number">0.673690</span>  <span class="hljs-number">0.113648</span> -<span class="hljs-number">1.478427</span>  <span class="hljs-number">5</span>  <span class="hljs-number">5</span>.<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p>5、 通过where操作来设置新的值：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">52</span>]: df2 = df.copy()<br><br>In [<span class="hljs-number">53</span>]: df2[df2 &gt; <span class="hljs-number">0</span>] = -df2<br><br>In [<span class="hljs-number">54</span>]: df2<br>Out[<span class="hljs-number">54</span>]: <br>                   A         B         C  D    F<br><span class="hljs-number">2013</span>-01-01  <span class="hljs-number">0.000000</span>  <span class="hljs-number">0.000000</span> -<span class="hljs-number">1.509059</span> -<span class="hljs-number">5</span>  NaN<br><span class="hljs-number">2013</span>-01-02 -<span class="hljs-number">1.212112</span> -<span class="hljs-number">0.173215</span> -<span class="hljs-number">0.119209</span> -<span class="hljs-number">5</span> -<span class="hljs-number">1.0</span><br><span class="hljs-number">2013</span>-01-03 -<span class="hljs-number">0.861849</span> -<span class="hljs-number">2.104569</span> -<span class="hljs-number">0.494929</span> -<span class="hljs-number">5</span> -<span class="hljs-number">2.0</span><br><span class="hljs-number">2013</span>-01-04 -<span class="hljs-number">0.721555</span> -<span class="hljs-number">0.706771</span> -<span class="hljs-number">1.039575</span> -<span class="hljs-number">5</span> -<span class="hljs-number">3.0</span><br><span class="hljs-number">2013</span>-01-05 -<span class="hljs-number">0.424972</span> -<span class="hljs-number">0.567020</span> -<span class="hljs-number">0.276232</span> -<span class="hljs-number">5</span> -<span class="hljs-number">4.0</span><br><span class="hljs-number">2013</span>-01-06 -<span class="hljs-number">0.673690</span> -<span class="hljs-number">0.113648</span> -<span class="hljs-number">1.478427</span> -<span class="hljs-number">5</span> -<span class="hljs-number">5.0</span><br></code></pre></td></tr></table></figure><h2 id="四-缺失值处理"><a class="markdownIt-Anchor" href="#四-缺失值处理"></a> 四、缺失值处理</h2><p>在pandas中，使用np.nan来代替缺失值，这些值将默认不会包含在计算中。</p><p>1、 reindex()方法可以对指定轴上的索引进行改变/增加/删除操作，这将返回原始数据的一个拷贝：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">55</span>]: df1 = df.reindex(index=dates[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>], columns=<span class="hljs-built_in">list</span>(df.columns) + [<span class="hljs-string">&#x27;E&#x27;</span>])<br><br>In [<span class="hljs-number">56</span>]: df1.loc[dates[<span class="hljs-number">0</span>]:dates[<span class="hljs-number">1</span>],<span class="hljs-string">&#x27;E&#x27;</span>] = <span class="hljs-number">1</span><br><br>In [<span class="hljs-number">57</span>]: df1<br>Out[<span class="hljs-number">57</span>]: <br>                   A         B         C  D    F    E<br><span class="hljs-number">2013</span>-01-01  <span class="hljs-number">0.000000</span>  <span class="hljs-number">0.000000</span> -<span class="hljs-number">1.509059</span>  <span class="hljs-number">5</span>  NaN  <span class="hljs-number">1.0</span><br><span class="hljs-number">2013</span>-01-02  <span class="hljs-number">1.212112</span> -<span class="hljs-number">0.173215</span>  <span class="hljs-number">0.119209</span>  <span class="hljs-number">5</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">1.0</span><br><span class="hljs-number">2013</span>-01-03 -<span class="hljs-number">0.861849</span> -<span class="hljs-number">2.104569</span> -<span class="hljs-number">0.494929</span>  <span class="hljs-number">5</span>  <span class="hljs-number">2.0</span>  NaN<br><span class="hljs-number">2013</span>-01-04  <span class="hljs-number">0.721555</span> -<span class="hljs-number">0.706771</span> -<span class="hljs-number">1.039575</span>  <span class="hljs-number">5</span>  <span class="hljs-number">3.0</span>  NaN<br></code></pre></td></tr></table></figure><p>2、 去掉包含缺失值的行：</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dns">In [<span class="hljs-number">58</span>]: df1.dropna(how=&#x27;any&#x27;)<br>Out[<span class="hljs-number">58</span>]: <br>                   <span class="hljs-keyword">A</span>         B         C  D    F    E<br><span class="hljs-number">2013-01-02</span>  <span class="hljs-number">1.212112</span> -<span class="hljs-number">0.173215</span>  <span class="hljs-number">0.119209</span>  <span class="hljs-number">5</span>  <span class="hljs-number">1</span>.<span class="hljs-number">0</span>  <span class="hljs-number">1</span>.<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p>3、 对缺失值进行填充：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">59</span>]: df1.fillna(value=<span class="hljs-number">5</span>)<br>Out[<span class="hljs-number">59</span>]: <br>                   A         B         C  D    F    E<br><span class="hljs-number">2013</span>-01-01  <span class="hljs-number">0.000000</span>  <span class="hljs-number">0.000000</span> -<span class="hljs-number">1.509059</span>  <span class="hljs-number">5</span>  <span class="hljs-number">5.0</span>  <span class="hljs-number">1.0</span><br><span class="hljs-number">2013</span>-01-02  <span class="hljs-number">1.212112</span> -<span class="hljs-number">0.173215</span>  <span class="hljs-number">0.119209</span>  <span class="hljs-number">5</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">1.0</span><br><span class="hljs-number">2013</span>-01-03 -<span class="hljs-number">0.861849</span> -<span class="hljs-number">2.104569</span> -<span class="hljs-number">0.494929</span>  <span class="hljs-number">5</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">5.0</span><br><span class="hljs-number">2013</span>-01-04  <span class="hljs-number">0.721555</span> -<span class="hljs-number">0.706771</span> -<span class="hljs-number">1.039575</span>  <span class="hljs-number">5</span>  <span class="hljs-number">3.0</span>  <span class="hljs-number">5.0</span><br></code></pre></td></tr></table></figure><p>4、 对数据进行布尔填充：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">60</span>]: pd.isnull(df1)<br>Out[<span class="hljs-number">60</span>]: <br>                A      B      C      D      F      E<br><span class="hljs-number">2013</span>-01-01  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>   <span class="hljs-literal">True</span>  <span class="hljs-literal">False</span><br><span class="hljs-number">2013</span>-01-02  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span><br><span class="hljs-number">2013</span>-01-03  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>   <span class="hljs-literal">True</span><br><span class="hljs-number">2013</span>-01-04  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>  <span class="hljs-literal">False</span>   <span class="hljs-literal">True</span><br></code></pre></td></tr></table></figure><h2 id="五-相关操作"><a class="markdownIt-Anchor" href="#五-相关操作"></a> 五、相关操作</h2><p><strong>统计（相关操作通常情况下不包括缺失值）</strong></p><p>1、 执行描述性统计：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">61</span>]: df.mean()<br>Out[<span class="hljs-number">61</span>]: <br>A   -<span class="hljs-number">0.004474</span><br>B   -<span class="hljs-number">0.383981</span><br>C   -<span class="hljs-number">0.687758</span><br>D    <span class="hljs-number">5.000000</span><br>F    <span class="hljs-number">3.000000</span><br>dtype: float64<br></code></pre></td></tr></table></figure><p>2、 在其他轴上进行相同的操作：</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs dns">In [<span class="hljs-number">62</span>]: df.mean(<span class="hljs-number">1</span>)<br>Out[<span class="hljs-number">62</span>]: <br><span class="hljs-number">2013-01-01</span>    <span class="hljs-number">0.872735</span><br><span class="hljs-number">2013-01-02</span>    <span class="hljs-number">1.431621</span><br><span class="hljs-number">2013-01-03</span>    <span class="hljs-number">0.707731</span><br><span class="hljs-number">2013-01-04</span>    <span class="hljs-number">1.395042</span><br><span class="hljs-number">2013-01-05</span>    <span class="hljs-number">1.883656</span><br><span class="hljs-number">2013-01-06</span>    <span class="hljs-number">1.592306</span><br>Freq: D, dtype: float64<br></code></pre></td></tr></table></figure><p>3、 对于拥有不同维度，需要对齐的对象进行操作。Pandas会自动的沿着指定的维度进行广播：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">63</span>]: s = pd.Series([<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,np.nan,<span class="hljs-number">6</span>,<span class="hljs-number">8</span>], index=dates).shift(<span class="hljs-number">2</span>)<br><br>In [<span class="hljs-number">64</span>]: s<br>Out[<span class="hljs-number">64</span>]: <br><span class="hljs-number">2013</span>-01-01    NaN<br><span class="hljs-number">2013</span>-01-02    NaN<br><span class="hljs-number">2013</span>-01-03    <span class="hljs-number">1.0</span><br><span class="hljs-number">2013</span>-01-04    <span class="hljs-number">3.0</span><br><span class="hljs-number">2013</span>-01-05    <span class="hljs-number">5.0</span><br><span class="hljs-number">2013</span>-01-06    NaN<br>Freq: D, dtype: float64<br><br>In [<span class="hljs-number">65</span>]: df.sub(s, axis=<span class="hljs-string">&#x27;index&#x27;</span>)<br>Out[<span class="hljs-number">65</span>]: <br>                   A         B         C    D    F<br><span class="hljs-number">2013</span>-01-01       NaN       NaN       NaN  NaN  NaN<br><span class="hljs-number">2013</span>-01-02       NaN       NaN       NaN  NaN  NaN<br><span class="hljs-number">2013</span>-01-03 -<span class="hljs-number">1.861849</span> -<span class="hljs-number">3.104569</span> -<span class="hljs-number">1.494929</span>  <span class="hljs-number">4.0</span>  <span class="hljs-number">1.0</span><br><span class="hljs-number">2013</span>-01-04 -<span class="hljs-number">2.278445</span> -<span class="hljs-number">3.706771</span> -<span class="hljs-number">4.039575</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">0.0</span><br><span class="hljs-number">2013</span>-01-05 -<span class="hljs-number">5.424972</span> -<span class="hljs-number">4.432980</span> -<span class="hljs-number">4.723768</span>  <span class="hljs-number">0.0</span> -<span class="hljs-number">1.0</span><br><span class="hljs-number">2013</span>-01-06       NaN       NaN       NaN  NaN  NaN<br></code></pre></td></tr></table></figure><p><strong>Apply</strong></p><p>1、 对数据应用函数：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">66</span>]: df.apply(np.cumsum)<br>Out[<span class="hljs-number">66</span>]: <br>                   A         B         C   D     F<br><span class="hljs-number">2013</span>-01-01  <span class="hljs-number">0.000000</span>  <span class="hljs-number">0.000000</span> -<span class="hljs-number">1.509059</span>   <span class="hljs-number">5</span>   NaN<br><span class="hljs-number">2013</span>-01-02  <span class="hljs-number">1.212112</span> -<span class="hljs-number">0.173215</span> -<span class="hljs-number">1.389850</span>  <span class="hljs-number">10</span>   <span class="hljs-number">1.0</span><br><span class="hljs-number">2013</span>-01-03  <span class="hljs-number">0.350263</span> -<span class="hljs-number">2.277784</span> -<span class="hljs-number">1.884779</span>  <span class="hljs-number">15</span>   <span class="hljs-number">3.0</span><br><span class="hljs-number">2013</span>-01-04  <span class="hljs-number">1.071818</span> -<span class="hljs-number">2.984555</span> -<span class="hljs-number">2.924354</span>  <span class="hljs-number">20</span>   <span class="hljs-number">6.0</span><br><span class="hljs-number">2013</span>-01-05  <span class="hljs-number">0.646846</span> -<span class="hljs-number">2.417535</span> -<span class="hljs-number">2.648122</span>  <span class="hljs-number">25</span>  <span class="hljs-number">10.0</span><br><span class="hljs-number">2013</span>-01-06 -<span class="hljs-number">0.026844</span> -<span class="hljs-number">2.303886</span> -<span class="hljs-number">4.126549</span>  <span class="hljs-number">30</span>  <span class="hljs-number">15.0</span><br><br>In [<span class="hljs-number">67</span>]: df.apply(<span class="hljs-keyword">lambda</span> x: x.<span class="hljs-built_in">max</span>() - x.<span class="hljs-built_in">min</span>())<br>Out[<span class="hljs-number">67</span>]: <br>A    <span class="hljs-number">2.073961</span><br>B    <span class="hljs-number">2.671590</span><br>C    <span class="hljs-number">1.785291</span><br>D    <span class="hljs-number">0.000000</span><br>F    <span class="hljs-number">4.000000</span><br>dtype: float64<br></code></pre></td></tr></table></figure><p><strong>直方图</strong></p><p>1、直方图</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">68</span>]: s = pd.Series(np.random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">7</span>, size=<span class="hljs-number">10</span>))<br><br>In [<span class="hljs-number">69</span>]: s<br>Out[<span class="hljs-number">69</span>]: <br><span class="hljs-number">0</span>    <span class="hljs-number">4</span><br><span class="hljs-number">1</span>    <span class="hljs-number">2</span><br><span class="hljs-number">2</span>    <span class="hljs-number">1</span><br><span class="hljs-number">3</span>    <span class="hljs-number">2</span><br><span class="hljs-number">4</span>    <span class="hljs-number">6</span><br><span class="hljs-number">5</span>    <span class="hljs-number">4</span><br><span class="hljs-number">6</span>    <span class="hljs-number">4</span><br><span class="hljs-number">7</span>    <span class="hljs-number">6</span><br><span class="hljs-number">8</span>    <span class="hljs-number">4</span><br><span class="hljs-number">9</span>    <span class="hljs-number">4</span><br>dtype: int64<br><br>In [<span class="hljs-number">70</span>]: s.value_counts()<br>Out[<span class="hljs-number">70</span>]: <br><span class="hljs-number">4</span>    <span class="hljs-number">5</span><br><span class="hljs-number">6</span>    <span class="hljs-number">2</span><br><span class="hljs-number">2</span>    <span class="hljs-number">2</span><br><span class="hljs-number">1</span>    <span class="hljs-number">1</span><br>dtype: int64<br></code></pre></td></tr></table></figure><p><strong>字符串方法</strong></p><p>Series对象在其str属性中配备了一组字符串处理方法，可以很容易的应用到数组中的每个元素，如下段代码所示。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs stylus">In <span class="hljs-selector-attr">[71]</span>: s = pd<span class="hljs-selector-class">.Series</span>(<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;Aaba&#x27;</span>, <span class="hljs-string">&#x27;Baca&#x27;</span>, np.nan, <span class="hljs-string">&#x27;CABA&#x27;</span>, <span class="hljs-string">&#x27;dog&#x27;</span>, <span class="hljs-string">&#x27;cat&#x27;</span>]</span>)<br><br>In <span class="hljs-selector-attr">[72]</span>: s<span class="hljs-selector-class">.str</span><span class="hljs-selector-class">.lower</span>()<br>Out<span class="hljs-selector-attr">[72]</span>: <br><span class="hljs-number">0</span>       <span class="hljs-selector-tag">a</span><br><span class="hljs-number">1</span>       <span class="hljs-selector-tag">b</span><br><span class="hljs-number">2</span>       c<br><span class="hljs-number">3</span>    aaba<br><span class="hljs-number">4</span>    baca<br><span class="hljs-number">5</span>     NaN<br><span class="hljs-number">6</span>    caba<br><span class="hljs-number">7</span>     dog<br><span class="hljs-number">8</span>     cat<br>dtype: object<br></code></pre></td></tr></table></figure><h2 id="六-合并"><a class="markdownIt-Anchor" href="#六-合并"></a> 六、合并</h2><p>Pandas提供了大量的方法能够轻松的对Series，DataFrame和Panel对象进行各种符合各种逻辑关系的合并操作。</p><p><strong>Concat</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">73</span>]: df = pd.DataFrame(np.random.randn(<span class="hljs-number">10</span>, <span class="hljs-number">4</span>))<br><br>In [<span class="hljs-number">74</span>]: df<br>Out[<span class="hljs-number">74</span>]: <br>          <span class="hljs-number">0</span>         <span class="hljs-number">1</span>         <span class="hljs-number">2</span>         <span class="hljs-number">3</span><br><span class="hljs-number">0</span> -<span class="hljs-number">0.548702</span>  <span class="hljs-number">1.467327</span> -<span class="hljs-number">1.015962</span> -<span class="hljs-number">0.483075</span><br><span class="hljs-number">1</span>  <span class="hljs-number">1.637550</span> -<span class="hljs-number">1.217659</span> -<span class="hljs-number">0.291519</span> -<span class="hljs-number">1.745505</span><br><span class="hljs-number">2</span> -<span class="hljs-number">0.263952</span>  <span class="hljs-number">0.991460</span> -<span class="hljs-number">0.919069</span>  <span class="hljs-number">0.266046</span><br><span class="hljs-number">3</span> -<span class="hljs-number">0.709661</span>  <span class="hljs-number">1.669052</span>  <span class="hljs-number">1.037882</span> -<span class="hljs-number">1.705775</span><br><span class="hljs-number">4</span> -<span class="hljs-number">0.919854</span> -<span class="hljs-number">0.042379</span>  <span class="hljs-number">1.247642</span> -<span class="hljs-number">0.009920</span><br><span class="hljs-number">5</span>  <span class="hljs-number">0.290213</span>  <span class="hljs-number">0.495767</span>  <span class="hljs-number">0.362949</span>  <span class="hljs-number">1.548106</span><br><span class="hljs-number">6</span> -<span class="hljs-number">1.131345</span> -<span class="hljs-number">0.089329</span>  <span class="hljs-number">0.337863</span> -<span class="hljs-number">0.945867</span><br><span class="hljs-number">7</span> -<span class="hljs-number">0.932132</span>  <span class="hljs-number">1.956030</span>  <span class="hljs-number">0.017587</span> -<span class="hljs-number">0.016692</span><br><span class="hljs-number">8</span> -<span class="hljs-number">0.575247</span>  <span class="hljs-number">0.254161</span> -<span class="hljs-number">1.143704</span>  <span class="hljs-number">0.215897</span><br><span class="hljs-number">9</span>  <span class="hljs-number">1.193555</span> -<span class="hljs-number">0.077118</span> -<span class="hljs-number">0.408530</span> -<span class="hljs-number">0.862495</span><br><br><span class="hljs-comment"># break it into pieces</span><br>In [<span class="hljs-number">75</span>]: pieces = [df[:<span class="hljs-number">3</span>], df[<span class="hljs-number">3</span>:<span class="hljs-number">7</span>], df[<span class="hljs-number">7</span>:]]<br><br>In [<span class="hljs-number">76</span>]: pd.concat(pieces)<br>Out[<span class="hljs-number">76</span>]: <br>          <span class="hljs-number">0</span>         <span class="hljs-number">1</span>         <span class="hljs-number">2</span>         <span class="hljs-number">3</span><br><span class="hljs-number">0</span> -<span class="hljs-number">0.548702</span>  <span class="hljs-number">1.467327</span> -<span class="hljs-number">1.015962</span> -<span class="hljs-number">0.483075</span><br><span class="hljs-number">1</span>  <span class="hljs-number">1.637550</span> -<span class="hljs-number">1.217659</span> -<span class="hljs-number">0.291519</span> -<span class="hljs-number">1.745505</span><br><span class="hljs-number">2</span> -<span class="hljs-number">0.263952</span>  <span class="hljs-number">0.991460</span> -<span class="hljs-number">0.919069</span>  <span class="hljs-number">0.266046</span><br><span class="hljs-number">3</span> -<span class="hljs-number">0.709661</span>  <span class="hljs-number">1.669052</span>  <span class="hljs-number">1.037882</span> -<span class="hljs-number">1.705775</span><br><span class="hljs-number">4</span> -<span class="hljs-number">0.919854</span> -<span class="hljs-number">0.042379</span>  <span class="hljs-number">1.247642</span> -<span class="hljs-number">0.009920</span><br><span class="hljs-number">5</span>  <span class="hljs-number">0.290213</span>  <span class="hljs-number">0.495767</span>  <span class="hljs-number">0.362949</span>  <span class="hljs-number">1.548106</span><br><span class="hljs-number">6</span> -<span class="hljs-number">1.131345</span> -<span class="hljs-number">0.089329</span>  <span class="hljs-number">0.337863</span> -<span class="hljs-number">0.945867</span><br><span class="hljs-number">7</span> -<span class="hljs-number">0.932132</span>  <span class="hljs-number">1.956030</span>  <span class="hljs-number">0.017587</span> -<span class="hljs-number">0.016692</span><br><span class="hljs-number">8</span> -<span class="hljs-number">0.575247</span>  <span class="hljs-number">0.254161</span> -<span class="hljs-number">1.143704</span>  <span class="hljs-number">0.215897</span><br><span class="hljs-number">9</span>  <span class="hljs-number">1.193555</span> -<span class="hljs-number">0.077118</span> -<span class="hljs-number">0.408530</span> -<span class="hljs-number">0.862495</span><br></code></pre></td></tr></table></figure><p><strong>Join 类似于SQL类型的合并</strong></p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs prolog"><span class="hljs-symbol">In</span> [<span class="hljs-number">77</span>]: left = pd.<span class="hljs-symbol">DataFrame</span>(&#123;<span class="hljs-string">&#x27;key&#x27;</span>: [<span class="hljs-string">&#x27;foo&#x27;</span>, <span class="hljs-string">&#x27;foo&#x27;</span>], <span class="hljs-string">&#x27;lval&#x27;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]&#125;)<br><br><span class="hljs-symbol">In</span> [<span class="hljs-number">78</span>]: right = pd.<span class="hljs-symbol">DataFrame</span>(&#123;<span class="hljs-string">&#x27;key&#x27;</span>: [<span class="hljs-string">&#x27;foo&#x27;</span>, <span class="hljs-string">&#x27;foo&#x27;</span>], <span class="hljs-string">&#x27;rval&#x27;</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>]&#125;)<br><br><span class="hljs-symbol">In</span> [<span class="hljs-number">79</span>]: left<br><span class="hljs-symbol">Out</span>[<span class="hljs-number">79</span>]: <br>   key  lval<br><span class="hljs-number">0</span>  foo     <span class="hljs-number">1</span><br><span class="hljs-number">1</span>  foo     <span class="hljs-number">2</span><br><br><span class="hljs-symbol">In</span> [<span class="hljs-number">80</span>]: right<br><span class="hljs-symbol">Out</span>[<span class="hljs-number">80</span>]: <br>   key  rval<br><span class="hljs-number">0</span>  foo     <span class="hljs-number">4</span><br><span class="hljs-number">1</span>  foo     <span class="hljs-number">5</span><br><br><span class="hljs-symbol">In</span> [<span class="hljs-number">81</span>]: pd.merge(left, right, on=<span class="hljs-string">&#x27;key&#x27;</span>)<br><span class="hljs-symbol">Out</span>[<span class="hljs-number">81</span>]: <br>   key  lval  rval<br><span class="hljs-number">0</span>  foo     <span class="hljs-number">1</span>     <span class="hljs-number">4</span><br><span class="hljs-number">1</span>  foo     <span class="hljs-number">1</span>     <span class="hljs-number">5</span><br><span class="hljs-number">2</span>  foo     <span class="hljs-number">2</span>     <span class="hljs-number">4</span><br><span class="hljs-number">3</span>  foo     <span class="hljs-number">2</span>     <span class="hljs-number">5</span><br></code></pre></td></tr></table></figure><p><strong>Append 将一行连接到一个DataFrame上</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">82</span>]: df = pd.DataFrame(np.random.randn(<span class="hljs-number">8</span>, <span class="hljs-number">4</span>), columns=[<span class="hljs-string">&#x27;A&#x27;</span>,<span class="hljs-string">&#x27;B&#x27;</span>,<span class="hljs-string">&#x27;C&#x27;</span>,<span class="hljs-string">&#x27;D&#x27;</span>])<br><br>In [<span class="hljs-number">83</span>]: df<br>Out[<span class="hljs-number">83</span>]: <br>          A         B         C         D<br><span class="hljs-number">0</span>  <span class="hljs-number">1.346061</span>  <span class="hljs-number">1.511763</span>  <span class="hljs-number">1.627081</span> -<span class="hljs-number">0.990582</span><br><span class="hljs-number">1</span> -<span class="hljs-number">0.441652</span>  <span class="hljs-number">1.211526</span>  <span class="hljs-number">0.268520</span>  <span class="hljs-number">0.024580</span><br><span class="hljs-number">2</span> -<span class="hljs-number">1.577585</span>  <span class="hljs-number">0.396823</span> -<span class="hljs-number">0.105381</span> -<span class="hljs-number">0.532532</span><br><span class="hljs-number">3</span>  <span class="hljs-number">1.453749</span>  <span class="hljs-number">1.208843</span> -<span class="hljs-number">0.080952</span> -<span class="hljs-number">0.264610</span><br><span class="hljs-number">4</span> -<span class="hljs-number">0.727965</span> -<span class="hljs-number">0.589346</span>  <span class="hljs-number">0.339969</span> -<span class="hljs-number">0.693205</span><br><span class="hljs-number">5</span> -<span class="hljs-number">0.339355</span>  <span class="hljs-number">0.593616</span>  <span class="hljs-number">0.884345</span>  <span class="hljs-number">1.591431</span><br><span class="hljs-number">6</span>  <span class="hljs-number">0.141809</span>  <span class="hljs-number">0.220390</span>  <span class="hljs-number">0.435589</span>  <span class="hljs-number">0.192451</span><br><span class="hljs-number">7</span> -<span class="hljs-number">0.096701</span>  <span class="hljs-number">0.803351</span>  <span class="hljs-number">1.715071</span> -<span class="hljs-number">0.708758</span><br><br>In [<span class="hljs-number">84</span>]: s = df.iloc[<span class="hljs-number">3</span>]<br><br>In [<span class="hljs-number">85</span>]: df.append(s, ignore_index=<span class="hljs-literal">True</span>)<br>Out[<span class="hljs-number">85</span>]: <br>          A         B         C         D<br><span class="hljs-number">0</span>  <span class="hljs-number">1.346061</span>  <span class="hljs-number">1.511763</span>  <span class="hljs-number">1.627081</span> -<span class="hljs-number">0.990582</span><br><span class="hljs-number">1</span> -<span class="hljs-number">0.441652</span>  <span class="hljs-number">1.211526</span>  <span class="hljs-number">0.268520</span>  <span class="hljs-number">0.024580</span><br><span class="hljs-number">2</span> -<span class="hljs-number">1.577585</span>  <span class="hljs-number">0.396823</span> -<span class="hljs-number">0.105381</span> -<span class="hljs-number">0.532532</span><br><span class="hljs-number">3</span>  <span class="hljs-number">1.453749</span>  <span class="hljs-number">1.208843</span> -<span class="hljs-number">0.080952</span> -<span class="hljs-number">0.264610</span><br><span class="hljs-number">4</span> -<span class="hljs-number">0.727965</span> -<span class="hljs-number">0.589346</span>  <span class="hljs-number">0.339969</span> -<span class="hljs-number">0.693205</span><br><span class="hljs-number">5</span> -<span class="hljs-number">0.339355</span>  <span class="hljs-number">0.593616</span>  <span class="hljs-number">0.884345</span>  <span class="hljs-number">1.591431</span><br><span class="hljs-number">6</span>  <span class="hljs-number">0.141809</span>  <span class="hljs-number">0.220390</span>  <span class="hljs-number">0.435589</span>  <span class="hljs-number">0.192451</span><br><span class="hljs-number">7</span> -<span class="hljs-number">0.096701</span>  <span class="hljs-number">0.803351</span>  <span class="hljs-number">1.715071</span> -<span class="hljs-number">0.708758</span><br><span class="hljs-number">8</span>  <span class="hljs-number">1.453749</span>  <span class="hljs-number">1.208843</span> -<span class="hljs-number">0.080952</span> -<span class="hljs-number">0.264610</span><br></code></pre></td></tr></table></figure><h2 id="七-分组"><a class="markdownIt-Anchor" href="#七-分组"></a> 七、分组</h2><p>对于”group by”操作，我们通常是指以下一个或多个操作步骤：</p><p>l （Splitting）按照一些规则将数据分为不同的组；</p><p>l （Applying）对于每组数据分别执行一个函数；</p><p>l （Combining）将结果组合到一个数据结构中；</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs prolog"><span class="hljs-symbol">In</span> [<span class="hljs-number">86</span>]: df = pd.<span class="hljs-symbol">DataFrame</span>(&#123;<span class="hljs-string">&#x27;A&#x27;</span> : [<span class="hljs-string">&#x27;foo&#x27;</span>, <span class="hljs-string">&#x27;bar&#x27;</span>, <span class="hljs-string">&#x27;foo&#x27;</span>, <span class="hljs-string">&#x27;bar&#x27;</span>,<br>   ....:                           <span class="hljs-string">&#x27;foo&#x27;</span>, <span class="hljs-string">&#x27;bar&#x27;</span>, <span class="hljs-string">&#x27;foo&#x27;</span>, <span class="hljs-string">&#x27;foo&#x27;</span>],<br>   ....:                    <span class="hljs-string">&#x27;B&#x27;</span> : [<span class="hljs-string">&#x27;one&#x27;</span>, <span class="hljs-string">&#x27;one&#x27;</span>, <span class="hljs-string">&#x27;two&#x27;</span>, <span class="hljs-string">&#x27;three&#x27;</span>,<br>   ....:                           <span class="hljs-string">&#x27;two&#x27;</span>, <span class="hljs-string">&#x27;two&#x27;</span>, <span class="hljs-string">&#x27;one&#x27;</span>, <span class="hljs-string">&#x27;three&#x27;</span>],<br>   ....:                    <span class="hljs-string">&#x27;C&#x27;</span> : np.random.randn(<span class="hljs-number">8</span>),<br>   ....:                    <span class="hljs-string">&#x27;D&#x27;</span> : np.random.randn(<span class="hljs-number">8</span>)&#125;)<br>   ....: <br><br><span class="hljs-symbol">In</span> [<span class="hljs-number">87</span>]: df<br><span class="hljs-symbol">Out</span>[<span class="hljs-number">87</span>]: <br>     <span class="hljs-symbol">A</span>      <span class="hljs-symbol">B</span>         <span class="hljs-symbol">C</span>         <span class="hljs-symbol">D</span><br><span class="hljs-number">0</span>  foo    one <span class="hljs-number">-1.202872</span> <span class="hljs-number">-0.055224</span><br><span class="hljs-number">1</span>  bar    one <span class="hljs-number">-1.814470</span>  <span class="hljs-number">2.395985</span><br><span class="hljs-number">2</span>  foo    two  <span class="hljs-number">1.018601</span>  <span class="hljs-number">1.552825</span><br><span class="hljs-number">3</span>  bar  three <span class="hljs-number">-0.595447</span>  <span class="hljs-number">0.166599</span><br><span class="hljs-number">4</span>  foo    two  <span class="hljs-number">1.395433</span>  <span class="hljs-number">0.047609</span><br><span class="hljs-number">5</span>  bar    two <span class="hljs-number">-0.392670</span> <span class="hljs-number">-0.136473</span><br><span class="hljs-number">6</span>  foo    one  <span class="hljs-number">0.007207</span> <span class="hljs-number">-0.561757</span><br><span class="hljs-number">7</span>  foo  three  <span class="hljs-number">1.928123</span> <span class="hljs-number">-1.623033</span><br></code></pre></td></tr></table></figure><p>1、 分组并对每个分组执行sum函数：</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs dns">In [<span class="hljs-number">88</span>]: df.groupby(&#x27;<span class="hljs-keyword">A</span>&#x27;).sum()<br>Out[<span class="hljs-number">88</span>]: <br>            C        D<br><span class="hljs-keyword">A</span>                     <br>bar -<span class="hljs-number">2.802588</span>  <span class="hljs-number">2.42611</span><br>foo  <span class="hljs-number">3.146492</span> -<span class="hljs-number">0.63958</span><br></code></pre></td></tr></table></figure><p>2、 通过多个列进行分组形成一个层次索引，然后执行函数：</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs dns">In [<span class="hljs-number">89</span>]: df.groupby([&#x27;<span class="hljs-keyword">A</span>&#x27;,&#x27;B&#x27;]).sum()<br>Out[<span class="hljs-number">89</span>]: <br>                  C         D<br><span class="hljs-keyword">A</span>   B                        <br>bar one   -<span class="hljs-number">1.814470</span>  <span class="hljs-number">2.395985</span><br>    three -<span class="hljs-number">0.595447</span>  <span class="hljs-number">0.166599</span><br>    two   -<span class="hljs-number">0.392670</span> -<span class="hljs-number">0.136473</span><br>foo one   -<span class="hljs-number">1.195665</span> -<span class="hljs-number">0.616981</span><br>    three  <span class="hljs-number">1.928123</span> -<span class="hljs-number">1.623033</span><br>    two    <span class="hljs-number">2.414034</span>  <span class="hljs-number">1.600434</span><br></code></pre></td></tr></table></figure><h2 id="八-重塑reshaping"><a class="markdownIt-Anchor" href="#八-重塑reshaping"></a> 八、重塑（Reshaping）</h2><p>Stack</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs prolog"><span class="hljs-symbol">In</span> [<span class="hljs-number">90</span>]: tuples = list(zip(*[[<span class="hljs-string">&#x27;bar&#x27;</span>, <span class="hljs-string">&#x27;bar&#x27;</span>, <span class="hljs-string">&#x27;baz&#x27;</span>, <span class="hljs-string">&#x27;baz&#x27;</span>,<br>   ....:                      <span class="hljs-string">&#x27;foo&#x27;</span>, <span class="hljs-string">&#x27;foo&#x27;</span>, <span class="hljs-string">&#x27;qux&#x27;</span>, <span class="hljs-string">&#x27;qux&#x27;</span>],<br>   ....:                     [<span class="hljs-string">&#x27;one&#x27;</span>, <span class="hljs-string">&#x27;two&#x27;</span>, <span class="hljs-string">&#x27;one&#x27;</span>, <span class="hljs-string">&#x27;two&#x27;</span>,<br>   ....:                      <span class="hljs-string">&#x27;one&#x27;</span>, <span class="hljs-string">&#x27;two&#x27;</span>, <span class="hljs-string">&#x27;one&#x27;</span>, <span class="hljs-string">&#x27;two&#x27;</span>]]))<br>   ....: <br><br><span class="hljs-symbol">In</span> [<span class="hljs-number">91</span>]: index = pd.<span class="hljs-symbol">MultiIndex</span>.from_tuples(tuples, names=[<span class="hljs-string">&#x27;first&#x27;</span>, <span class="hljs-string">&#x27;second&#x27;</span>])<br><br><span class="hljs-symbol">In</span> [<span class="hljs-number">92</span>]: df = pd.<span class="hljs-symbol">DataFrame</span>(np.random.randn(<span class="hljs-number">8</span>, <span class="hljs-number">2</span>), index=index, columns=[<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>])<br><br><span class="hljs-symbol">In</span> [<span class="hljs-number">93</span>]: df2 = df[:<span class="hljs-number">4</span>]<br><br><span class="hljs-symbol">In</span> [<span class="hljs-number">94</span>]: df2<br><span class="hljs-symbol">Out</span>[<span class="hljs-number">94</span>]: <br>                     <span class="hljs-symbol">A</span>         <span class="hljs-symbol">B</span><br>first second                    <br>bar   one     <span class="hljs-number">0.029399</span> <span class="hljs-number">-0.542108</span><br>      two     <span class="hljs-number">0.282696</span> <span class="hljs-number">-0.087302</span><br>baz   one    <span class="hljs-number">-1.575170</span>  <span class="hljs-number">1.771208</span><br>      two     <span class="hljs-number">0.816482</span>  <span class="hljs-number">1.100230</span><br></code></pre></td></tr></table></figure><p>stack()方法在DataFrame列的层次上压缩</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">In</span> [<span class="hljs-number">95</span>]: <span class="hljs-keyword">stacked</span> = df2.stack()<br><br><span class="hljs-keyword">In</span> [<span class="hljs-number">96</span>]: <span class="hljs-keyword">stacked</span><br><span class="hljs-keyword">Out</span>[<span class="hljs-number">96</span>]: <br>first  second   <br>bar    one     A    <span class="hljs-number">0.029399</span><br>               B   <span class="hljs-number">-0.542108</span><br>       two     A    <span class="hljs-number">0.282696</span><br>               B   <span class="hljs-number">-0.087302</span><br>baz    one     A   <span class="hljs-number">-1.575170</span><br>               B    <span class="hljs-number">1.771208</span><br>       two     A    <span class="hljs-number">0.816482</span><br>               B    <span class="hljs-number">1.100230</span><br>dtype: float64<br></code></pre></td></tr></table></figure><p>整合DataFrame或者Series（MultiIndex作为索引），stack()的逆运算是isunstack(),默认情况下unStack上一次的情况。</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">In</span> [<span class="hljs-number">97</span>]: <span class="hljs-keyword">stacked</span>.unstack()<br><span class="hljs-keyword">Out</span>[<span class="hljs-number">97</span>]: <br>                     A         B<br>first second                    <br>bar   one     <span class="hljs-number">0.029399</span> <span class="hljs-number">-0.542108</span><br>      two     <span class="hljs-number">0.282696</span> <span class="hljs-number">-0.087302</span><br>baz   one    <span class="hljs-number">-1.575170</span>  <span class="hljs-number">1.771208</span><br>      two     <span class="hljs-number">0.816482</span>  <span class="hljs-number">1.100230</span><br><br><span class="hljs-keyword">In</span> [<span class="hljs-number">98</span>]: <span class="hljs-keyword">stacked</span>.unstack(<span class="hljs-number">1</span>)<br><span class="hljs-keyword">Out</span>[<span class="hljs-number">98</span>]: <br>second        one       two<br>first                      <br>bar   A  <span class="hljs-number">0.029399</span>  <span class="hljs-number">0.282696</span><br>      B <span class="hljs-number">-0.542108</span> <span class="hljs-number">-0.087302</span><br>baz   A <span class="hljs-number">-1.575170</span>  <span class="hljs-number">0.816482</span><br>      B  <span class="hljs-number">1.771208</span>  <span class="hljs-number">1.100230</span><br><br><span class="hljs-keyword">In</span> [<span class="hljs-number">99</span>]: <span class="hljs-keyword">stacked</span>.unstack(<span class="hljs-number">0</span>)<br><span class="hljs-keyword">Out</span>[<span class="hljs-number">99</span>]: <br>first          bar       baz<br>second                      <br>one    A  <span class="hljs-number">0.029399</span> <span class="hljs-number">-1.575170</span><br>       B <span class="hljs-number">-0.542108</span>  <span class="hljs-number">1.771208</span><br>two    A  <span class="hljs-number">0.282696</span>  <span class="hljs-number">0.816482</span><br>       B <span class="hljs-number">-0.087302</span>  <span class="hljs-number">1.100230</span><br></code></pre></td></tr></table></figure><p><strong>数据透视表</strong></p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs dns">In [<span class="hljs-number">100</span>]: df = pd.DataFrame(&#123;&#x27;<span class="hljs-keyword">A</span>&#x27; : [&#x27;one&#x27;, &#x27;one&#x27;, &#x27;two&#x27;, &#x27;three&#x27;] * <span class="hljs-number">3</span>,<br>   .....:                    &#x27;B&#x27; : [&#x27;<span class="hljs-keyword">A</span>&#x27;, &#x27;B&#x27;, &#x27;C&#x27;] * <span class="hljs-number">4</span>,<br>   .....:                    &#x27;C&#x27; : [&#x27;foo&#x27;, &#x27;foo&#x27;, &#x27;foo&#x27;, &#x27;bar&#x27;, &#x27;bar&#x27;, &#x27;bar&#x27;] * <span class="hljs-number">2</span>,<br>   .....:                    &#x27;D&#x27; : np.random.randn(<span class="hljs-number">12</span>),<br>   .....:                    &#x27;E&#x27; : np.random.randn(<span class="hljs-number">12</span>)&#125;)<br>   .....: <br><br>In [<span class="hljs-number">101</span>]: df<br>Out[<span class="hljs-number">101</span>]: <br>        <span class="hljs-keyword">A</span>  B    C         D         E<br><span class="hljs-number">0</span>     one  <span class="hljs-keyword">A</span>  foo  <span class="hljs-number">1.418757</span> -<span class="hljs-number">0.179666</span><br><span class="hljs-number">1</span>     one  B  foo -<span class="hljs-number">1.879024</span>  <span class="hljs-number">1.291836</span><br><span class="hljs-number">2</span>     two  C  foo  <span class="hljs-number">0.536826</span> -<span class="hljs-number">0.009614</span><br><span class="hljs-number">3</span>   three  <span class="hljs-keyword">A</span>  bar  <span class="hljs-number">1.006160</span>  <span class="hljs-number">0.392149</span><br><span class="hljs-number">4</span>     one  B  bar -<span class="hljs-number">0.029716</span>  <span class="hljs-number">0.264599</span><br><span class="hljs-number">5</span>     one  C  bar -<span class="hljs-number">1.146178</span> -<span class="hljs-number">0.057409</span><br><span class="hljs-number">6</span>     two  <span class="hljs-keyword">A</span>  foo  <span class="hljs-number">0.100900</span> -<span class="hljs-number">1.425638</span><br><span class="hljs-number">7</span>   three  B  foo -<span class="hljs-number">1.035018</span>  <span class="hljs-number">1.024098</span><br><span class="hljs-number">8</span>     one  C  foo  <span class="hljs-number">0.314665</span> -<span class="hljs-number">0.106062</span><br><span class="hljs-number">9</span>     one  <span class="hljs-keyword">A</span>  bar -<span class="hljs-number">0.773723</span>  <span class="hljs-number">1.824375</span><br><span class="hljs-number">10</span>    two  B  bar -<span class="hljs-number">1.170653</span>  <span class="hljs-number">0.595974</span><br><span class="hljs-number">11</span>  three  C  bar  <span class="hljs-number">0.648740</span>  <span class="hljs-number">1.167115</span><br></code></pre></td></tr></table></figure><p>可以从这个数据中轻松的生成数据透视表：</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs dns">In [<span class="hljs-number">102</span>]: pd.pivot_table(df, values=&#x27;D&#x27;, index=[&#x27;<span class="hljs-keyword">A</span>&#x27;, &#x27;B&#x27;], columns=[&#x27;C&#x27;])<br>Out[<span class="hljs-number">102</span>]: <br>C             bar       foo<br><span class="hljs-keyword">A</span>     B                    <br>one   <span class="hljs-keyword">A</span> -<span class="hljs-number">0.773723</span>  <span class="hljs-number">1.418757</span><br>      B -<span class="hljs-number">0.029716</span> -<span class="hljs-number">1.879024</span><br>      C -<span class="hljs-number">1.146178</span>  <span class="hljs-number">0.314665</span><br>three <span class="hljs-keyword">A</span>  <span class="hljs-number">1.006160</span>       NaN<br>      B       NaN -<span class="hljs-number">1.035018</span><br>      C  <span class="hljs-number">0.648740</span>       NaN<br>two   <span class="hljs-keyword">A</span>       NaN  <span class="hljs-number">0.100900</span><br>      B -<span class="hljs-number">1.170653</span>       NaN<br>      C       NaN  <span class="hljs-number">0.536826</span><br></code></pre></td></tr></table></figure><h2 id="九-时间序列"><a class="markdownIt-Anchor" href="#九-时间序列"></a> 九、时间序列</h2><p>Pandas在对频率转换进行重新采样时拥有简单、强大且高效的功能（如将按秒采样的数据转换为按5分钟为单位进行采样的数据）。这种操作在金融领域非常常见。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs stylus">In <span class="hljs-selector-attr">[103]</span>: rng = pd<span class="hljs-selector-class">.date_range</span>(<span class="hljs-string">&#x27;1/1/2012&#x27;</span>, periods=<span class="hljs-number">100</span>, freq=<span class="hljs-string">&#x27;S&#x27;</span>)<br><br>In <span class="hljs-selector-attr">[104]</span>: ts = pd<span class="hljs-selector-class">.Series</span>(np<span class="hljs-selector-class">.random</span><span class="hljs-selector-class">.randint</span>(<span class="hljs-number">0</span>, <span class="hljs-number">500</span>, <span class="hljs-built_in">len</span>(rng)), index=rng)<br><br>In <span class="hljs-selector-attr">[105]</span>: ts<span class="hljs-selector-class">.resample</span>(<span class="hljs-string">&#x27;5Min&#x27;</span>)<span class="hljs-selector-class">.sum</span>()<br>Out<span class="hljs-selector-attr">[105]</span>: <br><span class="hljs-number">2012</span>-<span class="hljs-number">01</span>-<span class="hljs-number">01</span>    <span class="hljs-number">25083</span><br>Freq: <span class="hljs-number">5</span>T, dtype: int64<br></code></pre></td></tr></table></figure><p>1、 时区表示：</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs subunit">In [106]: rng = pd.date_range(&#x27;3/6/2012 00:00&#x27;, periods=5, freq=&#x27;D&#x27;)<br><br>In [107]: ts = pd.Series(np.random.randn(len(rng)), rng)<br><br>In [108]: ts<br>Out[108]: <br>2012<span class="hljs-string">-03</span><span class="hljs-string">-06</span>    0.464000<br>2012<span class="hljs-string">-03</span><span class="hljs-string">-07</span>    0.227371<br>2012<span class="hljs-string">-03</span><span class="hljs-string">-08</span>   <span class="hljs-string">-0</span>.496922<br>2012<span class="hljs-string">-03</span><span class="hljs-string">-09</span>    0.306389<br>2012<span class="hljs-string">-03</span><span class="hljs-string">-10</span>   <span class="hljs-string">-2</span>.290613<br>Freq: D, dtype: float64<br><br>In [109]: ts_utc = ts.tz_localize(&#x27;UTC&#x27;)<br><br>In [110]: ts_utc<br>Out[110]: <br>2012<span class="hljs-string">-03</span><span class="hljs-string">-06</span> 00:00:00<span class="hljs-string">+00</span>:00    0.464000<br>2012<span class="hljs-string">-03</span><span class="hljs-string">-07</span> 00:00:00<span class="hljs-string">+00</span>:00    0.227371<br>2012<span class="hljs-string">-03</span><span class="hljs-string">-08</span> 00:00:00<span class="hljs-string">+00</span>:00   <span class="hljs-string">-0</span>.496922<br>2012<span class="hljs-string">-03</span><span class="hljs-string">-09</span> 00:00:00<span class="hljs-string">+00</span>:00    0.306389<br>2012<span class="hljs-string">-03</span><span class="hljs-string">-10</span> 00:00:00<span class="hljs-string">+00</span>:00   <span class="hljs-string">-2</span>.290613<br>Freq: D, dtype: float64<br></code></pre></td></tr></table></figure><p>2、 时区转换：</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs subunit">In [111]: ts_utc.tz_convert(&#x27;US/Eastern&#x27;)<br>Out[111]: <br>2012<span class="hljs-string">-03</span><span class="hljs-string">-05</span> 19:00:00<span class="hljs-string">-05</span>:00    0.464000<br>2012<span class="hljs-string">-03</span><span class="hljs-string">-06</span> 19:00:00<span class="hljs-string">-05</span>:00    0.227371<br>2012<span class="hljs-string">-03</span><span class="hljs-string">-07</span> 19:00:00<span class="hljs-string">-05</span>:00   <span class="hljs-string">-0</span>.496922<br>2012<span class="hljs-string">-03</span><span class="hljs-string">-08</span> 19:00:00<span class="hljs-string">-05</span>:00    0.306389<br>2012<span class="hljs-string">-03</span><span class="hljs-string">-09</span> 19:00:00<span class="hljs-string">-05</span>:00   <span class="hljs-string">-2</span>.290613<br>Freq: D, dtype: float64<br></code></pre></td></tr></table></figure><p>3、 时间跨度转换：</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs subunit">In [112]: rng = pd.date_range(&#x27;1/1/2012&#x27;, periods=5, freq=&#x27;M&#x27;)<br><br>In [113]: ts = pd.Series(np.random.randn(len(rng)), index=rng)<br>In [114]: ts<br>Out[114]: <br>2012<span class="hljs-string">-01</span><span class="hljs-string">-31</span>   <span class="hljs-string">-1</span>.134623<br>2012<span class="hljs-string">-02</span><span class="hljs-string">-29</span>   <span class="hljs-string">-1</span>.561819<br>2012<span class="hljs-string">-03</span><span class="hljs-string">-31</span>   <span class="hljs-string">-0</span>.260838<br>2012<span class="hljs-string">-04</span><span class="hljs-string">-30</span>    0.281957<br>2012<span class="hljs-string">-05</span><span class="hljs-string">-31</span>    1.523962<br>Freq: M, dtype: float64<br><br>In [115]: ps = ts.to_period()<br><br>In [116]: ps<br>Out[116]: <br>2012<span class="hljs-string">-01</span>   <span class="hljs-string">-1</span>.134623<br>2012<span class="hljs-string">-02</span>   <span class="hljs-string">-1</span>.561819<br>2012<span class="hljs-string">-03</span>   <span class="hljs-string">-0</span>.260838<br>2012<span class="hljs-string">-04</span>    0.281957<br>2012<span class="hljs-string">-05</span>    1.523962<br>Freq: M, dtype: float64<br><br>In [117]: ps.to_timestamp()<br>Out[117]: <br>2012<span class="hljs-string">-01</span><span class="hljs-string">-01</span>   <span class="hljs-string">-1</span>.134623<br>2012<span class="hljs-string">-02</span><span class="hljs-string">-01</span>   <span class="hljs-string">-1</span>.561819<br>2012<span class="hljs-string">-03</span><span class="hljs-string">-01</span>   <span class="hljs-string">-0</span>.260838<br>2012<span class="hljs-string">-04</span><span class="hljs-string">-01</span>    0.281957<br>2012<span class="hljs-string">-05</span><span class="hljs-string">-01</span>    1.523962<br>Freq: MS, dtype: float64<br></code></pre></td></tr></table></figure><p>4、 时期和时间戳之间的转换使得可以使用一些方便的算术函数。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs stylus">In <span class="hljs-selector-attr">[118]</span>: prng = pd<span class="hljs-selector-class">.period_range</span>(<span class="hljs-string">&#x27;1990Q1&#x27;</span>, <span class="hljs-string">&#x27;2000Q4&#x27;</span>, freq=<span class="hljs-string">&#x27;Q-NOV&#x27;</span>)<br><br>In <span class="hljs-selector-attr">[119]</span>: ts = pd<span class="hljs-selector-class">.Series</span>(np<span class="hljs-selector-class">.random</span><span class="hljs-selector-class">.randn</span>(<span class="hljs-built_in">len</span>(prng)), prng)<br><br>In <span class="hljs-selector-attr">[120]</span>: ts<span class="hljs-selector-class">.index</span> = (prng<span class="hljs-selector-class">.asfreq</span>(<span class="hljs-string">&#x27;M&#x27;</span>, <span class="hljs-string">&#x27;e&#x27;</span>) + <span class="hljs-number">1</span>)<span class="hljs-selector-class">.asfreq</span>(<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;s&#x27;</span>) + <span class="hljs-number">9</span><br><br>In <span class="hljs-selector-attr">[121]</span>: ts<span class="hljs-selector-class">.head</span>()<br>Out<span class="hljs-selector-attr">[121]</span>: <br><span class="hljs-number">1990</span>-<span class="hljs-number">03</span>-<span class="hljs-number">01</span> <span class="hljs-number">09</span>:<span class="hljs-number">00</span>   -<span class="hljs-number">0.902937</span><br><span class="hljs-number">1990</span>-<span class="hljs-number">06</span>-<span class="hljs-number">01</span> <span class="hljs-number">09</span>:<span class="hljs-number">00</span>    <span class="hljs-number">0.068159</span><br><span class="hljs-number">1990</span>-<span class="hljs-number">09</span>-<span class="hljs-number">01</span> <span class="hljs-number">09</span>:<span class="hljs-number">00</span>   -<span class="hljs-number">0.057873</span><br><span class="hljs-number">1990</span>-<span class="hljs-number">12</span>-<span class="hljs-number">01</span> <span class="hljs-number">09</span>:<span class="hljs-number">00</span>   -<span class="hljs-number">0.368204</span><br><span class="hljs-number">1991</span>-<span class="hljs-number">03</span>-<span class="hljs-number">01</span> <span class="hljs-number">09</span>:<span class="hljs-number">00</span>   -<span class="hljs-number">1.144073</span><br>Freq: H, dtype: float64<br></code></pre></td></tr></table></figure><h2 id="十-categorical"><a class="markdownIt-Anchor" href="#十-categorical"></a> 十、Categorical</h2><p>从0.15版本开始，pandas可以在DataFrame中支持Categorical类型的数据。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">In <span class="hljs-selector-attr">[122]</span>: df = pd<span class="hljs-selector-class">.DataFrame</span>(&#123;<span class="hljs-string">&quot;id&quot;</span>:<span class="hljs-selector-attr">[1,2,3,4,5,6]</span>, <span class="hljs-string">&quot;raw_grade&quot;</span>:<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;e&#x27;</span>]</span>&#125;)<br></code></pre></td></tr></table></figure><p>1、 将原始的grade转换为Categorical数据类型：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs stylus">In <span class="hljs-selector-attr">[123]</span>: df<span class="hljs-selector-attr">[<span class="hljs-string">&quot;grade&quot;</span>]</span> = df<span class="hljs-selector-attr">[<span class="hljs-string">&quot;raw_grade&quot;</span>]</span><span class="hljs-selector-class">.astype</span>(<span class="hljs-string">&quot;category&quot;</span>)<br><br>In <span class="hljs-selector-attr">[124]</span>: df<span class="hljs-selector-attr">[<span class="hljs-string">&quot;grade&quot;</span>]</span><br>Out<span class="hljs-selector-attr">[124]</span>: <br><span class="hljs-number">0</span>    <span class="hljs-selector-tag">a</span><br><span class="hljs-number">1</span>    <span class="hljs-selector-tag">b</span><br><span class="hljs-number">2</span>    <span class="hljs-selector-tag">b</span><br><span class="hljs-number">3</span>    <span class="hljs-selector-tag">a</span><br><span class="hljs-number">4</span>    <span class="hljs-selector-tag">a</span><br><span class="hljs-number">5</span>    e<br>Name: grade, dtype: category<br>Categories (<span class="hljs-number">3</span>, object): <span class="hljs-selector-attr">[a, b, e]</span><br></code></pre></td></tr></table></figure><p>2、 将Categorical类型数据重命名为更有意义的名称：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">In <span class="hljs-selector-attr">[125]</span>: df<span class="hljs-selector-attr">[<span class="hljs-string">&quot;grade&quot;</span>]</span><span class="hljs-selector-class">.cat</span><span class="hljs-selector-class">.categories</span> = <span class="hljs-selector-attr">[<span class="hljs-string">&quot;very good&quot;</span>, <span class="hljs-string">&quot;good&quot;</span>, <span class="hljs-string">&quot;very bad&quot;</span>]</span><br></code></pre></td></tr></table></figure><p>3、 对类别进行重新排序，增加缺失的类别：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs stylus">In <span class="hljs-selector-attr">[126]</span>: df<span class="hljs-selector-attr">[<span class="hljs-string">&quot;grade&quot;</span>]</span> = df<span class="hljs-selector-attr">[<span class="hljs-string">&quot;grade&quot;</span>]</span><span class="hljs-selector-class">.cat</span><span class="hljs-selector-class">.set_categories</span>(<span class="hljs-selector-attr">[<span class="hljs-string">&quot;very bad&quot;</span>, <span class="hljs-string">&quot;bad&quot;</span>, <span class="hljs-string">&quot;medium&quot;</span>, <span class="hljs-string">&quot;good&quot;</span>, <span class="hljs-string">&quot;very good&quot;</span>]</span>)<br><br>In <span class="hljs-selector-attr">[127]</span>: df<span class="hljs-selector-attr">[<span class="hljs-string">&quot;grade&quot;</span>]</span><br>Out<span class="hljs-selector-attr">[127]</span>: <br><span class="hljs-number">0</span>    very good<br><span class="hljs-number">1</span>         good<br><span class="hljs-number">2</span>         good<br><span class="hljs-number">3</span>    very good<br><span class="hljs-number">4</span>    very good<br><span class="hljs-number">5</span>     very bad<br>Name: grade, dtype: category<br>Categories (<span class="hljs-number">5</span>, object): <span class="hljs-selector-attr">[very bad, bad, medium, good, very good]</span><br></code></pre></td></tr></table></figure><p>4、 排序是按照Categorical的顺序进行的而不是按照字典顺序进行：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs stylus">In <span class="hljs-selector-attr">[128]</span>: df<span class="hljs-selector-class">.sort_values</span>(by=<span class="hljs-string">&quot;grade&quot;</span>)<br>Out<span class="hljs-selector-attr">[128]</span>: <br>   id raw_grade      grade<br><span class="hljs-number">5</span>   <span class="hljs-number">6</span>         e   very bad<br><span class="hljs-number">1</span>   <span class="hljs-number">2</span>         <span class="hljs-selector-tag">b</span>       good<br><span class="hljs-number">2</span>   <span class="hljs-number">3</span>         <span class="hljs-selector-tag">b</span>       good<br><span class="hljs-number">0</span>   <span class="hljs-number">1</span>         <span class="hljs-selector-tag">a</span>  very good<br><span class="hljs-number">3</span>   <span class="hljs-number">4</span>         <span class="hljs-selector-tag">a</span>  very good<br><span class="hljs-number">4</span>   <span class="hljs-number">5</span>         <span class="hljs-selector-tag">a</span>  very good<br></code></pre></td></tr></table></figure><p>5、 对Categorical列进行排序时存在空的类别：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs stylus">In <span class="hljs-selector-attr">[129]</span>: df<span class="hljs-selector-class">.groupby</span>(<span class="hljs-string">&quot;grade&quot;</span>)<span class="hljs-selector-class">.size</span>()<br>Out<span class="hljs-selector-attr">[129]</span>: <br>grade<br>very bad     <span class="hljs-number">1</span><br>bad          <span class="hljs-number">0</span><br>medium       <span class="hljs-number">0</span><br>good         <span class="hljs-number">2</span><br>very good    <span class="hljs-number">3</span><br>dtype: int64<br></code></pre></td></tr></table></figure><h2 id="十一-画图"><a class="markdownIt-Anchor" href="#十一-画图"></a> 十一、画图</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus">In <span class="hljs-selector-attr">[130]</span>: ts = pd<span class="hljs-selector-class">.Series</span>(np<span class="hljs-selector-class">.random</span><span class="hljs-selector-class">.randn</span>(<span class="hljs-number">1000</span>), index=pd<span class="hljs-selector-class">.date_range</span>(<span class="hljs-string">&#x27;1/1/2000&#x27;</span>, periods=<span class="hljs-number">1000</span>))<br><br>In <span class="hljs-selector-attr">[131]</span>: ts = ts<span class="hljs-selector-class">.cumsum</span>()<br><br>In <span class="hljs-selector-attr">[132]</span>: ts<span class="hljs-selector-class">.plot</span>()<br>Out<span class="hljs-selector-attr">[132]</span>: &lt;matplotlib<span class="hljs-selector-class">.axes</span>._subplots<span class="hljs-selector-class">.AxesSubplot</span> at <span class="hljs-number">0</span>x10efd5a90&gt;<br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306212026632.png" srcset="/img/loading.gif" lazyload alt="series_plot_basic"></p><p>对于DataFrame来说，plot是一种将所有列及其标签进行绘制的简便方法：</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs scss">In <span class="hljs-selector-attr">[133]</span>: df = pd.<span class="hljs-built_in">DataFrame</span>(np.random.<span class="hljs-built_in">randn</span>(<span class="hljs-number">1000</span>, <span class="hljs-number">4</span>), index=ts.index,<br>   .....:                   columns=[<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>])<br>   .....: <br><br>In [<span class="hljs-number">134</span>]: df = df.<span class="hljs-built_in">cumsum</span>()<br><br>In [<span class="hljs-number">135</span>]: plt.<span class="hljs-built_in">figure</span>(); df<span class="hljs-selector-class">.plot</span>(); plt<span class="hljs-selector-class">.legend</span>(loc=&#x27;best&#x27;)<br>Out<span class="hljs-selector-attr">[135]</span>: &lt;matplotlib.legend.Legend at <span class="hljs-number">0</span>x112854d90&gt;<br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306212026633.png" srcset="/img/loading.gif" lazyload alt="frame_plot_basic"></p><h2 id="十二-导入和保存数据"><a class="markdownIt-Anchor" href="#十二-导入和保存数据"></a> 十二、导入和保存数据</h2><p><strong>CSV</strong></p><p>1、 写入csv文件：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">In <span class="hljs-selector-attr">[136]</span>: df.<span class="hljs-built_in">to_csv</span>(<span class="hljs-string">&#x27;foo.csv&#x27;</span>)<br></code></pre></td></tr></table></figure><p>2、 从csv文件中读取：</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs dns">In [<span class="hljs-number">137</span>]: pd.read_csv(&#x27;foo.csv&#x27;)<br>Out[<span class="hljs-number">137</span>]: <br>     Unnamed: <span class="hljs-number">0</span>          <span class="hljs-keyword">A</span>          B         C          D<br><span class="hljs-number">0</span>    <span class="hljs-number">2000-01-01</span>   <span class="hljs-number">0.266457</span>  -<span class="hljs-number">0.399641</span> -<span class="hljs-number">0.219582</span>   <span class="hljs-number">1.186860</span><br><span class="hljs-number">1</span>    <span class="hljs-number">2000-01-02</span>  -<span class="hljs-number">1.170732</span>  -<span class="hljs-number">0.345873</span>  <span class="hljs-number">1.653061</span>  -<span class="hljs-number">0.282953</span><br><span class="hljs-number">2</span>    <span class="hljs-number">2000-01-03</span>  -<span class="hljs-number">1.734933</span>   <span class="hljs-number">0.530468</span>  <span class="hljs-number">2.060811</span>  -<span class="hljs-number">0.515536</span><br><span class="hljs-number">3</span>    <span class="hljs-number">2000-01-04</span>  -<span class="hljs-number">1.555121</span>   <span class="hljs-number">1.452620</span>  <span class="hljs-number">0.239859</span>  -<span class="hljs-number">1.156896</span><br><span class="hljs-number">4</span>    <span class="hljs-number">2000-01-05</span>   <span class="hljs-number">0.578117</span>   <span class="hljs-number">0.511371</span>  <span class="hljs-number">0.103552</span>  -<span class="hljs-number">2.428202</span><br><span class="hljs-number">5</span>    <span class="hljs-number">2000-01-06</span>   <span class="hljs-number">0.478344</span>   <span class="hljs-number">0.449933</span> -<span class="hljs-number">0.741620</span>  -<span class="hljs-number">1.962409</span><br><span class="hljs-number">6</span>    <span class="hljs-number">2000-01-07</span>   <span class="hljs-number">1.235339</span>  -<span class="hljs-number">0.091757</span> -<span class="hljs-number">1.543861</span>  -<span class="hljs-number">1.084753</span><br>..          ...        ...        ...       ...        ...<br><span class="hljs-number">993</span>  <span class="hljs-number">2002-09-20</span> -<span class="hljs-number">10.628548</span>  -<span class="hljs-number">9.153563</span> -<span class="hljs-number">7.883146</span>  <span class="hljs-number">28.313940</span><br><span class="hljs-number">994</span>  <span class="hljs-number">2002-09-21</span> -<span class="hljs-number">10.390377</span>  -<span class="hljs-number">8.727491</span> -<span class="hljs-number">6.399645</span>  <span class="hljs-number">30.914107</span><br><span class="hljs-number">995</span>  <span class="hljs-number">2002-09-22</span>  -<span class="hljs-number">8.985362</span>  -<span class="hljs-number">8.485624</span> -<span class="hljs-number">4.669462</span>  <span class="hljs-number">31.367740</span><br><span class="hljs-number">996</span>  <span class="hljs-number">2002-09-23</span>  -<span class="hljs-number">9.558560</span>  -<span class="hljs-number">8.781216</span> -<span class="hljs-number">4.499815</span>  <span class="hljs-number">30.518439</span><br><span class="hljs-number">997</span>  <span class="hljs-number">2002-09-24</span>  -<span class="hljs-number">9.902058</span>  -<span class="hljs-number">9.340490</span> -<span class="hljs-number">4.386639</span>  <span class="hljs-number">30.105593</span><br><span class="hljs-number">998</span>  <span class="hljs-number">2002-09-25</span> -<span class="hljs-number">10.216020</span>  -<span class="hljs-number">9.480682</span> -<span class="hljs-number">3.933802</span>  <span class="hljs-number">29.758560</span><br><span class="hljs-number">999</span>  <span class="hljs-number">2002-09-26</span> -<span class="hljs-number">11.856774</span> -<span class="hljs-number">10.671012</span> -<span class="hljs-number">3.216025</span>  <span class="hljs-number">29.369368</span><br><br>[<span class="hljs-number">1000</span> rows x <span class="hljs-number">5</span> columns]<br></code></pre></td></tr></table></figure><p><strong>HDF5</strong></p><p>1、 写入HDF5存储：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">In <span class="hljs-selector-attr">[138]</span>: df.<span class="hljs-built_in">to_hdf</span>(<span class="hljs-string">&#x27;foo.h5&#x27;</span>,<span class="hljs-string">&#x27;df&#x27;</span>)<br></code></pre></td></tr></table></figure><p>2、 从HDF5存储中读取：</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs dns">In [<span class="hljs-number">139</span>]: pd.read_hdf(&#x27;foo.h5&#x27;,&#x27;df&#x27;)<br>Out[<span class="hljs-number">139</span>]: <br>                    <span class="hljs-keyword">A</span>          B         C          D<br><span class="hljs-number">2000-01-01</span>   <span class="hljs-number">0.266457</span>  -<span class="hljs-number">0.399641</span> -<span class="hljs-number">0.219582</span>   <span class="hljs-number">1.186860</span><br><span class="hljs-number">2000-01-02</span>  -<span class="hljs-number">1.170732</span>  -<span class="hljs-number">0.345873</span>  <span class="hljs-number">1.653061</span>  -<span class="hljs-number">0.282953</span><br><span class="hljs-number">2000-01-03</span>  -<span class="hljs-number">1.734933</span>   <span class="hljs-number">0.530468</span>  <span class="hljs-number">2.060811</span>  -<span class="hljs-number">0.515536</span><br><span class="hljs-number">2000-01-04</span>  -<span class="hljs-number">1.555121</span>   <span class="hljs-number">1.452620</span>  <span class="hljs-number">0.239859</span>  -<span class="hljs-number">1.156896</span><br><span class="hljs-number">2000-01-05</span>   <span class="hljs-number">0.578117</span>   <span class="hljs-number">0.511371</span>  <span class="hljs-number">0.103552</span>  -<span class="hljs-number">2.428202</span><br><span class="hljs-number">2000-01-06</span>   <span class="hljs-number">0.478344</span>   <span class="hljs-number">0.449933</span> -<span class="hljs-number">0.741620</span>  -<span class="hljs-number">1.962409</span><br><span class="hljs-number">2000-01-07</span>   <span class="hljs-number">1.235339</span>  -<span class="hljs-number">0.091757</span> -<span class="hljs-number">1.543861</span>  -<span class="hljs-number">1.084753</span><br>...               ...        ...       ...        ...<br><span class="hljs-number">2002-09-20</span> -<span class="hljs-number">10.628548</span>  -<span class="hljs-number">9.153563</span> -<span class="hljs-number">7.883146</span>  <span class="hljs-number">28.313940</span><br><span class="hljs-number">2002-09-21</span> -<span class="hljs-number">10.390377</span>  -<span class="hljs-number">8.727491</span> -<span class="hljs-number">6.399645</span>  <span class="hljs-number">30.914107</span><br><span class="hljs-number">2002-09-22</span>  -<span class="hljs-number">8.985362</span>  -<span class="hljs-number">8.485624</span> -<span class="hljs-number">4.669462</span>  <span class="hljs-number">31.367740</span><br><span class="hljs-number">2002-09-23</span>  -<span class="hljs-number">9.558560</span>  -<span class="hljs-number">8.781216</span> -<span class="hljs-number">4.499815</span>  <span class="hljs-number">30.518439</span><br><span class="hljs-number">2002-09-24</span>  -<span class="hljs-number">9.902058</span>  -<span class="hljs-number">9.340490</span> -<span class="hljs-number">4.386639</span>  <span class="hljs-number">30.105593</span><br><span class="hljs-number">2002-09-25</span> -<span class="hljs-number">10.216020</span>  -<span class="hljs-number">9.480682</span> -<span class="hljs-number">3.933802</span>  <span class="hljs-number">29.758560</span><br><span class="hljs-number">2002-09-26</span> -<span class="hljs-number">11.856774</span> -<span class="hljs-number">10.671012</span> -<span class="hljs-number">3.216025</span>  <span class="hljs-number">29.369368</span><br><br>[<span class="hljs-number">1000</span> rows x <span class="hljs-number">4</span> columns]<br></code></pre></td></tr></table></figure><p><strong>Excel</strong></p><p>1、 写入excel文件：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">In <span class="hljs-selector-attr">[140]</span>: df.<span class="hljs-built_in">to_excel</span>(<span class="hljs-string">&#x27;foo.xlsx&#x27;</span>, sheet_name=<span class="hljs-string">&#x27;Sheet1&#x27;</span>)<br></code></pre></td></tr></table></figure><p>2、 从excel文件中读取：</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs dns">In [<span class="hljs-number">141</span>]: pd.read_excel(&#x27;foo.xlsx&#x27;, &#x27;Sheet1&#x27;, index_col=None, na_values=[&#x27;NA&#x27;])<br>Out[<span class="hljs-number">141</span>]: <br>                    <span class="hljs-keyword">A</span>          B         C          D<br><span class="hljs-number">2000-01-01</span>   <span class="hljs-number">0.266457</span>  -<span class="hljs-number">0.399641</span> -<span class="hljs-number">0.219582</span>   <span class="hljs-number">1.186860</span><br><span class="hljs-number">2000-01-02</span>  -<span class="hljs-number">1.170732</span>  -<span class="hljs-number">0.345873</span>  <span class="hljs-number">1.653061</span>  -<span class="hljs-number">0.282953</span><br><span class="hljs-number">2000-01-03</span>  -<span class="hljs-number">1.734933</span>   <span class="hljs-number">0.530468</span>  <span class="hljs-number">2.060811</span>  -<span class="hljs-number">0.515536</span><br><span class="hljs-number">2000-01-04</span>  -<span class="hljs-number">1.555121</span>   <span class="hljs-number">1.452620</span>  <span class="hljs-number">0.239859</span>  -<span class="hljs-number">1.156896</span><br><span class="hljs-number">2000-01-05</span>   <span class="hljs-number">0.578117</span>   <span class="hljs-number">0.511371</span>  <span class="hljs-number">0.103552</span>  -<span class="hljs-number">2.428202</span><br><span class="hljs-number">2000-01-06</span>   <span class="hljs-number">0.478344</span>   <span class="hljs-number">0.449933</span> -<span class="hljs-number">0.741620</span>  -<span class="hljs-number">1.962409</span><br><span class="hljs-number">2000-01-07</span>   <span class="hljs-number">1.235339</span>  -<span class="hljs-number">0.091757</span> -<span class="hljs-number">1.543861</span>  -<span class="hljs-number">1.084753</span><br>...               ...        ...       ...        ...<br><span class="hljs-number">2002-09-20</span> -<span class="hljs-number">10.628548</span>  -<span class="hljs-number">9.153563</span> -<span class="hljs-number">7.883146</span>  <span class="hljs-number">28.313940</span><br><span class="hljs-number">2002-09-21</span> -<span class="hljs-number">10.390377</span>  -<span class="hljs-number">8.727491</span> -<span class="hljs-number">6.399645</span>  <span class="hljs-number">30.914107</span><br><span class="hljs-number">2002-09-22</span>  -<span class="hljs-number">8.985362</span>  -<span class="hljs-number">8.485624</span> -<span class="hljs-number">4.669462</span>  <span class="hljs-number">31.367740</span><br><span class="hljs-number">2002-09-23</span>  -<span class="hljs-number">9.558560</span>  -<span class="hljs-number">8.781216</span> -<span class="hljs-number">4.499815</span>  <span class="hljs-number">30.518439</span><br><span class="hljs-number">2002-09-24</span>  -<span class="hljs-number">9.902058</span>  -<span class="hljs-number">9.340490</span> -<span class="hljs-number">4.386639</span>  <span class="hljs-number">30.105593</span><br><span class="hljs-number">2002-09-25</span> -<span class="hljs-number">10.216020</span>  -<span class="hljs-number">9.480682</span> -<span class="hljs-number">3.933802</span>  <span class="hljs-number">29.758560</span><br><span class="hljs-number">2002-09-26</span> -<span class="hljs-number">11.856774</span> -<span class="hljs-number">10.671012</span> -<span class="hljs-number">3.216025</span>  <span class="hljs-number">29.369368</span><br><br>[<span class="hljs-number">1000</span> rows x <span class="hljs-number">4</span> columns]<br></code></pre></td></tr></table></figure><h2 id="十三-gotchas"><a class="markdownIt-Anchor" href="#十三-gotchas"></a> 十三、Gotchas</h2><p>如果你正在运行，你会看到这样一个异常：</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs smali">&gt;&gt;&gt;<span class="hljs-built_in"> if </span>pd.Series([False, True, False]):<br>    print(<span class="hljs-string">&quot;I was true&quot;</span>)<br>Traceback<br><span class="hljs-keyword">    .</span>..<br>ValueError: The truth value of an<span class="hljs-built_in"> array </span>is ambiguous. Use a.empty, a.any()<span class="hljs-built_in"> or </span>a.all().<br></code></pre></td></tr></table></figure></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" class="category-chain-item">编程语言</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/Python/" class="print-no-link">#Python</a></div></div><div class="license-box my-3"><div class="license-title"><div>10 Minutes to pandas----十分钟搞定Pandas</div><div>https://fulequn.github.io/2020/08/Article202008221/</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>Fulequn</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2020年8月22日</div></div><div class="license-meta-item"><div>许可协议</div><div><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/2020/08/Article202008222/" title="PyPDF2 用 Python 操作 PDF"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">PyPDF2 用 Python 操作 PDF</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/2020/08/Article202008204/" title="用JAVA的ObjectOutputStream和ObjectInputStream完成对象的深克隆"><span class="hidden-mobile">用JAVA的ObjectOutputStream和ObjectInputStream完成对象的深克隆</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>目录</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t,e){var i=Fluid.plugins.typing,n=e.getElementById("subtitle");n&&i&&i(n.getAttribute("data-typed-text"))}(window,document)</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js",(function(){var t=jQuery("#toc");if(0!==t.length&&window.tocbot){var i=jQuery("#board-ctn").offset().top;window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-i},CONFIG.toc)),t.find(".toc-list-item").length>0&&t.css("visibility","visible"),Fluid.events.registerRefreshCallback((function(){if("tocbot"in window){tocbot.refresh();var t=jQuery("#toc");if(0===t.length||!tocbot)return;t.find(".toc-list-item").length>0&&t.css("visibility","visible")}}))}}))</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",(function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback((function(){if("anchors"in window){anchors.removeAll();var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}}))}))</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",(function(){Fluid.plugins.fancyBox()}))</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>