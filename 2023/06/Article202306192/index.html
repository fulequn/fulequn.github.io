<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png"><link rel="icon" href="/img/favicon.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="Fulequn"><meta name="keywords" content=""><meta name="description" content="物流和供应链管理是当前管理研究的热点和前沿领域。供应链是一个由物流系统和该供应链中的所有单个组织或企业相关活动组成的网络。为满足供应链中顾客需求，需要对商品服务及相关信息，从产地到消费地高效率低成本地流动及储存进行规划、执行和控制。运筹学中对运输模型的研究为达到上述目的提供相应的理论基础。  1 运输问题的数学模型 在经济建设中，经常碰到大宗物资调运问题。如煤、钢铁、木材、粮食等物资，在全国有若干"><meta property="og:type" content="article"><meta property="og:title" content="使用伏格尔法解决运输问题"><meta property="og:url" content="https://fulequn.github.io/2023/06/Article202306192/index.html"><meta property="og:site_name" content="FuLeQun&#39;s Blog"><meta property="og:description" content="物流和供应链管理是当前管理研究的热点和前沿领域。供应链是一个由物流系统和该供应链中的所有单个组织或企业相关活动组成的网络。为满足供应链中顾客需求，需要对商品服务及相关信息，从产地到消费地高效率低成本地流动及储存进行规划、执行和控制。运筹学中对运输模型的研究为达到上述目的提供相应的理论基础。  1 运输问题的数学模型 在经济建设中，经常碰到大宗物资调运问题。如煤、钢铁、木材、粮食等物资，在全国有若干"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201509092.png"><meta property="og:image" content="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201610931.png"><meta property="og:image" content="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201610932.png"><meta property="og:image" content="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201610933.png"><meta property="og:image" content="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201610934.png"><meta property="og:image" content="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201610935.png"><meta property="og:image" content="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201536531.png"><meta property="og:image" content="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201536363.png"><meta property="og:image" content="https://raw.githubusercontent.com/fulequn/oss_img/master/202306201618711.jpeg"><meta property="og:image" content="https://raw.githubusercontent.com/fulequn/oss_img/master/202306201618198.jpeg"><meta property="og:image" content="https://raw.githubusercontent.com/fulequn/oss_img/master/202306201618010.jpeg"><meta property="og:image" content="https://raw.githubusercontent.com/fulequn/oss_img/master/202306201618247.jpeg"><meta property="og:image" content="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201607995.png"><meta property="og:image" content="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201607739.png"><meta property="og:image" content="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201608691.png"><meta property="article:published_time" content="2023-06-19T14:50:09.000Z"><meta property="article:modified_time" content="2024-05-18T14:35:07.889Z"><meta property="article:author" content="Fulequn"><meta property="article:tag" content="Python"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201509092.png"><title>使用伏格尔法解决运输问题 - FuLeQun&#39;s Blog</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var CONFIG={hostname:"fulequn.github.io",root:"/",version:"1.9.7",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!1,follow_dnt:!0,baidu:null,google:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1},gtag:null,tajs:null},search_path:"/local-search.xml",include_content_in_search:!0};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css"><meta name="generator" content="Hexo 7.2.0"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>FuLeQun&#39;s Blog</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/" target="_self"><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/" target="_self"><i class="iconfont icon-archive-fill"></i> <span>归档</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/" target="_self"><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/" target="_self"><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class="nav-item"><a class="nav-link" href="/about/" target="_self"><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/default.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="使用伏格尔法解决运输问题"></span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2023-06-19 22:50" pubdate>2023年6月19日 晚上</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i>6.8k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i>57 分钟</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 id="seo-header">使用伏格尔法解决运输问题</h1><div class="markdown-body"><p>物流和供应链管理是当前管理研究的热点和前沿领域。供应链是一个由物流系统和该供应链中的所有单个组织或企业相关活动组成的网络。为满足供应链中顾客需求，需要对商品服务及相关信息，从产地到消费地高效率低成本地流动及储存进行规划、执行和控制。运筹学中对运输模型的研究为达到上述目的提供相应的理论基础。</p><h1 id="1-运输问题的数学模型"><a class="markdownIt-Anchor" href="#1-运输问题的数学模型"></a> 1 运输问题的数学模型</h1><p>在经济建设中，经常碰到大宗物资调运问题。如煤、钢铁、木材、粮食等物资，在全国有若干生产基地，根据已有的交通网，应如何制订调运方案，将这些物资运到各消费地点，而总运费要最小。这问题可用以下数学语言描述。</p><p>已知有m个生产地点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">A_i,i=1,2,\cdots ,m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8777699999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8388800000000001em;vertical-align:-.19444em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">m</span></span></span></span>。可供应某种物资，其供应量（产量）分别为<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">a_i,i=1,2,\cdots ,m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.85396em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8388800000000001em;vertical-align:-.19444em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">m</span></span></span></span>,有n个销地<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>j</mi></msub><mo separator="true">,</mo><mi>j</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">B_j, j=1,2,\cdots , n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8388800000000001em;vertical-align:-.19444em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">n</span></span></span></span>,其需要量分别为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>j</mi></msub><mo separator="true">,</mo><mi>j</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">b_j,j=1,2,\cdots ,n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8388800000000001em;vertical-align:-.19444em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">n</span></span></span></span>，从<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">A_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">B_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span>，运输单位物资的运价（单价）为c，这些数据可汇总于产销平衡表和单位运价表中，见<br>表4-1，表4-2。有时可把这两表合二为一。</p><p><img src="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201509092.png" srcset="/img/loading.gif" lazyload alt="QQ截图20230620150836"></p><p>若用<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span>表示从<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">A_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">B_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span>的运量，那么在产销平衡的条件下，要求得总运费最小的调运方案，可求解以下数学模型</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right" columnspacing><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>min</mi><mo>⁡</mo><mi>z</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>c</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">{</mo><mtable rowspacing="0.15999999999999992em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>b</mi><mi>j</mi></msub><mo separator="true">,</mo><mspace width="1em"><mi>j</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><mi>n</mi></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>a</mi><mi>i</mi></msub><mo separator="true">,</mo><mspace width="1em"><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><mi>m</mi></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>⩾</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} \min z=\sum_{i=1}^{m} \sum_{j=1}^{n} c_{i j} x_{i j} \\ \left\{\begin{array}{l} \sum_{i=1}^{m} x_{i j}=b_{j}, \quad j=1,2, \cdots, n \\ \sum_{j=1}^{n} x_{i j}=a_{i}, \quad i=1,2, \cdots, m \\ x_{i j} \geqslant 0 \end{array}\right. \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.340992000000001em;vertical-align:-3.4204960000000004em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.9204960000000004em"><span style="top:-6.357008em"><span class="pstrut" style="height:4.087909em"></span><span class="mord"><span class="mop">min</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.04398em">z</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em"><span style="top:-1.872331em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em"><span style="top:-1.872331em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-2.5553220000000003em"><span class="pstrut" style="height:4.087909em"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em"><span style="top:-2.49999em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.20499em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-3.15001em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.00501em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.30002em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.087909em"><span style="top:-4.247909em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.804292em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29971000000000003em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">n</span></span></span><span style="top:-3.0479089999999998em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.804292em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.43581800000000004em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">m</span></span></span><span style="top:-1.7720909999999994em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel amsrm">⩾</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5879090000000007em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.4204960000000004em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>这就是运输问题的数学模型。它包含m*n个变量，(m+n)个约束方程。其系数矩阵的结构比较松散，且特殊。</p><p><img src="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201610931.png" srcset="/img/loading.gif" lazyload alt="QQ截图20230620150836"></p><p>该系数矩阵中对应于变量x的系数向量P,其分量中除第i个和第m+j个为1以外，其余的都为零。即</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>P</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mo stretchy="false">(</mo><mn>0</mn><mo>⋯</mo><mn>1</mn><mo>⋯</mo><mn>0</mn><mo>⋯</mo><mn>1</mn><mo>⋯</mo><mn>0</mn><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>=</mo><msub><mi>e</mi><mi>i</mi></msub><mo>+</mo><msub><mi>e</mi><mrow><mi>m</mi><mo>+</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{ij} = (0 \cdots 1 \cdots 0 \cdots 1 \cdots 0)^T = e_i + e_{m+j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">0</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">0</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">0</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913309999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.73333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></span></p><p>对产销平衡的运输问题，由于有以下关系式存在</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>b</mi><mi>j</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo fence="true">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo fence="true">)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mrow><mo fence="true">(</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo fence="true">)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\sum_{j=1}^{n} b_{j}=\sum_{j=1}^{n}\left(\sum_{i=1}^{m} x_{i j}\right)=\sum_{i=1}^{m}\left(\sum_{j=1}^{n} x_{i j}\right)=\sum_{i=1}^{m} a_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em"><span style="top:-1.872331em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.1637769999999996em;vertical-align:-1.4137769999999998em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em"><span style="top:-1.872331em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em"><span style="top:-1.872331em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size4">)</span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.1637769999999996em;vertical-align:-1.4137769999999998em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em"><span style="top:-1.872331em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em"><span style="top:-1.872331em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size4">)</span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em"><span style="top:-1.872331em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p>所以模型最多只有m十n一1个独立约束方程。即系数矩阵的秩≤m十n一1。由于有以<br>上特征，所以求解运输问题时，可用比较简便的计算方法，习惯上称为表上作业法。</p><p>对产销平衡的运输问题，一定存在可行解。又因为所有变量有界，因而存在最优解。</p><h1 id="2-表上作业法"><a class="markdownIt-Anchor" href="#2-表上作业法"></a> 2 表上作业法</h1><p>表上作业法是单纯形法在求解运输问题时的一种简化方法，其实质是单纯形法，故也<br>称运输问题单纯形法。但具体计算和术语有所不同。可归纳为：</p><p>(1)找出初始基可行解。即在有(m*n)格的产销平衡表上按一定的规则，给出m+n-1个数字，称为数字格。它们就是初始基变量的取值。</p><p>(2)求各非基变量的检验数，即在表上计算空格的检验数，判别是否达到最优解。如已是最优解，则停止计算，否则转到下一步。</p><p>(3)确定换入变量和换出变量，找出新的基可行解。在表上用闭回路法调整。</p><p>(4)重复(2),(3)直到得到最优解为止。</p><p>以上运算都可以在表上完成。</p><h2 id="21-确定初始基可行解"><a class="markdownIt-Anchor" href="#21-确定初始基可行解"></a> 2.1 确定初始基可行解</h2><p>这与一般线性规划问题不同。产销平衡的运输问题总是存在可行解。因有</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>b</mi><mi>j</mi></msub><mo>=</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">\sum_{i=1}^m a_i = \sum_{j=1}^n b_j = d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em"><span style="top:-1.872331em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em"><span style="top:-1.872331em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal">d</span></span></span></span></span></p><p>必存在</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>≥</mo><mn>0</mn><mo separator="true">,</mo><mspace width="1em"><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><mi>m</mi><mo separator="true">,</mo><mspace width="1em"><mi>j</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>n</mi></mspace></mspace></mrow><annotation encoding="application/x-tex">x_{ij}≥0, \quad i=1,\cdots,m, \quad j=1,…,n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.922078em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.85396em;vertical-align:-.19444em"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.85396em;vertical-align:-.19444em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8388800000000001em;vertical-align:-.19444em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner">…</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">n</span></span></span></span></span></p><p>这就是基可行解。又因</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>0</mn><mo>≤</mo><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>≤</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mi>j</mi></msub><mo separator="true">,</mo><msub><mi>b</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">0 \le x_{ij} \le min(a_j, b_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.78041em;vertical-align:-.13597em"></span><span class="mord">0</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.922078em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>故运输问题必定存在最优解。</p><h3 id="211-最小元素法"><a class="markdownIt-Anchor" href="#211-最小元素法"></a> 2.1.1 最小元素法</h3><p>这方法的基本思想是就近供应，即从单位运价表中最小的运价开始确定供销关系，然后次小。一直到给出初始基可行解为止。</p><h3 id="212-伏格尔法"><a class="markdownIt-Anchor" href="#212-伏格尔法"></a> 2.1.2 伏格尔法</h3><p>最小元素法的缺点是：可能开始时节省一处的费用，但随后在其他处要多花几倍的运费。伏格尔法考虑到，一产地的产品假如不能按最小运费就近供应，就考虑次小运费，这就有一个差额（也称罚数）。差额越大，说明不能按最小运费调运时，运费增加越多。因而对差额最大处，就应当采用最小运费调运。基于此，伏格尔法的步骤是：</p><p>① 首先计算运输表中每一行和每一列的次小单位运价和最小单位运价之间的差值，分别称为行罚数和列罚数。</p><p>② 选取这些罚数中最大者（若存在最大罚数相同的情况，则任选其中一个）所在的行或列的最小单位运价所在的格子，在格子中给其分配尽可能大的运量，划去该行 / 该列。</p><p>③ 在尚未划去的各行或各列中，重复以上步骤，直到最后一个格子也被分配上运量，得到所求运输问题的初始基可行解。</p><p><strong>案例</strong></p><p>某部门有 3 个生产同类型的工厂（产地），生产的产品有 4 个销售点（销地）出售，各工厂的生产量（单位：吨）、各销售点的销售量（单位吨）以及各工厂到各销售点单位运价（百元：吨）如下表所示：</p><p><img src="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201610932.png" srcset="/img/loading.gif" lazyload alt="题目.png"></p><p>适当安排调运方案，最小总运费为（）</p><p>A . 450</p><p>B . 455</p><p>C . 460</p><p>D . 465</p><p><strong>解题过程</strong></p><ol><li>找出各行各列最小元素和次小元素的差额，最大差值为 B2 列，该列销售量 28 赋予最小元素 5</li></ol><p><img src="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201610933.png" srcset="/img/loading.gif" lazyload alt="0.png"></p><p>第一次计算运费为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn><mo>∗</mo><mn>28</mn></mrow><annotation encoding="application/x-tex">5*28</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">5</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span><span class="mord">8</span></span></span></span></p><ol><li><p>重新计算各行各列最小元素和次小元素的差额，最大差值为 B4 列，该列销量 24，由于受产量限制，将 A3 产量 16 赋予最小元素 6</p><p><img src="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201610934.png" srcset="/img/loading.gif" lazyload alt="1.png"></p></li></ol><p>第二次计算的运费为：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn><mo>∗</mo><mn>28</mn><mo>+</mo><mn>16</mn><mo>∗</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">5*28+16*6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">5</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">2</span><span class="mord">8</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">6</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">6</span></span></span></span></p><ol><li>重新计算各行各列最小元素和次小元素的差额。最大差值 B1 列。将销量 16 赋予最小元素 2</li></ol><p><img src="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201610935.png" srcset="/img/loading.gif" lazyload alt="2.png"></p><p>第三次计算：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn><mo>∗</mo><mn>28</mn><mo>+</mo><mn>16</mn><mo>∗</mo><mn>6</mn><mo>+</mo><mn>2</mn><mo>∗</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">5*28+16*6+2*16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">5</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">2</span><span class="mord">8</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">6</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">6</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">6</span></span></span></span></p><ol><li><p>重新计算各行各列最小元素和次小元素的差额，最大差值 A1 行，赋予销量 28 给元素 4</p><p><img src="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201536531.png" srcset="/img/loading.gif" lazyload alt="3.png"></p></li></ol><p>第四次计算：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn><mo>∗</mo><mn>28</mn><mo>+</mo><mn>16</mn><mo>∗</mo><mn>6</mn><mo>+</mo><mn>2</mn><mo>∗</mo><mn>16</mn><mo>+</mo><mn>28</mn><mo>∗</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">5*28+16*6+2*16+28*4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">5</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">2</span><span class="mord">8</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">6</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">6</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mord">6</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span><span class="mord">8</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">4</span></span></span></span></p><ol><li><p>重新计算各行各列最小元素和次小元素的差额，将最后剩下的销量 8 吨中，4 吨分给元素 9，4 吨分元素 11</p><p><img src="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201536363.png" srcset="/img/loading.gif" lazyload alt="4.png"></p></li></ol><p>最终总运费为=<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn><mo>∗</mo><mn>28</mn><mo>+</mo><mn>16</mn><mo>∗</mo><mn>6</mn><mo>+</mo><mn>2</mn><mo>∗</mo><mn>16</mn><mo>+</mo><mn>28</mn><mo>∗</mo><mn>4</mn><mo>+</mo><mn>11</mn><mo>∗</mo><mn>4</mn><mo>+</mo><mn>9</mn><mo>∗</mo><mn>4</mn><mo>=</mo><mn>460</mn></mrow><annotation encoding="application/x-tex">5*28+16*6+2*16+28*4+11*4+9*4=460</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">5</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">2</span><span class="mord">8</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">6</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">6</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mord">6</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span><span class="mord">8</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">4</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">4</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">9</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">4</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">4</span><span class="mord">6</span><span class="mord">0</span></span></span></span></p><h2 id="22-最优解的判别"><a class="markdownIt-Anchor" href="#22-最优解的判别"></a> 2.2 最优解的判别</h2><h3 id="221-闭回路法"><a class="markdownIt-Anchor" href="#221-闭回路法"></a> 2.2.1 闭回路法</h3><h3 id="222-位势法"><a class="markdownIt-Anchor" href="#222-位势法"></a> 2.2.2 位势法</h3><p>在得到运输问题的初始基可行解后，应对该解做最优性判别。位势法就是用来判断解的最优性的一种方法，其实质是在求解单纯形表中非基变量的检验数。该方法适用于产地和销地较少的运输问题。</p><p>★求解步骤</p><p>① 在所求得的初始基可行解的表中增加位势列和位势行；</p><p>② 由于基变量的检验数等于 0，对这组基变量可以构建位势方程组：</p><p><img src="https://raw.githubusercontent.com/fulequn/oss_img/master/202306201618711.jpeg" srcset="/img/loading.gif" lazyload alt></p><p><img src="https://raw.githubusercontent.com/fulequn/oss_img/master/202306201618198.jpeg" srcset="/img/loading.gif" lazyload alt></p><p><img src="https://raw.githubusercontent.com/fulequn/oss_img/master/202306201618010.jpeg" srcset="/img/loading.gif" lazyload alt></p><p><img src="https://raw.githubusercontent.com/fulequn/oss_img/master/202306201618247.jpeg" srcset="/img/loading.gif" lazyload alt></p><h2 id="23-代码实现"><a class="markdownIt-Anchor" href="#23-代码实现"></a> 2.3 代码实现</h2><h3 id="231-伏格尔法"><a class="markdownIt-Anchor" href="#231-伏格尔法"></a> 2.3.1 伏格尔法</h3><p>使用下面的 EXCEL 文件作为运输表（最后一行表示销量，最后一列表示产量），文件名为 TP_PPT_Sample1.xlsx：</p><p><img src="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201607995.png" srcset="/img/loading.gif" lazyload alt="data.png"></p><p><img src="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201607739.png" srcset="/img/loading.gif" lazyload alt="a90d8988-5fc9-4a30-a3b3-87f1b8404142"></p><p>然后在 Python 中执行以下代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> copy<br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><br><br><span class="hljs-comment"># 运输问题求解：使用Vogel逼近法寻找初始基本可行解</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">TP_split_matrix</span>(<span class="hljs-params">mat</span>):<br>    <span class="hljs-comment"># 将运输表拆分为成本矩阵c、供给向量a、需求向量b</span><br>    c = mat[:-<span class="hljs-number">1</span>, :-<span class="hljs-number">1</span>]<br>    a = mat[:-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>]<br>    b = mat[-<span class="hljs-number">1</span>, :-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">return</span> (c, a, b)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">TP_vogel</span>(<span class="hljs-params">var</span>):<br>    <span class="hljs-comment"># Vogel法代码，变量var可以是以numpy.ndarray保存的运输表，或以tuple或list保存的(成本矩阵,供给向量,需求向量)</span><br>    <span class="hljs-keyword">import</span> numpy<br><br>    <span class="hljs-comment"># 检查var的类型</span><br>    typevar1 = <span class="hljs-built_in">type</span>(var) == numpy.ndarray<br>    typevar2 = <span class="hljs-built_in">type</span>(var) == <span class="hljs-built_in">tuple</span><br>    typevar3 = <span class="hljs-built_in">type</span>(var) == <span class="hljs-built_in">list</span><br><br>    <span class="hljs-comment"># 格式化输入</span><br>    <span class="hljs-keyword">if</span> typevar1 == <span class="hljs-literal">False</span> <span class="hljs-keyword">and</span> typevar2 == <span class="hljs-literal">False</span> <span class="hljs-keyword">and</span> typevar3 == <span class="hljs-literal">False</span>:<br>        <span class="hljs-comment"># 如果var的类型不符合要求，则输出错误信息并返回None</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&gt;&gt;&gt;非法变量&lt;&lt;&lt;&#x27;</span>)<br>        (cost, x) = (<span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">if</span> typevar1 == <span class="hljs-literal">True</span>:<br>            <span class="hljs-comment"># 如果var是ndarray类型，则将其拆分为成本矩阵c、供给向量a、需求向量b</span><br>            [c, a, b] = TP_split_matrix(var)<br>        <span class="hljs-keyword">elif</span> typevar2 == <span class="hljs-literal">True</span> <span class="hljs-keyword">or</span> typevar3 == <span class="hljs-literal">True</span>:<br>            <span class="hljs-comment"># 如果var是tuple或list类型，则直接取出成本矩阵c、供给向量a、需求向量b</span><br>            [c, a, b] = var<br><br>        <span class="hljs-comment"># 深拷贝成本矩阵c，用于记录原始成本矩阵</span><br>        cost = copy.deepcopy(c)<br><br>        <span class="hljs-comment"># 初始化运输方案矩阵x，全为0</span><br>        x = np.zeros(c.shape)<br><br>        <span class="hljs-comment"># 设置一个大的数M，用于表示无穷大</span><br>        M = <span class="hljs-built_in">pow</span>(<span class="hljs-number">10</span>, <span class="hljs-number">9</span>)<br><br>        <span class="hljs-comment"># 迭代处理成本矩阵c中的每个元素</span><br>        <span class="hljs-keyword">for</span> factor <span class="hljs-keyword">in</span> c.reshape(<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>)[<span class="hljs-number">0</span>]:<br>            <span class="hljs-comment"># 直到所有元素都达到最大值M，或者成本矩阵中所有元素都相等且等于最大值M。</span><br>            <span class="hljs-keyword">while</span> <span class="hljs-built_in">int</span>(factor) != M:<br>                <span class="hljs-keyword">if</span> np.<span class="hljs-built_in">all</span>(c == M):<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-comment"># 在每次迭代时，将打印当前的成本矩阵c，以便观察迭代过程。</span><br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c:\n&#x27;</span>, c)<br><br>                    <span class="hljs-comment"># 获取行/列最小值数组</span><br>                    row_mini1 = []<br>                    row_mini2 = []<br>                    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(c.shape[<span class="hljs-number">0</span>]):<br>                        Row = <span class="hljs-built_in">list</span>(c[row, :])<br>                        row_min = <span class="hljs-built_in">min</span>(Row)  <span class="hljs-comment"># 最小值</span><br>                        row_mini1.append(row_min)<br>                        Row.remove(row_min)<br>                        row_2nd_min = <span class="hljs-built_in">min</span>(Row)  <span class="hljs-comment"># 次小值</span><br>                        row_mini2.append(row_2nd_min)<br>                    <span class="hljs-comment"># 求解罚数</span><br>                    r_pun = [row_mini2[i] - row_mini1[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(row_mini1))]<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;行罚数：&#x27;</span>, r_pun)<br><br>                    <span class="hljs-comment"># 计算列罚数</span><br>                    col_mini1 = []<br>                    col_mini2 = []<br>                    <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(c.shape[<span class="hljs-number">1</span>]):<br>                        Col = <span class="hljs-built_in">list</span>(c[:, col])<br>                        col_min = <span class="hljs-built_in">min</span>(Col)<br>                        col_mini1.append(col_min)<br>                        Col.remove(col_min)<br>                        col_2nd_min = <span class="hljs-built_in">min</span>(Col)<br>                        col_mini2.append(col_2nd_min)<br>                    c_pun = [col_mini2[i] - col_mini1[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(col_mini1))]<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;列罚数：&#x27;</span>, c_pun)<br><br>                    <span class="hljs-comment"># 将行罚数和列罚数合并为罚数向量</span><br>                    pun = copy.deepcopy(r_pun)<br>                    pun.extend(c_pun)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;罚数向量：&#x27;</span>, pun)<br><br>                    <span class="hljs-comment"># 找到最大罚数及其索引</span><br>                    max_pun = <span class="hljs-built_in">max</span>(pun)<br>                    max_pun_index = pun.index(<span class="hljs-built_in">max</span>(pun))<br>                    max_pun_num = max_pun_index + <span class="hljs-number">1</span><br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;最大罚数：&#x27;</span>, max_pun, <span class="hljs-string">&#x27;元素序号：&#x27;</span>, max_pun_num)<br><br>                    <span class="hljs-comment"># 前面是行，后面是列。这里是判断最大罚数的位置</span><br>                    <span class="hljs-keyword">if</span> max_pun_num &lt;= <span class="hljs-built_in">len</span>(r_pun):<br>                        <span class="hljs-comment"># 对行进行操作</span><br>                        row_num = max_pun_num<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;对第&#x27;</span>, row_num, <span class="hljs-string">&#x27;行进行操作：&#x27;</span>)<br>                        row_index = row_num - <span class="hljs-number">1</span><br>                        catch_row = c[row_index, :]<br>                        <span class="hljs-built_in">print</span>(catch_row)<br>                        min_cost_colindex = <span class="hljs-built_in">int</span>(np.argwhere(catch_row == <span class="hljs-built_in">min</span>(catch_row)))<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;最小成本所在列索引：&#x27;</span>, min_cost_colindex)<br><br>                        <span class="hljs-keyword">if</span> a[row_index] &lt;= b[min_cost_colindex]:<br>                            x[row_index, min_cost_colindex] = a[row_index]<br>                            c1 = copy.deepcopy(c)<br>                            c1[row_index, :] = [M] * c1.shape[<span class="hljs-number">1</span>]<br>                            b[min_cost_colindex] -= a[row_index]<br>                            a[row_index] -= a[row_index]<br>                        <span class="hljs-keyword">else</span>:<br>                            x[row_index, min_cost_colindex] = b[min_cost_colindex]<br>                            c1 = copy.deepcopy(c)<br>                            c1[:, min_cost_colindex] = [M] * c1.shape[<span class="hljs-number">0</span>]<br>                            a[row_index] -= b[min_cost_colindex]<br>                            b[min_cost_colindex] -= b[min_cost_colindex]<br>                    <span class="hljs-keyword">else</span>:<br>                        <span class="hljs-comment"># 对列进行操作</span><br>                        col_num = max_pun_num - <span class="hljs-built_in">len</span>(r_pun)<br>                        col_index = col_num - <span class="hljs-number">1</span><br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;对第&#x27;</span>, col_num, <span class="hljs-string">&#x27;列进行操作：&#x27;</span>)<br>                        catch_col = c[:, col_index]<br>                        <span class="hljs-built_in">print</span>(catch_col)<br><br>                        <span class="hljs-comment"># 寻找最大罚数所在行/列的最小成本系数</span><br>                        min_cost_rowindex = <span class="hljs-built_in">int</span>(np.argwhere(catch_col == <span class="hljs-built_in">min</span>(catch_col)))<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;最小成本所在行索引：&#x27;</span>, min_cost_rowindex)<br><br>                        <span class="hljs-comment"># 计算将该位置应填入x矩阵的数值（a,b中较小值）</span><br>                        <span class="hljs-keyword">if</span> a[min_cost_rowindex] &lt;= b[col_index]:<br>                            x[min_cost_rowindex, col_index] = a[min_cost_rowindex]<br>                            c1 = copy.deepcopy(c)<br>                            c1[min_cost_rowindex, :] = [M] * c1.shape[<span class="hljs-number">1</span>]<br>                            b[col_index] -= a[min_cost_rowindex]<br>                            a[min_cost_rowindex] -= a[min_cost_rowindex]<br>                        <span class="hljs-keyword">else</span>:<br>                            x[min_cost_rowindex, col_index] = b[col_index]<br>                            <span class="hljs-comment"># 填入后删除已满足/耗尽资源系数的行/列，得到剩余的成本矩阵，并改写资源系数</span><br>                            c1 = copy.deepcopy(c)<br>                            c1[:, col_index] = [M] * c1.shape[<span class="hljs-number">0</span>]<br>                            a[min_cost_rowindex] -= b[col_index]<br>                            b[col_index] -= b[col_index]<br><br>                    c = c1<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;本次迭代后的x矩阵：\n&#x27;</span>, x)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;a:&#x27;</span>, a)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;b:&#x27;</span>, b)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c:\n&#x27;</span>, c)<br><br>                <span class="hljs-keyword">if</span> np.<span class="hljs-built_in">all</span>(c == M):<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;【迭代完成】&#x27;</span>)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;-&#x27;</span> * <span class="hljs-number">60</span>)<br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;【迭代未完成】&#x27;</span>)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;-&#x27;</span> * <span class="hljs-number">60</span>)<br><br>        <span class="hljs-comment"># 计算总成本</span><br>        total_cost = np.<span class="hljs-built_in">sum</span>(np.multiply(x, cost))<br><br>        <span class="hljs-comment"># 判断运输问题类别</span><br>        <span class="hljs-keyword">if</span> np.<span class="hljs-built_in">all</span>(a == <span class="hljs-number">0</span>):<br>            <span class="hljs-keyword">if</span> np.<span class="hljs-built_in">all</span>(b == <span class="hljs-number">0</span>):<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&gt;&gt;&gt;供求平衡&lt;&lt;&lt;&#x27;</span>)<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&gt;&gt;&gt;供不应求，需求方有余量&lt;&lt;&lt;&#x27;</span>)<br>        <span class="hljs-keyword">elif</span> np.<span class="hljs-built_in">all</span>(b == <span class="hljs-number">0</span>):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&gt;&gt;&gt;供大于求，供给方有余量&lt;&lt;&lt;&#x27;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&gt;&gt;&gt;无法找到初始基可行解&lt;&lt;&lt;&#x27;</span>)<br><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&gt;&gt;&gt;初始基本可行解x*：\n&#x27;</span>, x)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&gt;&gt;&gt;当前总成本：&#x27;</span>, total_cost)<br><br>        [m, n] = x.shape<br>        varnum = np.array(np.nonzero(x)).shape[<span class="hljs-number">1</span>]<br><br>        <span class="hljs-comment"># 根据秩来判断是否有退化解</span><br>        <span class="hljs-keyword">if</span> varnum != m + n - <span class="hljs-number">1</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;【注意：问题含有退化解】&#x27;</span>)<br><br>    <span class="hljs-keyword">return</span> (cost, x)<br><br><br>path = <span class="hljs-string">r&#x27;TP_PPT_Sample1.xlsx&#x27;</span><br>mat = pd.read_excel(path, header=<span class="hljs-literal">None</span>).values<br><span class="hljs-comment"># c=np.array([[3,11,3,10],[1,9,2,8],[7,4,10,5]])</span><br><span class="hljs-comment"># a=np.array([7,4,9])</span><br><span class="hljs-comment"># b=np.array([3,6,5,6])</span><br>[c, x] = TP_vogel(mat)<br><span class="hljs-comment"># [c,x]=TP_vogel([c,a,b])</span><br></code></pre></td></tr></table></figure><p>运行代码结果</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><code class="hljs subunit">c:<br> [[ 3. 11.  3. 10.]<br> [ 1.  9.  2.  8.]<br> [ 7.  4. 10.  5.]]<br>行罚数： [0.0, 1.0, 1.0]<br>列罚数： [2.0, 5.0, 1.0, 3.0]<br>罚数向量： [0.0, 1.0, 1.0, 2.0, 5.0, 1.0, 3.0]<br>最大罚数： 5.0 元素序号： 5<br>对第 2 列进行操作：<br>[11.  9.  4.]<br>最小成本所在行索引： 2<br>本次迭代后的x矩阵：<br> [[0. 0. 0. 0.]<br> [0. 0. 0. 0.]<br> [0. 6. 0. 0.]]<br>a: [7. 4. 3.]<br>b: [3. 0. 5. 6.]<br>c:<br> [[3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+09</span> 3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+01</span>]<br> [1.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+09</span> 2.e<span class="hljs-string">+00</span> 8.e<span class="hljs-string">+00</span>]<br> [7.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+01</span> 5.e<span class="hljs-string">+00</span>]]<br>【迭代未完成】<br>------------------------------------------------------------<br>c:<br> [[3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+09</span> 3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+01</span>]<br> [1.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+09</span> 2.e<span class="hljs-string">+00</span> 8.e<span class="hljs-string">+00</span>]<br> [7.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+01</span> 5.e<span class="hljs-string">+00</span>]]<br>行罚数： [0.0, 1.0, 2.0]<br>列罚数： [2.0, 0.0, 1.0, 3.0]<br>罚数向量： [0.0, 1.0, 2.0, 2.0, 0.0, 1.0, 3.0]<br>最大罚数： 3.0 元素序号： 7<br>对第 4 列进行操作：<br>[10.  8.  5.]<br>最小成本所在行索引： 2<br>本次迭代后的x矩阵：<br> [[0. 0. 0. 0.]<br> [0. 0. 0. 0.]<br> [0. 6. 0. 3.]]<br>a: [7. 4. 0.]<br>b: [3. 0. 5. 3.]<br>c:<br> [[3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+09</span> 3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+01</span>]<br> [1.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+09</span> 2.e<span class="hljs-string">+00</span> 8.e<span class="hljs-string">+00</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]]<br>【迭代未完成】<br>------------------------------------------------------------<br>c:<br> [[3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+09</span> 3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+01</span>]<br> [1.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+09</span> 2.e<span class="hljs-string">+00</span> 8.e<span class="hljs-string">+00</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]]<br>行罚数： [0.0, 1.0, 0.0]<br>列罚数： [2.0, 0.0, 1.0, 2.0]<br>罚数向量： [0.0, 1.0, 0.0, 2.0, 0.0, 1.0, 2.0]<br>最大罚数： 2.0 元素序号： 4<br>对第 1 列进行操作：<br>[3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+09</span>]<br>最小成本所在行索引： 1<br>本次迭代后的x矩阵：<br> [[0. 0. 0. 0.]<br> [3. 0. 0. 0.]<br> [0. 6. 0. 3.]]<br>a: [7. 1. 0.]<br>b: [0. 0. 5. 3.]<br>c:<br> [[1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+01</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 2.e<span class="hljs-string">+00</span> 8.e<span class="hljs-string">+00</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]]<br>【迭代未完成】<br>------------------------------------------------------------<br>c:<br> [[1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+01</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 2.e<span class="hljs-string">+00</span> 8.e<span class="hljs-string">+00</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]]<br>行罚数： [7.0, 6.0, 0.0]<br>列罚数： [0.0, 0.0, 1.0, 2.0]<br>罚数向量： [7.0, 6.0, 0.0, 0.0, 0.0, 1.0, 2.0]<br>最大罚数： 7.0 元素序号： 1<br>对第 1 行进行操作：<br>[1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+01</span>]<br>最小成本所在列索引： 2<br>本次迭代后的x矩阵：<br> [[0. 0. 5. 0.]<br> [3. 0. 0. 0.]<br> [0. 6. 0. 3.]]<br>a: [2. 1. 0.]<br>b: [0. 0. 0. 3.]<br>c:<br> [[1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+01</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 8.e<span class="hljs-string">+00</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]]<br>【迭代未完成】<br>------------------------------------------------------------<br>c:<br> [[1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+01</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 8.e<span class="hljs-string">+00</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]]<br>行罚数： [999999990.0, 999999992.0, 0.0]<br>列罚数： [0.0, 0.0, 0.0, 2.0]<br>罚数向量： [999999990.0, 999999992.0, 0.0, 0.0, 0.0, 0.0, 2.0]<br>最大罚数： 999999992.0 元素序号： 2<br>对第 2 行进行操作：<br>[1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 8.e<span class="hljs-string">+00</span>]<br>最小成本所在列索引： 3<br>本次迭代后的x矩阵：<br> [[0. 0. 5. 0.]<br> [3. 0. 0. 1.]<br> [0. 6. 0. 3.]]<br>a: [2. 0. 0.]<br>b: [0. 0. 0. 2.]<br>c:<br> [[1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+01</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]]<br>【迭代未完成】<br>------------------------------------------------------------<br>c:<br> [[1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+01</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]]<br>行罚数： [999999990.0, 0.0, 0.0]<br>列罚数： [0.0, 0.0, 0.0, 999999990.0]<br>罚数向量： [999999990.0, 0.0, 0.0, 0.0, 0.0, 0.0, 999999990.0]<br>最大罚数： 999999990.0 元素序号： 1<br>对第 1 行进行操作：<br>[1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+01</span>]<br>最小成本所在列索引： 3<br>本次迭代后的x矩阵：<br> [[0. 0. 5. 2.]<br> [3. 0. 0. 1.]<br> [0. 6. 0. 3.]]<br>a: [0. 0. 0.]<br>b: [0. 0. 0. 0.]<br>c:<br> [[1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]]<br>【迭代完成】<br>------------------------------------------------------------<br>&gt;&gt;&gt;供求平衡&lt;&lt;&lt;<br>&gt;&gt;&gt;初始基本可行解x*：<br> [[0. 0. 5. 2.]<br> [3. 0. 0. 1.]<br> [0. 6. 0. 3.]]<br>&gt;&gt;&gt;当前总成本： 85.0<br></code></pre></td></tr></table></figure><p>下面举一个退化解的例子：</p><p>退化解指的是在计算过程中，初始基本可行解中的基变量数量少于m+n-1，其中m和n分别为运输问题的供应源和需求点的数量。换句话说，退化解是一种特殊情况，其中一些供应源和需求点没有在初始基本可行解中使用。</p><p>退化解的出现可能导致后续的迭代过程无法继续进行，因为基变量数量不足以满足问题的要求。这会影响最终解的有效性和准确性。</p><p>在退化解的情况下，通常需要采取特殊的策略来处理，以确保迭代过程的正常进行。这可能包括修改初始基本可行解或应用其他算法来解决问题。</p><p>一运输问题的运输表如下：</p><p><img src="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202306201608691.png" srcset="/img/loading.gif" lazyload alt="data2.png"></p><p>将以上表格保存为 TP_Text_5.9.xlsx，在 Python 中求解。程序运行的最终结果为：</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs inform7">&gt;&gt;&gt;供求平衡&lt;&lt;&lt;<br>&gt;&gt;&gt;初始基本可行解x*：<br> <span class="hljs-comment">[<span class="hljs-comment">[1. 0. 0. 0. 0.]</span></span><br><span class="hljs-comment"> <span class="hljs-comment">[0. 0. 1. 0. 0.]</span></span><br><span class="hljs-comment"> <span class="hljs-comment">[0. 0. 0. 1. 0.]</span></span><br><span class="hljs-comment"> <span class="hljs-comment">[0. 0. 0. 0. 1.]</span></span><br><span class="hljs-comment"> <span class="hljs-comment">[0. 1. 0. 0. 0.]</span>]</span><br>&gt;&gt;&gt;当前总成本： 0.8999999999999999<br>【注意：问题含有退化解】<br></code></pre></td></tr></table></figure><p>最终得到的初始基可行解只含有 5 个非零变量，而 (m+n-1)=9，可见发生了退化。</p><h3 id="232-位势法判断最优解"><a class="markdownIt-Anchor" href="#232-位势法判断最优解"></a> 2.3.2 位势法判断最优解</h3><p>在实现伏格尔法的基础上添加下列函数，以及函数调用<code>sigma=TP_potential(c,x)</code>。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">create_c_nonzeros</span>(<span class="hljs-params">c, x</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    根据运输问题中的需求矩阵x创建一个与成本矩阵c相同形状的新矩阵c_nonzeros，其中非零元素与x相对应位置上的元素相乘，而零元素仍保持为零。</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br>    <span class="hljs-keyword">import</span> copy<br>    nonzeros = copy.deepcopy(x)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(x.shape[<span class="hljs-number">0</span>]):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(x.shape[<span class="hljs-number">1</span>]):<br>            <span class="hljs-keyword">if</span> x[i, j] != <span class="hljs-number">0</span>:<br>                nonzeros[i, j] = <span class="hljs-number">1</span><br>    <span class="hljs-comment"># print(nonzeros)</span><br>    c_nonzeros = np.multiply(c, nonzeros)<br>    <span class="hljs-keyword">return</span> c_nonzeros<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">if_dsquare</span>(<span class="hljs-params">a, b</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    函数if_dsquare用于判断位势方程组是否可解。</span><br><span class="hljs-string">    根据输入的系数矩阵a和值向量b，函数检查矩阵的维度和条件来判断是否可解。</span><br><span class="hljs-string">    如果位势方程组可解，则返回True；如果不可解，则返回False。</span><br><span class="hljs-string">    :param a: 系数矩阵a</span><br><span class="hljs-string">    :param b: 值向量b</span><br><span class="hljs-string">    :return: 位势方程组可解，为True</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;a:&#x27;</span>, a.shape, <span class="hljs-string">&#x27;\n&#x27;</span>, <span class="hljs-string">&#x27;b:&#x27;</span>, b.shape)<br>    correct = <span class="hljs-string">&#x27;&gt;&gt;&gt;位势方程组可解&lt;&lt;&lt;&#x27;</span><br>    error = <span class="hljs-string">&#x27;&gt;&gt;&gt;位势方程组不可解，请检查基变量个数是否等于(m+n-1)及位势未知量个数是否等于(m+n)&lt;&lt;&lt;&#x27;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(a.shape) == <span class="hljs-number">2</span>:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(b.shape) == <span class="hljs-number">2</span>:<br>            <span class="hljs-keyword">if</span> a.shape[<span class="hljs-number">0</span>] == a.shape[<span class="hljs-number">1</span>] <span class="hljs-keyword">and</span> a.shape == b.shape:<br>                <span class="hljs-built_in">print</span>(correct)<br>                if_dsquare = <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(error)<br>                if_dsquare = <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">len</span>(b.shape) == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> b.shape[<span class="hljs-number">0</span>] != <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">if</span> a.shape[<span class="hljs-number">0</span>] == a.shape[<span class="hljs-number">1</span>] <span class="hljs-keyword">and</span> a.shape[<span class="hljs-number">0</span>] == b.shape[<span class="hljs-number">0</span>]:<br>                <span class="hljs-built_in">print</span>(correct)<br>                if_dsquare = <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(error)<br>                if_dsquare = <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(error)<br>            if_dsquare = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">len</span>(a.shape) == <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(b.shape) == <span class="hljs-number">2</span>:<br>            <span class="hljs-keyword">if</span> b.shape[<span class="hljs-number">0</span>] == b.shape[<span class="hljs-number">1</span>] <span class="hljs-keyword">and</span> a.shape[<span class="hljs-number">0</span>] == b.shape[<span class="hljs-number">0</span>]:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&gt;&gt;&gt;位势方程组系数矩阵与方程组值向量位置错误&lt;&lt;&lt;&#x27;</span>)<br>                if_dsquare = <span class="hljs-string">&#x27;True but not solvable&#x27;</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(error)<br>                if_dsquare = <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">len</span>(b.shape) == <span class="hljs-number">1</span>:<br>            <span class="hljs-built_in">print</span>(error)<br>            if_dsquare = <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(error)<br>            if_dsquare = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(error)<br>        if_dsquare = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> if_dsquare<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">TP_potential</span>(<span class="hljs-params">cost, x</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    运输问题的位势法求解函数。首先，它计算变量的数量varnum，如果varnum不等于m + n - 1（基变量的数量），</span><br><span class="hljs-string">    则表示问题存在退化解，将返回None，并输出相应的提示信息。如果varnum满足条件，则继续进行位势法的计算。</span><br><span class="hljs-string">    :param cost: 成本矩阵cost</span><br><span class="hljs-string">    :param x: 需求矩阵x</span><br><span class="hljs-string">    :return:</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    [m, n] = x.shape<br>    varnum = np.array(np.nonzero(x)).shape[<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">if</span> varnum != m + n - <span class="hljs-number">1</span>:<br>        sigma = <span class="hljs-literal">None</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;【问题含有退化解，暂时无法判断最优性】&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-comment"># print(c_nonzeros.shape)</span><br>        c_nonzeros = create_c_nonzeros(c, x)<br>        cc_nonzeros = np.array(np.nonzero(c_nonzeros))<br>        A = []<br>        B = []<br>        length = c_nonzeros.shape[<span class="hljs-number">0</span>] + c_nonzeros.shape[<span class="hljs-number">1</span>]<br>        zeros = np.zeros((<span class="hljs-number">1</span>, length))[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(cc_nonzeros.shape[<span class="hljs-number">1</span>]):<br>            zeros = np.zeros((<span class="hljs-number">1</span>, length))[<span class="hljs-number">0</span>]<br>            zeros[cc_nonzeros[<span class="hljs-number">0</span>, i]] = <span class="hljs-number">1</span><br>            zeros[cc_nonzeros[<span class="hljs-number">1</span>, i] + c_nonzeros.shape[<span class="hljs-number">0</span>]] = <span class="hljs-number">1</span><br>            A.append(zeros)<br>            B.append(c_nonzeros[cc_nonzeros[<span class="hljs-number">0</span>, i], cc_nonzeros[<span class="hljs-number">1</span>, i]])<br>        l = [<span class="hljs-number">1</span>]<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length - <span class="hljs-number">1</span>):<br>            l.append(<span class="hljs-number">0</span>)  <span class="hljs-comment"># 补充一个x1=0的方程以满足求解条件</span><br>        A.append(l)<br>        B.append(<span class="hljs-number">0</span>)<br>        <span class="hljs-comment"># print(A)</span><br>        <span class="hljs-comment"># print(B)</span><br>        A = np.array(A)<br>        B = np.array(B)<br>        judge = if_dsquare(A, B)<br>        <span class="hljs-keyword">if</span> judge == <span class="hljs-literal">True</span>:<br>            sol = np.linalg.solve(A, B)  <span class="hljs-comment"># 求解条件：A的行数（方程个数)=A的列数(变量个数）=B的个数（方程结果个数）才能解</span><br>            <span class="hljs-comment"># print(sol)</span><br>            var = []  <span class="hljs-comment"># 创建位势名称数组</span><br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(c_nonzeros.shape[<span class="hljs-number">0</span>]):<br>                var.append(<span class="hljs-string">&#x27;u&#x27;</span> + <span class="hljs-built_in">str</span>(i + <span class="hljs-number">1</span>))<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(c_nonzeros.shape[<span class="hljs-number">1</span>]):<br>                var.append(<span class="hljs-string">&#x27;v&#x27;</span> + <span class="hljs-built_in">str</span>(j + <span class="hljs-number">1</span>))<br>            <span class="hljs-comment"># print(var)</span><br>            solset = <span class="hljs-built_in">dict</span>(<span class="hljs-built_in">zip</span>(var, sol))<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&gt;&gt;&gt;当前位势:\n&#x27;</span>, solset)<br>            u = []<br>            v = []<br>            [m, n] = c_nonzeros.shape<br>            zero_places = np.transpose(np.argwhere(c_nonzeros == <span class="hljs-number">0</span>))<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>                u.append(sol[i])<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>                v.append(sol[j + m])<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(zero_places.shape[<span class="hljs-number">1</span>]):<br>                c_nonzeros[zero_places[<span class="hljs-number">0</span>, k], zero_places[<span class="hljs-number">1</span>, k]] = u[zero_places[<span class="hljs-number">0</span>, k]] + v[zero_places[<span class="hljs-number">1</span>, k]]<br>            <span class="hljs-comment"># print(c_nonzeros)</span><br>            sigma = cost - c_nonzeros<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&gt;&gt;&gt;检验表σ：\n&#x27;</span>, sigma)<br>            <span class="hljs-keyword">if</span> np.<span class="hljs-built_in">all</span>(sigma &gt;= <span class="hljs-number">0</span>):<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&gt;&gt;&gt;TP已达到最优解&lt;&lt;&lt;&#x27;</span>)<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&gt;&gt;&gt;TP未达到最优解&lt;&lt;&lt;&#x27;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            sigma = <span class="hljs-literal">None</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&gt;&gt;&gt;位势方程组不可解&lt;&lt;&lt;&#x27;</span>)<br>    <span class="hljs-keyword">return</span> sigma<br></code></pre></td></tr></table></figure><p>结果</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><code class="hljs subunit">c:<br> [[ 3. 11.  3. 10.]<br> [ 1.  9.  2.  8.]<br> [ 7.  4. 10.  5.]]<br>行罚数： [0.0, 1.0, 1.0]<br>列罚数： [2.0, 5.0, 1.0, 3.0]<br>罚数向量： [0.0, 1.0, 1.0, 2.0, 5.0, 1.0, 3.0]<br>最大罚数： 5.0 元素序号： 5<br>对第 2 列进行操作：<br>[11.  9.  4.]<br>最小成本所在行索引： 2<br>本次迭代后的x矩阵：<br> [[0. 0. 0. 0.]<br> [0. 0. 0. 0.]<br> [0. 6. 0. 0.]]<br>a: [7. 4. 3.]<br>b: [3. 0. 5. 6.]<br>c:<br> [[3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+09</span> 3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+01</span>]<br> [1.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+09</span> 2.e<span class="hljs-string">+00</span> 8.e<span class="hljs-string">+00</span>]<br> [7.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+01</span> 5.e<span class="hljs-string">+00</span>]]<br>【迭代未完成】<br>------------------------------------------------------------<br>c:<br> [[3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+09</span> 3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+01</span>]<br> [1.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+09</span> 2.e<span class="hljs-string">+00</span> 8.e<span class="hljs-string">+00</span>]<br> [7.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+01</span> 5.e<span class="hljs-string">+00</span>]]<br>行罚数： [0.0, 1.0, 2.0]<br>列罚数： [2.0, 0.0, 1.0, 3.0]<br>罚数向量： [0.0, 1.0, 2.0, 2.0, 0.0, 1.0, 3.0]<br>最大罚数： 3.0 元素序号： 7<br>对第 4 列进行操作：<br>[10.  8.  5.]<br>最小成本所在行索引： 2<br>本次迭代后的x矩阵：<br> [[0. 0. 0. 0.]<br> [0. 0. 0. 0.]<br> [0. 6. 0. 3.]]<br>a: [7. 4. 0.]<br>b: [3. 0. 5. 3.]<br>c:<br> [[3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+09</span> 3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+01</span>]<br> [1.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+09</span> 2.e<span class="hljs-string">+00</span> 8.e<span class="hljs-string">+00</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]]<br>【迭代未完成】<br>------------------------------------------------------------<br>c:<br> [[3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+09</span> 3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+01</span>]<br> [1.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+09</span> 2.e<span class="hljs-string">+00</span> 8.e<span class="hljs-string">+00</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]]<br>行罚数： [0.0, 1.0, 0.0]<br>列罚数： [2.0, 0.0, 1.0, 2.0]<br>罚数向量： [0.0, 1.0, 0.0, 2.0, 0.0, 1.0, 2.0]<br>最大罚数： 2.0 元素序号： 4<br>对第 1 列进行操作：<br>[3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+09</span>]<br>最小成本所在行索引： 1<br>本次迭代后的x矩阵：<br> [[0. 0. 0. 0.]<br> [3. 0. 0. 0.]<br> [0. 6. 0. 3.]]<br>a: [7. 1. 0.]<br>b: [0. 0. 5. 3.]<br>c:<br> [[1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+01</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 2.e<span class="hljs-string">+00</span> 8.e<span class="hljs-string">+00</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]]<br>【迭代未完成】<br>------------------------------------------------------------<br>c:<br> [[1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+01</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 2.e<span class="hljs-string">+00</span> 8.e<span class="hljs-string">+00</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]]<br>行罚数： [7.0, 6.0, 0.0]<br>列罚数： [0.0, 0.0, 1.0, 2.0]<br>罚数向量： [7.0, 6.0, 0.0, 0.0, 0.0, 1.0, 2.0]<br>最大罚数： 7.0 元素序号： 1<br>对第 1 行进行操作：<br>[1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 3.e<span class="hljs-string">+00</span> 1.e<span class="hljs-string">+01</span>]<br>最小成本所在列索引： 2<br>本次迭代后的x矩阵：<br> [[0. 0. 5. 0.]<br> [3. 0. 0. 0.]<br> [0. 6. 0. 3.]]<br>a: [2. 1. 0.]<br>b: [0. 0. 0. 3.]<br>c:<br> [[1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+01</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 8.e<span class="hljs-string">+00</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]]<br>【迭代未完成】<br>------------------------------------------------------------<br>c:<br> [[1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+01</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 8.e<span class="hljs-string">+00</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]]<br>行罚数： [999999990.0, 999999992.0, 0.0]<br>列罚数： [0.0, 0.0, 0.0, 2.0]<br>罚数向量： [999999990.0, 999999992.0, 0.0, 0.0, 0.0, 0.0, 2.0]<br>最大罚数： 999999992.0 元素序号： 2<br>对第 2 行进行操作：<br>[1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 8.e<span class="hljs-string">+00</span>]<br>最小成本所在列索引： 3<br>本次迭代后的x矩阵：<br> [[0. 0. 5. 0.]<br> [3. 0. 0. 1.]<br> [0. 6. 0. 3.]]<br>a: [2. 0. 0.]<br>b: [0. 0. 0. 2.]<br>c:<br> [[1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+01</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]]<br>【迭代未完成】<br>------------------------------------------------------------<br>c:<br> [[1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+01</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]]<br>行罚数： [999999990.0, 0.0, 0.0]<br>列罚数： [0.0, 0.0, 0.0, 999999990.0]<br>罚数向量： [999999990.0, 0.0, 0.0, 0.0, 0.0, 0.0, 999999990.0]<br>最大罚数： 999999990.0 元素序号： 1<br>对第 1 行进行操作：<br>[1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+01</span>]<br>最小成本所在列索引： 3<br>本次迭代后的x矩阵：<br> [[0. 0. 5. 2.]<br> [3. 0. 0. 1.]<br> [0. 6. 0. 3.]]<br>a: [0. 0. 0.]<br>b: [0. 0. 0. 0.]<br>c:<br> [[1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]<br> [1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span> 1.e<span class="hljs-string">+09</span>]]<br>【迭代完成】<br>------------------------------------------------------------<br>&gt;&gt;&gt;供求平衡&lt;&lt;&lt;<br>&gt;&gt;&gt;初始基本可行解x*：<br> [[0. 0. 5. 2.]<br> [3. 0. 0. 1.]<br> [0. 6. 0. 3.]]<br>&gt;&gt;&gt;当前总成本： 85.0<br>&gt;&gt;&gt;位势方程组可解&lt;&lt;&lt;<br>&gt;&gt;&gt;当前位势:<br> &#123;&#x27;u1&#x27;: 0.0, &#x27;u2&#x27;: <span class="hljs-string">-2</span>.0, &#x27;u3&#x27;: <span class="hljs-string">-5</span>.0, &#x27;v1&#x27;: 3.0, &#x27;v2&#x27;: 9.0, &#x27;v3&#x27;: 3.0, &#x27;v4&#x27;: 10.0&#125;<br>&gt;&gt;&gt;检验数表σ：<br> [[ 0.  2.  0.  0.]<br> [ 0.  2.  1.  0.]<br> [ 9.  0. 12.  0.]]<br>&gt;&gt;&gt;TP已达到最优解&lt;&lt;&lt;<br></code></pre></td></tr></table></figure><p>退化现象的问题暂时不可解。</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs inform7">&gt;&gt;&gt;供求平衡&lt;&lt;&lt;<br>&gt;&gt;&gt;初始基本可行解x*：<br> <span class="hljs-comment">[<span class="hljs-comment">[1. 0. 0. 0. 0.]</span></span><br><span class="hljs-comment"> <span class="hljs-comment">[0. 0. 1. 0. 0.]</span></span><br><span class="hljs-comment"> <span class="hljs-comment">[0. 0. 0. 1. 0.]</span></span><br><span class="hljs-comment"> <span class="hljs-comment">[0. 0. 0. 0. 1.]</span></span><br><span class="hljs-comment"> <span class="hljs-comment">[0. 1. 0. 0. 0.]</span>]</span><br>&gt;&gt;&gt;当前总成本： 0.8999999999999999<br>【注意：问题含有退化解】<br>【问题含有退化解，暂时无法判断最优性】<br></code></pre></td></tr></table></figure><p>参考资料：</p><blockquote><p>运筹学 第4版 钱颂迪 清华大学出版社</p><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/448725456">https://zhuanlan.zhihu.com/p/448725456</a></p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_46927406/article/details/109903843">https://blog.csdn.net/m0_46927406/article/details/109903843</a></p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_46927406/article/details/110070154">https://blog.csdn.net/m0_46927406/article/details/110070154</a></p></blockquote></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/%E7%A0%94%E7%A9%B6%E6%96%B9%E5%90%91/" class="category-chain-item">研究方向</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/Python/" class="print-no-link">#Python</a></div></div><div class="license-box my-3"><div class="license-title"><div>使用伏格尔法解决运输问题</div><div>https://fulequn.github.io/2023/06/Article202306192/</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>Fulequn</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2023年6月19日</div></div><div class="license-meta-item"><div>许可协议</div><div><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/2023/06/Article202306201/" title="语音方面的项目（包含介绍）"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">语音方面的项目（包含介绍）</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/2023/06/Article202306191/" title="组合拍卖知识总结"><span class="hidden-mobile">组合拍卖知识总结</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>目录</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t,e){var i=Fluid.plugins.typing,n=e.getElementById("subtitle");n&&i&&i(n.getAttribute("data-typed-text"))}(window,document)</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js",(function(){var t=jQuery("#toc");if(0!==t.length&&window.tocbot){var i=jQuery("#board-ctn").offset().top;window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-i},CONFIG.toc)),t.find(".toc-list-item").length>0&&t.css("visibility","visible"),Fluid.events.registerRefreshCallback((function(){if("tocbot"in window){tocbot.refresh();var t=jQuery("#toc");if(0===t.length||!tocbot)return;t.find(".toc-list-item").length>0&&t.css("visibility","visible")}}))}}))</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",(function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback((function(){if("anchors"in window){anchors.removeAll();var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}}))}))</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",(function(){Fluid.plugins.fancyBox()}))</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>