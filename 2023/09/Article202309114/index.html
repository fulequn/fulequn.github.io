<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png"><link rel="icon" href="/img/favicon.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="Fulequn"><meta name="keywords" content=""><meta name="description" content="1. 接口安装 Python是一种广泛使用的脚本语言，用于金融工程等领域。要安装Python接口，遵循以下步骤：  访问Python官方下载地址：http:&#x2F;&#x2F;www.python.org&#x2F; 选择适当的Python版本并按照要求下载和安装。 Windows系统，支持32位和64位系统。 Python版本可以是2.6、2.7、3.3或更高版本。 安装时需要系统管理员权限。   确保达到上述安装要求"><meta property="og:type" content="article"><meta property="og:title" content="WindPy接口手册"><meta property="og:url" content="https://fulequn.github.io/2023/09/Article202309114/index.html"><meta property="og:site_name" content="FuLeQun&#39;s Blog"><meta property="og:description" content="1. 接口安装 Python是一种广泛使用的脚本语言，用于金融工程等领域。要安装Python接口，遵循以下步骤：  访问Python官方下载地址：http:&#x2F;&#x2F;www.python.org&#x2F; 选择适当的Python版本并按照要求下载和安装。 Windows系统，支持32位和64位系统。 Python版本可以是2.6、2.7、3.3或更高版本。 安装时需要系统管理员权限。   确保达到上述安装要求"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://raw.githubusercontent.com/fulequn/oss_img/master/202309111534366.jpeg"><meta property="og:image" content="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202309111534708.png"><meta property="article:published_time" content="2023-09-11T06:25:18.000Z"><meta property="article:modified_time" content="2024-05-18T14:35:07.940Z"><meta property="article:author" content="Fulequn"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://raw.githubusercontent.com/fulequn/oss_img/master/202309111534366.jpeg"><title>WindPy接口手册 - FuLeQun&#39;s Blog</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var CONFIG={hostname:"fulequn.github.io",root:"/",version:"1.9.7",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!1,follow_dnt:!0,baidu:null,google:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1},gtag:null,tajs:null},search_path:"/local-search.xml",include_content_in_search:!0};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css"><meta name="generator" content="Hexo 7.2.0"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>FuLeQun&#39;s Blog</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/" target="_self"><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/" target="_self"><i class="iconfont icon-archive-fill"></i> <span>归档</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/" target="_self"><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/" target="_self"><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class="nav-item"><a class="nav-link" href="/about/" target="_self"><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/default.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="WindPy接口手册"></span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2023-09-11 14:25" pubdate>2023年9月11日 下午</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i>7.4k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i>62 分钟</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 id="seo-header">WindPy接口手册</h1><div class="markdown-body"><h2 id="1-接口安装"><a class="markdownIt-Anchor" href="#1-接口安装"></a> 1. 接口安装</h2><p>Python是一种广泛使用的脚本语言，用于金融工程等领域。要安装Python接口，遵循以下步骤：</p><ul><li>访问Python官方下载地址：<a target="_blank" rel="noopener" href="http://www.python.org/">http://www.python.org/</a></li><li>选择适当的Python版本并按照要求下载和安装。</li><li>Windows系统，支持32位和64位系统。</li><li>Python版本可以是2.6、2.7、3.3或更高版本。</li><li>安装时需要系统管理员权限。</li></ul><ol><li>确保达到上述安装要求，并关闭Python环境，以及用到控件的MATLAB/R /C++环境等；</li><li>打开Wind金融终端，点击**“我的/插件修复”<strong>选项，出现下方的界面，点击</strong>“修复Python接口”**，会弹出接口的相关说明；</li></ol><p><img src="https://raw.githubusercontent.com/fulequn/oss_img/master/202309111534366.jpeg" srcset="/img/loading.gif" lazyload alt="修复接口.png"></p><p><img src="https://raw.githubusercontent.com/fulequn/oss_img/master/img231/202309111534708.png" srcset="/img/loading.gif" lazyload alt="修复完成.png"></p><p><strong>注：</strong> 修复完成后，可通过“配置详情”按钮查看具体修复了哪些Python。若列表并没有需要使用的Python，可通过“添加路径”按钮修复指定的Python (添加路径格式可参考具体的提示)。</p><h2 id="2-调用windpy"><a class="markdownIt-Anchor" href="#2-调用windpy"></a> 2. 调用WindPy</h2><p>使用WindPy API接口获取金融数据，按以下步骤操作：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> WindPy <span class="hljs-keyword">import</span> w<br><br><span class="hljs-comment"># 注： w.start不重复启动，若需要改变参数，如超时时间，用户可以使用w.stop命令先停止后再启动。</span><br>w.start()  <span class="hljs-comment"># 默认命令超时时间为120秒，可以设置超时时间，如waitTime=60</span><br>w.isconnected()  <span class="hljs-comment"># 判断WindPy是否已登录成功</span><br>w.stop()  <span class="hljs-comment"># 停止WindPy</span><br></code></pre></td></tr></table></figure><p>需要注意，程序退出时会自动执行w.stop()，一般用户不需要手动执行。</p><h2 id="3-获取日时间序列函数wsd"><a class="markdownIt-Anchor" href="#3-获取日时间序列函数wsd"></a> 3. 获取日时间序列函数WSD</h2><p><code>wsd</code>可以支持取 <strong>多品种单指标</strong> 或者 <strong>单品种多指标</strong> 的时间序列数据。函数签名：</p><h3 id="函数签名"><a class="markdownIt-Anchor" href="#函数签名"></a> 函数签名</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">w.wsd(codes, fields, beginTime, endTime, options)<br></code></pre></td></tr></table></figure><h3 id="参数说明"><a class="markdownIt-Anchor" href="#参数说明"></a> 参数说明</h3><table><thead><tr><th>参数</th><th>类型</th><th>可选</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>codes</td><td>str 或 list</td><td>否</td><td>无</td><td>证券代码，支持单个或多个代码，例如：&quot;<a target="_blank" rel="noopener" href="http://600030.SH">600030.SH</a>&quot;或[“<a target="_blank" rel="noopener" href="http://600010.SH">600010.SH</a>”, “<a target="_blank" rel="noopener" href="http://000001.SZ">000001.SZ</a>”]</td></tr><tr><td>fields</td><td>str 或 list</td><td>否</td><td>无</td><td>指标列表，支持单个或多个指标，例如：“CLOSE,HIGH,LOW,OPEN” 或 [“CLOSE”, “HIGH”, “LOW”, “OPEN”]</td></tr><tr><td>beginTime</td><td>str 或 datetime</td><td>是</td><td>endTime</td><td>起始日期，可以使用日期字符串或datetime/date类型，例如：“2016-01-01”、“20160101”、“2016/01/01”、“-5D”（当前日期前推5个交易日）</td></tr><tr><td>endTime</td><td>str 或 datetime</td><td>是</td><td>系统当前日期</td><td>结束日期，可以使用日期字符串或datetime/date类型，例如：“2016-01-05”、“20160105”、“2016/01/05”、“-2D”（当前日期前推2个交易日）</td></tr><tr><td>options</td><td>str</td><td>是</td><td>“”</td><td>选项参数以字符串形式集成多个参数，具体见下文。</td></tr></tbody></table><h3 id="options参数说明"><a class="markdownIt-Anchor" href="#options参数说明"></a> options参数说明</h3><p>options以字符串的形式集成了多个参数，以下列举了一些常用的参数：</p><table><thead><tr><th>参数</th><th>类型</th><th>可选</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>Days</td><td>str</td><td>是</td><td>‘Trading’</td><td>日期选项，参数值含义如下：<br>- Weekdays: 工作日<br>- Alldays: 日历日<br>- Trading: 交易日</td></tr><tr><td>Fill</td><td>str</td><td>是</td><td>‘Blank’</td><td>空值填充方式。参数值含义如下：<br>- Previous：沿用前值<br>- Blank：返回空值<br>- 如需选择自设数值填充，在options添加“ShowBlank=X&quot;，其中X为自设数</td></tr><tr><td>Order</td><td>str</td><td>是</td><td>‘A’</td><td>日期排序，“A”：升序，“D”：降序</td></tr><tr><td>Period</td><td>str</td><td>是</td><td>‘D’</td><td>取值周期。参数值含义如下：<br>- D：天<br>- W：周<br>- M：月<br>- Q：季度<br>- S：半年<br>- Y：年</td></tr><tr><td>TradingCalendar</td><td>str</td><td>是</td><td>‘SSE’</td><td>交易日对应的交易所。参数值含义如下：<br>- SSE ：上海证券交易所<br>- SZSE：深圳证券交易所<br>- CFFE：中金所<br>- TWSE：台湾证券交易所<br>- DCE：大商所<br>- NYSE：纽约证券交易所<br>- CZCE：郑商所<br>- COMEX：纽约金属交易所<br>- SHFE：上期所<br>- NYBOT：纽约期货交易所<br>- HKEX：香港交易所<br>- CME：芝加哥商业交易所<br>- Nasdaq：纳斯达克证券交易所<br>- NYMEX：纽约商品交易所<br>- CBOT：芝加哥商品交易所<br>- LME：伦敦金属交易所<br>- IPE：伦敦国际石油交易所</td></tr><tr><td>Currency</td><td>str</td><td>是</td><td>‘Original’</td><td>输入币种。参数值含义如下：<br>- Original：“原始货币”<br>- HKD：“港币”<br>- USD：“美元”<br>- CNY：“人民币”</td></tr><tr><td>PriceAdj</td><td>str</td><td>是</td><td>不复权</td><td>股票和基金(复权方式)。参数值含义如下：<br>- F：前复权<br>- B：后复权<br>- T：定点复权；债券(价格类型)<br>- CP：净价<br>- DP：全价<br>- MP：市价<br>- YTM：收益率</td></tr></tbody></table><h3 id="返回说明"><a class="markdownIt-Anchor" href="#返回说明"></a> 返回说明</h3><p>如果不指定<code>usedf=True</code>，该函数将返回一个WindData对象，包含以下成员：</p><ul><li><code>ErrorCode</code>：错误ID，返回代码运行错误码，<code>.ErrorCode = 0</code>表示代码运行正常。若为其他值，则需查找错误原因。</li><li><code>Data</code>：数据列表，返回函数获取的数据，例如，读取000592.SZ的close指标从’2017-05-08’到’2017-05-18’区间的数据，返回值为<code>Data=[[5.12,5.16,5.02,4.9,4.91,5.13,5.35,5.42,5.32],[5.3,5.12,5.17,4.98,4.94,4.93,5.1,5.4,5.4]]</code>。</li><li><code>Codes</code>：证券代码列表，返回获取数据的证券代码列表，例如，<code>Codes=[000592.SZ]</code>。</li><li><code>Field</code>：指标列表，返回获取数据的指标列表，例如，<code>Fields=[CLOSE]</code>。</li><li><code>Times</code>：时间列表，返回获取数据的日期序列，例如，<code>Times=[20170508,20170509,20170510,20170511,20170512,20170515,20170516,20170517,20170518]</code>。</li></ul><h3 id="示例"><a class="markdownIt-Anchor" href="#示例"></a> 示例</h3><p><strong>示例 1：获取单个证券的历史数据并将结果返回为DataFrame</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 获取证券代码为&#x27;600030.SH&#x27;的指标数据，从&#x27;2020-01-01&#x27;到&#x27;2020-12-31&#x27;的每日数据</span><br>w.wsd(<span class="hljs-string">&quot;600030.SH&quot;</span>, <span class="hljs-string">&quot;CLOSE,HIGH,LOW,OPEN&quot;</span>, <span class="hljs-string">&quot;2020-01-01&quot;</span>, <span class="hljs-string">&quot;2020-12-31&quot;</span>)<br></code></pre></td></tr></table></figure><p><strong>示例 2：获取多个证券的单个指标数据</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 获取多个证券的收盘价数据，从&#x27;2020-01-01&#x27;到&#x27;2020-12-31&#x27;的每日数据</span><br>w.wsd([<span class="hljs-string">&quot;600030.SH&quot;</span>, <span class="hljs-string">&quot;000001.SZ&quot;</span>], <span class="hljs-string">&quot;CLOSE&quot;</span>, <span class="hljs-string">&quot;2020-01-01&quot;</span>, <span class="hljs-string">&quot;2020-12-31&quot;</span>)<br></code></pre></td></tr></table></figure><p><strong>示例 3：指定选项参数</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 获取证券代码为&#x27;600030.SH&#x27;的最高价和最低价数据，从&#x27;2020-01-01&#x27;到&#x27;2020-12-31&#x27;的每日数据</span><br>w.wsd(<span class="hljs-string">&quot;600030.SH&quot;</span>, <span class="hljs-string">&quot;HIGH,LOW&quot;</span>, <span class="hljs-string">&quot;2020-01-01&quot;</span>, <span class="hljs-string">&quot;2020-12-31&quot;</span>, <span class="hljs-string">&quot;PriceAdj=B;Period=W;TradingCalendar=SSE&quot;</span>)<br></code></pre></td></tr></table></figure><p><strong>示例 4：输出DataFrame格式数据</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 获取证券代码为&#x27;600030.SH&#x27;的收盘价数据，从&#x27;2020-01-01&#x27;到&#x27;2020-12-31&#x27;的每日数据，并输出为DataFrame格式</span><br>w.wsd(<span class="hljs-string">&quot;600030.SH&quot;</span>, <span class="hljs-string">&quot;CLOSE&quot;</span>, <span class="hljs-string">&quot;2020-01-01&quot;</span>, <span class="hljs-string">&quot;2020-12-31&quot;</span>, usedf=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure><h2 id="4获取日截面数据函数wss"><a class="markdownIt-Anchor" href="#4获取日截面数据函数wss"></a> 4.获取日截面数据函数WSS</h2><p>函数 <code>w.wss</code> 用于获取日截面数据，可以获取多种证券类型的基本资料、市场行情、财务数据等多种数据，支持多个品种和多个指标的获取。以下是详细的参数说明和示例用法。</p><h3 id="参数说明-2"><a class="markdownIt-Anchor" href="#参数说明-2"></a> 参数说明</h3><table><thead><tr><th>参数</th><th>类型</th><th>可选</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>windCodes</td><td>str 或 list</td><td>否</td><td>无</td><td>证券代码，支持获取单品种或多品种，如 ‘<a target="_blank" rel="noopener" href="http://600030.SH">600030.SH</a>’ 或 [‘<a target="_blank" rel="noopener" href="http://600010.SH">600010.SH</a>’, ‘<a target="_blank" rel="noopener" href="http://000001.SZ">000001.SZ</a>’]。</td></tr><tr><td>Fields</td><td>str 或 list</td><td>否</td><td>无</td><td>指标列表，支持获取多指标，如 ‘CLOSE,HIGH,LOW,OPEN’。</td></tr><tr><td>options</td><td>str</td><td>是</td><td>“”</td><td>以字符串形式集成多个参数，具体参数见代码生成器。如果无相关参数设置，可以不给 option 赋值或使用 options=“”。</td></tr></tbody></table><h3 id="注意事项"><a class="markdownIt-Anchor" href="#注意事项"></a> 注意事项</h3><ul><li><code>wss</code> 函数一次只能提取一个交易日或报告期数据，但可以提取多个品种和多个指标。</li><li>可选参数众多，如 <code>rptDate</code>、<code>currencyType</code>、<code>rptType</code> 等，可以借助代码生成器获取。</li><li><code>wss</code> 函数支持输出 DataFrame 数据格式，需要添加参数 <code>usedf=True</code>，还可以使用 <code>usedfdt=True</code> 来填充 DataFrame 输出的 NaT 日期。</li></ul><h3 id="返回说明-2"><a class="markdownIt-Anchor" href="#返回说明-2"></a> 返回说明</h3><p>如果不指定 <code>usedf=True</code>，该函数将返回一个 <code>WindData</code> 对象，包含以下成员：</p><ul><li><code>ErrorCode</code>：错误ID，返回代码运行错误码，0 表示代码运行正常，其他值需查找错误原因。</li><li><code>Data</code>：数据列表，包含获取的数据，例如读取 “<a target="_blank" rel="noopener" href="http://600111.SH">600111.SH</a>,<a target="_blank" rel="noopener" href="http://600340.SH">600340.SH</a>,<a target="_blank" rel="noopener" href="http://600485.SH">600485.SH</a>” 的 “eps_basic,profittogr” 指标在 20161231（2016 年年报）的数据，返回值为 <code>Data=[[0.025,2.22,0.52],[1.5701,11.4605,51.8106]]</code>。</li><li><code>Codes</code>：证券代码列表，返回获取数据的证券代码列表，如 <code>Codes=[600111.SH,600340.SH,600485.SH]</code>。</li><li><code>Field</code>：指标列表，返回获取数据的指标列表，如 <code>Fields=[EPS_BASIC,PROFITTOGR]</code>。</li><li><code>Times</code>：时间列表，返回获取数据的日期序列，如 <code>Times=[20180824]</code>。</li></ul><h3 id="示例用法"><a class="markdownIt-Anchor" href="#示例用法"></a> 示例用法</h3><p>以下是一个示例，用于获取被动指数型基金的最新业绩排名：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 取被动指数型基金最新业绩排名</span><br>fund = w.wset(<span class="hljs-string">&quot;sectorconstituent&quot;</span>, <span class="hljs-string">&quot;date=2018-06-11;sectorid=2001010102000000&quot;</span>).Data[<span class="hljs-number">1</span>]<br><br>error_code, returns = w.wss(fund,<span class="hljs-string">&quot;sec_name,return_1w,return_1m,return_3m,return_6m,return_1y,return_ytd,fund_fundmanager&quot;</span>,<span class="hljs-string">&quot;annualized=0;tradeDate=20180611&quot;</span>, usedf=<span class="hljs-literal">True</span>)<br><br>returns.head(<span class="hljs-number">10</span>)<br></code></pre></td></tr></table></figure><p>这个示例中，首先使用 <code>w.wset</code> 函数获取被动指数型基金的最新业绩排名，然后使用 <code>w.wss</code> 函数获取所选基金的相关数据，包括基金名称、一周、一月、三月、六月、一年、今年以来的回报率等信息。</p><h2 id="5-获取分钟序列数据函数wsi"><a class="markdownIt-Anchor" href="#5-获取分钟序列数据函数wsi"></a> 5. 获取分钟序列数据函数WSI</h2><p>函数 <code>w.wsi</code> 用于获取国内六大交易所（上海交易所、深圳交易所、郑州商品交易所、上海国际能源交易中心、上海期货交易所、大连商品交易所）证券品种的分钟线数据，包括基本行情和部分技术指标的分钟数据。该函数支持分钟周期为1-60分钟，并且可以自定义设置技术指标参数。</p><h3 id="参数说明-3"><a class="markdownIt-Anchor" href="#参数说明-3"></a> 参数说明</h3><table><thead><tr><th>参数</th><th>类型</th><th>可选</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>codes</td><td>str 或 list</td><td>否</td><td>无</td><td>证券代码，支持获取单品种或多品种，如 ‘<a target="_blank" rel="noopener" href="http://600030.SH">600030.SH</a>’ 或 [‘<a target="_blank" rel="noopener" href="http://600010.SH">600010.SH</a>’, ‘<a target="_blank" rel="noopener" href="http://000001.SZ">000001.SZ</a>’]。</td></tr><tr><td>fields</td><td>str 或 list</td><td>否</td><td>无</td><td>指标列表，支持获取单指标或多指标，如 ‘CLOSE,HIGH,LOW,OPEN’。</td></tr><tr><td>beginTime</td><td>str 或 datetime</td><td>是</td><td>endTime</td><td>分钟数据的起始时间，支持字符串、datetime/date，如: “2016-01-01 09:00:00”。</td></tr><tr><td>endTime</td><td>str 或 datetime</td><td>是</td><td>当前系统时间</td><td>分钟数据的截止时间，支持字符串、datetime/date，如: “2016-01-01 15:00:00”，默认为当前系统时间。</td></tr><tr><td>options</td><td>str</td><td>是</td><td>“”</td><td>以字符串形式集成多个参数，具体参数见代码生成器。如果无相关参数设置，可以不给 <code>option</code> 赋值或使用 <code>options=&quot;&quot;</code>。</td></tr></tbody></table><h3 id="集成在-options-中的参数"><a class="markdownIt-Anchor" href="#集成在-options-中的参数"></a> 集成在 <code>options</code> 中的参数</h3><p><code>options</code> 以字符串形式集成了多个参数。以下是一些常用的参数：</p><table><thead><tr><th>参数</th><th>类型</th><th>可选</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>BarSize</td><td>str</td><td>是</td><td>“1”</td><td><code>BarSize</code> 在1-60间选择输入整数数字，代表分钟数。</td></tr><tr><td>Fill</td><td>str</td><td>是</td><td>‘Blank’</td><td>空值填充方式。参数值含义如下：<code>Previous</code>：沿用前值，<code>Blank</code>：返回空值。如果需要选择自设数值填充，在 <code>options</code> 添加 “ShowBlank=X&quot;，其中 X 为自设数。</td></tr><tr><td>PriceAdj</td><td>str</td><td>是</td><td>U</td><td>股票和基金的复权方式。参数值含义如下：<code>U</code>：不复权，<code>F</code>：前复权，<code>B</code>：后复权。</td></tr></tbody></table><h3 id="注意事项-2"><a class="markdownIt-Anchor" href="#注意事项-2"></a> 注意事项</h3><ul><li><code>wsi</code> 一次支持提取单品种或多品种，品种名可以带有“.SH”等后缀。</li><li>提取的指标 <code>fields</code> 和可选参数 <code>options</code> 可以用 list 实现。</li><li><code>wsi</code> 支持国内六大交易所近三年的分钟数据。</li><li><code>wsi</code> 函数支持输出 DataFrame 数据格式，需要函数添加参数 <code>usedf=True</code>，可以在示例2中看到示例用法。</li><li>单次提取一个品种支持近三年数据，若单次提取多个品种，则品种数 * 天数 ≤ 100。</li></ul><h3 id="返回说明-3"><a class="markdownIt-Anchor" href="#返回说明-3"></a> 返回说明</h3><p>如果不指定 <code>usedf=True</code>，该函数将返回一个 <code>WindData</code> 对象，包含以下成员：</p><ul><li><code>ErrorCode</code>：错误ID，返回代码运行错误码，0 表示代码运行正常，其他值需查找错误原因。</li><li><code>Data</code>：数据列表，包含获取的数据。例如，读取 “<a target="_blank" rel="noopener" href="http://600111.SH">600111.SH</a>” 的 “open,high” 指标从 2017-06-01 09:30:00 至 2017-06-01 10:01:00 的五分钟数据，返回值为 <code>Data=[[45.4,45.15,45.42,45.34,45.47,45.48],[45.63,45.49,45.56,45.52,45.51,45.72]]</code>。</li><li><code>Codes</code>：证券代码列表，返回获取数据的证券代码列表，如 <code>Codes=[600111.SH,600340.SH,600485.SH]</code>。</li><li><code>Field</code>：指标列表，返回获取数据的指标列表，如 <code>Fields=[open,high]</code>。</li><li><code>Times</code>：时间列表，返回获取数据的日期序列，如 <code>Times=[20170601 09:35:00,20170601 09:40:00,20170601 09:45:00,20170601 09:50:00,20170601 09:55:00,20170601 10:00:00]</code>。</li></ul><h3 id="示例用法-2"><a class="markdownIt-Anchor" href="#示例用法-2"></a> 示例用法</h3><p>以下是一个示例用法，用于获取 IF00.CFE 的分钟数据：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 取 IF00.CFE 的分钟数据</span><br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br>codes = <span class="hljs-string">&quot;IF00.CFE&quot;</span><br>fields = <span class="hljs-string">&quot;open,high,low,close&quot;</span><br>error, data = w.wsi(codes, fields, <span class="hljs-string">&quot;2017-06-01 09:30:00&quot;</span>, datetime.today(), <span class="hljs-string">&quot;&quot;</span>, usedf=<span class="hljs-literal">True</span>)<br><span class="hljs-comment"># 其中，datetime.today() 是 Python 内置的日期函数，表示当前时刻。</span><br></code></pre></td></tr></table></figure><p>在这个示例中，首先从 IF00.CFE 提取分钟数据，包括开盘价、最高价、最低价和收盘价。</p><h2 id="6-获取日内tick数据函数wst"><a class="markdownIt-Anchor" href="#6-获取日内tick数据函数wst"></a> 6. 获取日内tick数据函数WST</h2><p>函数 <code>w.wst</code> 用于获取国内六大交易所（上海交易所、深圳交易所、郑州商品交易所、上海国际能源交易中心、上海期货交易所、大连商品交易所）证券品种的日内盘口买卖五档快照数据和分时成交数据（tick数据）。</p><h3 id="参数说明-4"><a class="markdownIt-Anchor" href="#参数说明-4"></a> 参数说明</h3><table><thead><tr><th>参数</th><th>类型</th><th>可选</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>codes</td><td>str 或 list</td><td>否</td><td>无</td><td>证券代码，支持获取单品种，如 ‘<a target="_blank" rel="noopener" href="http://600030.SH">600030.SH</a>’。</td></tr><tr><td>fields</td><td>str 或 list</td><td>否</td><td>无</td><td>指标列表，支持获取单指标或多指标，如 ‘CLOSE,HIGH,LOW,OPEN’。</td></tr><tr><td>beginTime</td><td>str 或 datetime</td><td>是</td><td>endTime</td><td>tick数据的起始时间，支持字符串、datetime/date，如: “2016-01-01 09:00:00”。</td></tr><tr><td>endTime</td><td>str 或 datetime</td><td>是</td><td>当前系统时间</td><td>tick数据的截止时间，支持字符串、datetime/date，如: “2016-01-01 15:00:00”，默认为当前系统时间。</td></tr><tr><td>options</td><td>str</td><td>是</td><td>“”</td><td>以字符串形式集成多个参数，具体参数见代码生成器。如果无相关参数设置，可以不给 <code>option</code> 赋值或使用 <code>options=&quot;&quot;</code>。</td></tr></tbody></table><h3 id="注意事项-3"><a class="markdownIt-Anchor" href="#注意事项-3"></a> 注意事项</h3><ul><li><code>wst</code> 只支持提取单品种，并且品种名可以带有“.SH”等后缀。</li><li>提取的指标 <code>fields</code> 可以用 list 实现。</li><li><code>wst</code> 支持国内六大交易所近七个交易日的tick数据。</li><li><code>wst</code> 函数支持输出 DataFrame 数据格式，需要函数添加参数 <code>usedf=True</code>。</li></ul><h3 id="返回说明-4"><a class="markdownIt-Anchor" href="#返回说明-4"></a> 返回说明</h3><p>如果不指定 <code>usedf=True</code>，该函数将返回一个 <code>WindData</code> 对象，包含以下成员：</p><ul><li><code>ErrorCode</code>：错误ID，返回代码运行错误码，0 表示代码运行正常，其他值需查找错误原因。</li><li><code>Data</code>：数据列表，包含获取的tick数据。例如，读取 “<a target="_blank" rel="noopener" href="http://601318.SH">601318.SH</a>” 的 “last,bid1” 指标从 2017-06-13 09:30:00 至 2017-06-13 9:31:00 的tick数据，返回值为 <code>Data=[[9.11,9.11,9.11,9.11,9.11,9.11,9.11,9.11,9.11,9.11,...],[9.11,9.11,9.12,9.11,9.11,9.11,9.11,9.11,9.11,9.12,...]]</code>。</li><li><code>Codes</code>：证券代码列表，返回获取数据的证券代码列表，如 <code>Codes=[601318.SH]</code>。</li><li><code>Field</code>：指标列表，返回获取数据的指标列表，如 <code>Fields=[open,high]</code>。</li><li><code>Times</code>：时间列表，返回获取数据的日期序列，如 <code>Times=[20170601 09:35:00,20170601 09:40:00,20170601 09:45:00,20170601 09:50:00,20170601 09:55:00,20170601 10:00:00]</code>。</li></ul><h3 id="示例用法-3"><a class="markdownIt-Anchor" href="#示例用法-3"></a> 示例用法</h3><p>以下是一个示例用法，用于提取平安银行（<a target="_blank" rel="noopener" href="http://000001.SZ">000001.SZ</a>）当天的买卖盘数据：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 提取平安银行（000001.SZ）当天的买卖盘数据。</span><br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># 设置起始时间和截止时间，通过 wst 接口提取序列数据</span><br>begintime = datetime.strftime(datetime.now(), <span class="hljs-string">&#x27;%Y-%m-%d 09:30:00&#x27;</span>)<br>endtime = datetime.strftime(datetime.now(), <span class="hljs-string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>)<br><span class="hljs-comment"># last最新价，bid1 买1价，ask1 卖1价</span><br>codes = <span class="hljs-string">&quot;000001.SZ&quot;</span><br>fields = <span class="hljs-string">&quot;last,bid1,ask1&quot;</span> <br>w.wst(codes, fields, begintime, endtime)<br></code></pre></td></tr></table></figure><p>在这个示例中，首先设置起始时间和截止时间为当天的开盘时间和当前时间，然后通过 <code>wst</code> 接口提取平安银行的买卖盘数据，包括最新价、买一价和卖一价。</p><h2 id="7实时行情数据函数-wsq"><a class="markdownIt-Anchor" href="#7实时行情数据函数-wsq"></a> 7.实时行情数据函数 WSQ</h2><p>函数 <code>w.wsq</code> 用于获取股票、债券、基金、期货、指数等选定证券品种的当天指标实时数据。可以通过一次性请求实时快照数据，也可以通过订阅的方式获取实时数据。</p><h3 id="参数说明-5"><a class="markdownIt-Anchor" href="#参数说明-5"></a> 参数说明</h3><table><thead><tr><th>参数</th><th>类型</th><th>可选</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>codes</td><td>str 或 list</td><td>否</td><td>无</td><td>证券代码，支持获取单品种或多品种，如：“<a target="_blank" rel="noopener" href="http://600030.SH">600030.SH</a>,<a target="_blank" rel="noopener" href="http://000001.SZ">000001.SZ</a>” 或 [“<a target="_blank" rel="noopener" href="http://600030.SH">600030.SH</a>”, “<a target="_blank" rel="noopener" href="http://000001.SZ">000001.SZ</a>”]。</td></tr><tr><td>fields</td><td>str 或 list</td><td>否</td><td>无</td><td>指标列表，支持获取多指标，如 ‘CLOSE,HIGH,LOW,OPEN’。</td></tr><tr><td>options</td><td>str</td><td>是</td><td>“”</td><td>以字符串形式集成多个参数，具体参数见代码生成器。如果无相关参数设置，可以不给 <code>option</code> 赋值或使用 <code>options=&quot;&quot;</code>。</td></tr><tr><td>func</td><td>str</td><td>是</td><td>None</td><td>默认为 None，此时以一次性快照方式获取数据。当 <code>func=DemoWSQCallback</code> 时，以订阅的方式实时返回行情数据。<code>DemoWSQCallback</code> 的函数定义可参考 API 帮助中心的案例。</td></tr></tbody></table><h3 id="注意事项-4"><a class="markdownIt-Anchor" href="#注意事项-4"></a> 注意事项</h3><ul><li><code>wsq</code> 函数的参数中品种代码、指标和可选参数也可以用 list 实现。</li><li>用户可以一次提取或者订阅多个品种数据多个指标。</li><li>在订阅模式下，<code>wsq</code> 函数只返回订阅品种行情有变化的订阅指标，对没有变化的订阅指标不重复返回实时行情数据。</li><li>在订阅模式下，API 发现用户订阅内容发生变化则调用回调函数，并且只把变动的内容传递给回调函数。用户自己定义的回调函数格式请参考 API 帮助中心的案例，回调函数中不应处理复杂的操作。</li><li><code>wsq</code> 函数快照模式支持输出 DataFrame 数据格式，需要函数添加参数 <code>usedf=True</code>，可以使用 <code>usedfdt=True</code> 来填充 DataFrame 输出 NaT 的日期。</li></ul><h3 id="返回说明-5"><a class="markdownIt-Anchor" href="#返回说明-5"></a> 返回说明</h3><p>快照模式下函数输出字段解释如下：</p><ul><li><code>ErrorCode</code>：错误ID，返回代码运行错误码，0 表示代码运行正常，其他值需查找错误原因。</li><li><code>Data</code>：数据列表，返回函数获取的快照数据。例如，读取 &quot;<a target="_blank" rel="noopener" href="http://601318.SH">601318.SH</a> &quot; 的 “rt_last,rt_open” 指标快照数据，<code>Data=[[54.16],[53.72]]</code>。</li><li><code>Codes</code>：证券代码列表，返回获取数据的证券代码列表，如 <code>Codes=[601318.SH]</code>。</li><li><code>Field</code>：指标列表，返回获取数据的指标列表，如 <code>Fields=[open,high]</code>。</li><li><code>Times</code>：时间列表，返回获取数据的日期序列，如 <code>Times=[20170626 17:50:53]</code>。</li></ul><p>订阅模式下函数输出字段解释如下：</p><ul><li><code>ErrorCode</code>：错误ID，返回代码运行错误码，0 表示代码运行正常，其他值需查找错误原因。</li><li><code>StateCode</code>：状态ID，返回订阅时的字段，无实质意义，通常为 1。</li><li><code>RequestID</code>：请求ID，返回订阅的请求ID，通常为整数值。</li><li><code>Code</code>：证券代码列表，返回获取实时数据的品种列表，只返回行情变动指标对应的品种，如 <code>Code=[601318.SZ]</code>。</li><li><code>Fields</code>：字段列表，返回获取的实时数据的指标列表，只返回行情变动的指标列表，如 <code>Fields=[RT_OPEN,RT_LAST]</code>。</li><li><code>Times</code>：时间列表，返回获取数据的本地时间戳，如 <code>Times=[20170626 17:50:53]</code>。</li><li><code>Data</code>：数据列表，返回函数获取的实时行情数据，获取中国平安 “<a target="_blank" rel="noopener" href="http://601318.SH">601318.SH</a>” 的 “rt_last,rt_open” 指标订阅数据，<code>Data=[[54.16],[53.72]]</code>。</li></ul><h3 id="取消实时行情订阅函数-cancelrequest"><a class="markdownIt-Anchor" href="#取消实时行情订阅函数-cancelrequest"></a> 取消实时行情订阅函数 <code>CancelRequest</code></h3><p>函数 <code>w.cancelRequest(RequestID)</code> 用来根据 <code>w.wsq</code> 的订阅请求ID来取消订阅。</p><p><strong>参数说明</strong></p><table><thead><tr><th>参数</th><th>类型</th><th>可选</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>RequestID</td><td>int</td><td>否</td><td>无</td><td>输入取消订阅的订阅ID，支持取消单次订阅和全部订阅。支持格式：1 或 0。</td></tr></tbody></table><p><strong>注意事项</strong></p><ul><li>可以像 <code>w.cancelRequest(3)</code> 一样，输入一个 ID 的数字，来取消某订阅。</li><li>请求ID为0代表取消全部订阅，即输入 <code>w.cancelRequest(0)</code>。</li></ul><h3 id="示例用法-4"><a class="markdownIt-Anchor" href="#示例用法-4"></a> 示例用法</h3><p>以下是一个示例用法，用于订阅平安银行（<a target="_blank" rel="noopener" href="http://000001.SZ">000001.SZ</a>）的买卖盘数据：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">data = w.wsq(<span class="hljs-string">&quot;000001.SZ&quot;</span>, <span class="hljs-string">&quot;rt_last,rt_open&quot;</span>, func=DemoWSQCallback)<br><span class="hljs-comment"># 订阅</span><br><span class="hljs-comment"># 等待回调，用户可以根据实际情况写回调函数</span><br><span class="hljs-comment"># ...</span><br><span class="hljs-comment"># 根据刚才 wsq 返回的请求ID，取消订阅</span><br>w.cancelRequest(data.RequestID)<br></code></pre></td></tr></table></figure><p>在这个示例中，首先使用 <code>w.wsq</code> 订阅平安银行的买卖盘数据，包括最新价 (<code>rt_last</code>) 和开盘价 (<code>rt_open</code>)。然后等待回调函数获取实时数据，并最后根据 <code>wsq</code> 返回的请求ID来取消订阅。</p><h2 id="8-获取板块日序列数据函数wses"><a class="markdownIt-Anchor" href="#8-获取板块日序列数据函数wses"></a> 8. 获取板块日序列数据函数WSES</h2><p>函数 <code>w.wses</code> 用于获取沪深股票、香港股票、全球股票的板块的历史日序列数据，包括依据板块个股数据计算的板块日行情数据、基本面数据以及盈利预测数据等。</p><h3 id="参数说明-6"><a class="markdownIt-Anchor" href="#参数说明-6"></a> 参数说明</h3><table><thead><tr><th>参数</th><th>类型</th><th>可选</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>codes</td><td>str 或 list</td><td>否</td><td>无</td><td>支持获取单板块或多板块，如：“a001010100”、[“a001010200”, “a001010200”]。</td></tr><tr><td>fields</td><td>str</td><td>否</td><td>无</td><td>仅支持单指标，如 “sec_close_avg”。</td></tr><tr><td>beginTime</td><td>str</td><td>是</td><td>截止日期</td><td>为空默认为截止日期，如 “2016-01-01”、“20160101”、“2016/01/01”、“-5D”（当前日期前推5个交易日）、datetime/date 格式。</td></tr><tr><td>endTime</td><td>str</td><td>是</td><td>当前系统日期</td><td>如 “2016-01-05”、“20160105”、“2016/01/05”、“-2D”（当前日期前推2个交易日）、datetime/date 格式。</td></tr><tr><td>options</td><td>str</td><td>是</td><td>“”</td><td>options 以字符串的形式集成多个参数，具体参数见代码生成器。如果无相关参数设置，可以不给 <code>option</code> 赋值或使用 <code>options=&quot;&quot;</code>。</td></tr><tr><td>Fill</td><td>str</td><td>是</td><td>“Blank”</td><td>空值填充方式。参数值含义如下：“Previous”：沿用前值，“Blank”：返回空值。如果需要选择自设数值填充，在 options 添加 “ShowBlank=X”，其中 X 为自设数。</td></tr><tr><td>Period</td><td>str</td><td>是</td><td>“D”</td><td>取值周期。参数值含义如下：“D”：天，“W”：周，“M”：月，“Q”：季度，“S”：半年，“Y”：年。</td></tr><tr><td>Days</td><td>str</td><td>是</td><td>“Trading”</td><td>日期选项。参数值含义如下：“Weekdays”：工作日，“Alldays”：日历日，“Trading”：交易日。</td></tr><tr><td>TradingCalendar</td><td>str</td><td>是</td><td>“SSE”</td><td>交易日对应的交易所。参数含义如下：“SSE”：上海证券交易所，“SZSE”：深圳证券交易所，“CFFE”：中金所，“TWSE”：台湾证券交易所，“DCE”：大商所，“NYSE”：纽约证券交易所，“CZCE”：郑商所，“COMEX”：纽约金属交易所，“SHFE”：上期所，“NYBOT”：纽约期货交易所，“HKEX”：香港交易所，“CME”：芝加哥商业交易所，“Nasdaq”：纳斯达克证券交易所，“NYMEX”：纽约商品交易所，“CBOT”：芝加哥商品交易所，“LME”：伦敦金属交易所，“IPE”：伦敦国际石油交易所。</td></tr><tr><td>DynamicTime</td><td>str</td><td>是</td><td>“1”</td><td>“0”：使用板块历史成分，“1”：使用板块最新成分。</td></tr></tbody></table><h3 id="注意事项-5"><a class="markdownIt-Anchor" href="#注意事项-5"></a> 注意事项</h3><ul><li><code>wses</code> 函数一次性可选取多个板块一个指标来提取日期序列数据。</li><li><code>wses</code> 函数支持 Python 中的 date 或 datetime 时间格式。</li><li><code>wses</code> 函数支持输出 DataFrame 数据格式，需要函数添加参数 <code>usedf=True</code>。可以使用 <code>usedfdt=True</code> 来填充 DataFrame 输出 NaT 的日期。</li><li>板块名称或板块ID可通过板块查询工具查找。</li></ul><h3 id="返回说明-6"><a class="markdownIt-Anchor" href="#返回说明-6"></a> 返回说明</h3><p>如果不指定 <code>usedf=True</code>，该函数将返回一个 WindData 对象，包含以下成员：</p><ul><li><code>ErrorCode</code>：错误ID，返回代码运行错误码，ErrorCode=0 表示代码运行正常。若为其他值则需查找错误原因。</li><li><code>Data</code>：数据列表，比如读取上证A股和深证A股近两日的平均收盘价 “sec_close_avg” 指标</li></ul><p>数据，返回值为 Data=[[13.00764,13.31552],[12.88665,13.19833]]。</p><ul><li><code>Codes</code>：证券代码列表，返回获取数据的板块ID，如 Codes=[a001010200000000, a001010300000000]。</li><li><code>Field</code>：指标列表，返回获取数据的指标列表，如 Fields=[sec_close_avg]。</li><li><code>Times</code>：时间列表，返回获取数据的日期序列，如 Times=[20180828]。</li></ul><h3 id="示例用法-5"><a class="markdownIt-Anchor" href="#示例用法-5"></a> 示例用法</h3><p>以下是一个示例用法，用于提取上证A股和深证A股的当日平均收盘价信息：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">errorCode, data = w.wses(<span class="hljs-string">&quot;a001010200000000,a001010100000000&quot;</span>, <span class="hljs-string">&quot;sec_close_avg&quot;</span>, <span class="hljs-string">&quot;2018-08-21&quot;</span>, <span class="hljs-string">&quot;2018-08-27&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, usedf=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure><p>在这个示例中，首先使用 <code>w.wses</code> 函数提取了上证A股和深证A股的板块数据，包括 “sec_close_avg” 指标，日期范围为 “2018-08-21” 到 “2018-08-27”。最后，将结果存储在 DataFrame 中。</p><h2 id="9-获取板块日截面数据函数wsee"><a class="markdownIt-Anchor" href="#9-获取板块日截面数据函数wsee"></a> 9. 获取板块日截面数据函数WSEE</h2><p>函数 <code>w.wsee</code> 用于获取沪深股票、香港股票、全球股票的板块的历史日序列数据，包括依据板块个股数据计算的板块日行情数据、基本面数据以及盈利预测数据等。</p><h3 id="参数说明-7"><a class="markdownIt-Anchor" href="#参数说明-7"></a> 参数说明</h3><table><thead><tr><th>参数</th><th>类型</th><th>可选</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>codes</td><td>str 或 list</td><td>否</td><td>无</td><td>支持获取单板块或多板块，如：“a001010100”、[“a001010200”, “a001010200”]。</td></tr><tr><td>fields</td><td>str</td><td>否</td><td>无</td><td>仅支持单指标，如 “sec_close_avg”。</td></tr><tr><td>options</td><td>str</td><td>是</td><td>“”</td><td>options 以字符串的形式集成多个参数，具体参数见代码生成器。如果无相关参数设置，可以不给 <code>option</code> 赋值或使用 <code>options=&quot;&quot;</code>。</td></tr><tr><td>DynamicTime</td><td>str</td><td>是</td><td>“1”</td><td>“0”：使用板块历史成分，“1”：使用板块最新成分。</td></tr></tbody></table><h3 id="注意事项-6"><a class="markdownIt-Anchor" href="#注意事项-6"></a> 注意事项</h3><ul><li><code>wsee</code> 函数一次只能提取一个交易日数据，但可以提取多个板块和多个指标。</li><li><code>wsee</code> 函数可选参数有很多，例如 <code>unit</code>、<code>currencyType</code> 等可借助代码生成器获取。</li><li><code>wsee</code> 函数支持输出 DataFrame 数据格式，需要函数添加参数 <code>usedf=True</code>。可以使用 <code>usedfdt=True</code> 来填充 DataFrame 输出 NaT 的日期。</li><li>板块名称或板块ID可通过板块查询工具查找。</li></ul><h3 id="返回说明-7"><a class="markdownIt-Anchor" href="#返回说明-7"></a> 返回说明</h3><p>如果不指定 <code>usedf=True</code>，该函数将返回一个 WindData 对象，包含以下成员：</p><ul><li><code>ErrorCode</code>：错误ID，返回代码运行错误码，ErrorCode=0 表示代码运行正常。若为其他值则需查找错误原因。</li><li><code>Data</code>：数据列表，比如读取上证A股和深证A股近两日的平均收盘价 “sec_close_avg” 指标数据，返回值为 Data=[[13.00764,13.31552],[12.88665,13.19833]]。</li><li><code>Codes</code>：证券代码列表，返回获取数据的板块ID，如 Codes=[a001010200000000, a001010300000000]。</li><li><code>Field</code>：指标列表，返回获取数据的指标列表，如 Fields=[sec_close_avg]。</li><li><code>Times</code>：时间列表，返回获取数据的日期序列，如 Times=[20180828]。</li></ul><h3 id="示例用法-6"><a class="markdownIt-Anchor" href="#示例用法-6"></a> 示例用法</h3><p>以下是一个示例用法，用于提取上证A股和深证A股的当日平均收盘价信息：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">errorCode, data = w.wsee(<span class="hljs-string">&quot;a001010200000000,a001010300000000&quot;</span>, <span class="hljs-string">&quot;sec_close_avg&quot;</span>, <span class="hljs-string">&quot;tradeDate=20180827&quot;</span>, usedf=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure><p>在这个示例中，首先使用 <code>w.wsee</code> 函数提取了上证A股和深证A股的板块数据，包括 “sec_close_avg” 指标，日期为 “20180827”。最后，将结果存储在 DataFrame 中。</p><h2 id="10获取报表数据函数wset"><a class="markdownIt-Anchor" href="#10获取报表数据函数wset"></a> 10.获取报表数据函数WSET</h2><p>函数 <code>w.wset</code> 用于获取数据集信息，包括板块成分、指数成分、ETF申赎成分信息、分级基金明细、融资标的、融券标的、融资融券担保品、回购担保品、停牌股票、复牌股票、分红送转等报表数据。</p><h3 id="参数说明-8"><a class="markdownIt-Anchor" href="#参数说明-8"></a> 参数说明</h3><table><thead><tr><th>参数</th><th>类型</th><th>可选</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>tableName</td><td>str</td><td>否</td><td>无</td><td>输入获取数据的报表名称，可借助代码生成器生成，如：“SectorConstituent”。</td></tr><tr><td>options</td><td>str</td><td>是</td><td>“”</td><td>options 以字符串的形式集成多个参数，具体参数见代码生成器。如果无相关参数设置，可以不给 <code>option</code> 赋值或使用 <code>options=&quot;&quot;</code>。</td></tr></tbody></table><h3 id="注意事项-7"><a class="markdownIt-Anchor" href="#注意事项-7"></a> 注意事项</h3><ul><li>数据集涉及内容较多，每个报表名称均不同，建议使用代码生成器生成代码以更方便地获取数据。</li><li><code>wset</code> 函数支持输出 DataFrame 数据格式，需要函数添加参数 <code>usedf=True</code>。可以使用 <code>usedfdt=True</code> 来填充 DataFrame 输出 NaT 的日期。</li></ul><h3 id="返回说明-8"><a class="markdownIt-Anchor" href="#返回说明-8"></a> 返回说明</h3><p>如果不指定 <code>usedf=True</code>，该函数将返回一个 WindData 对象，包含以下成员：</p><ul><li><code>ErrorCode</code>：错误ID，返回代码运行错误码，ErrorCode=0 表示代码运行正常。若为其他值则需查找错误原因。</li><li><code>Data</code>：数据列表，比如读取全部A股2018-08-27的板块成分，返回值为 Data=[[2018-08-27, 2018-08-27,…], [<a target="_blank" rel="noopener" href="http://000001.SZ">000001.SZ</a>, <a target="_blank" rel="noopener" href="http://000002.SZ">000002.SZ</a>,…], [平安银行, 万科A,…]]。</li><li><code>Codes</code>：证券代码列表，返回获取数据的板块ID，如 Codes=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10,…]。</li><li><code>Field</code>：指标列表，返回获取数据的指标列表，如 Fields=[date, wind_code, sec_name]。</li><li><code>Times</code>：时间列表，返回获取数据的日期序列，如 Times=[20180828]。</li></ul><h3 id="示例用法-7"><a class="markdownIt-Anchor" href="#示例用法-7"></a> 示例用法</h3><p>以下是一个示例用法，用于获取申万一级行业的成分股：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">sw_index = w.wset(<span class="hljs-string">&quot;sectorconstituent&quot;</span>, <span class="hljs-string">&quot;date=2018-06-12;sectorid=a39901011g000000&quot;</span>, usedf=<span class="hljs-literal">True</span>)<br>sw_index[<span class="hljs-number">1</span>].head(<span class="hljs-number">5</span>)<br></code></pre></td></tr></table></figure><p>在这个示例中，首先使用 <code>w.wset</code> 函数提取了申万一级行业的成分股信息，日期为 “2018-06-12”，板块ID为 “a39901011g000000”。然后，将结果存储在 DataFrame 中并显示前5行。</p><h2 id="11推荐的使用场景"><a class="markdownIt-Anchor" href="#11推荐的使用场景"></a> 11.推荐的使用场景</h2><p>以下是对这些函数的异同点以及推荐的使用场景的概述：</p><p><strong>异同点：</strong></p><ol><li><p><strong>数据类型</strong>：</p><ul><li>WSD、WSS、WSI、WST、WSES、WSEE、WSET 这些函数都用于获取不同类型的金融数据，包括历史数据、实时数据、板块数据、报表数据等。</li></ul></li><li><p><strong>数据频率</strong>：</p><ul><li>WSD、WSS、WSI、WST 用于获取不同频率的历史数据，包括日线、分钟线、tick 数据等。</li><li>WSQ 用于获取实时数据。</li><li>WSES 和 WSEE 用于获取板块数据。</li><li>WSET 用于获取报表数据。</li></ul></li><li><p><strong>数据源</strong>：</p><ul><li>这些函数都可以用于获取 Wind 数据源的数据。</li></ul></li></ol><p>具体的使用场景总结如下：</p><ol><li><p><strong>WSD - 获取日时间序列数据</strong>：</p><ul><li>适用于获取单个或多个证券的历史时间序列数据，如股价、成交量等。常用于分析历史趋势和生成图表。</li></ul></li><li><p><strong>WSS - 获取日截面数据</strong>：</p><ul><li>用于获取单个或多个证券在某个交易日的截面数据，如市值、市盈率等。常用于研究单日市场快照情况。</li></ul></li><li><p><strong>WSI - 获取分钟序列数据</strong>：</p><ul><li>用于获取单个或多个证券的分钟级别数据，可用于高频交易分析、图表生成等。</li></ul></li><li><p><strong>WST - 获取日内 tick 数据</strong>：</p><ul><li>用于获取单个或多个证券的日内交易 tick 数据，适用于日内交易策略和市场微观结构研究。</li></ul></li><li><p><strong>WSQ - 实时行情数据</strong>：</p><ul><li>用于获取股票、债券、基金等证券品种的实时行情数据，适用于需要实时监控市场的场景，如实时报价、风险管理等。</li></ul></li><li><p><strong>WSES - 获取板块日序列数据</strong>：</p><ul><li>用于获取板块（如申万一级行业板块）的历史时间序列数据，可用于板块分析、行业研究等。</li></ul></li><li><p><strong>WSEE - 获取板块日截面数据</strong>：</p><ul><li>用于获取板块在某个交易日的截面数据，如板块成分股等。适用于研究板块的单日情况。</li></ul></li><li><p><strong>WSET - 获取报表数据</strong>：</p><ul><li>用于获取各种报表数据，如板块成分、指数成分、分级基金明细、分红送转等。适用于查询金融报表数据。</li></ul></li></ol></div><hr><div><div class="post-metas my-3"></div><div class="license-box my-3"><div class="license-title"><div>WindPy接口手册</div><div>https://fulequn.github.io/2023/09/Article202309114/</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>Fulequn</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2023年9月11日</div></div><div class="license-meta-item"><div>许可协议</div><div><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/2023/09/Article202309115/" title="理解股票和债券价格调整方法：前复权、后复权和目标调整"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">理解股票和债券价格调整方法：前复权、后复权和目标调整</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/2023/09/Article202309113/" title="大型公司内网机、摆渡系统和堡垒机功能与配置方法"><span class="hidden-mobile">大型公司内网机、摆渡系统和堡垒机功能与配置方法</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>目录</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t,e){var i=Fluid.plugins.typing,n=e.getElementById("subtitle");n&&i&&i(n.getAttribute("data-typed-text"))}(window,document)</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js",(function(){var t=jQuery("#toc");if(0!==t.length&&window.tocbot){var i=jQuery("#board-ctn").offset().top;window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-i},CONFIG.toc)),t.find(".toc-list-item").length>0&&t.css("visibility","visible"),Fluid.events.registerRefreshCallback((function(){if("tocbot"in window){tocbot.refresh();var t=jQuery("#toc");if(0===t.length||!tocbot)return;t.find(".toc-list-item").length>0&&t.css("visibility","visible")}}))}}))</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",(function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback((function(){if("anchors"in window){anchors.removeAll();var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}}))}))</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",(function(){Fluid.plugins.fancyBox()}))</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>