<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png"><link rel="icon" href="/img/favicon.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="Fulequn"><meta name="keywords" content=""><meta name="description" content="原文链接: https:&#x2F;&#x2F;jijunhao.github.io&#x2F;2023&#x2F;03&#x2F;13&#x2F;article20230313&#x2F;#alipay 参考文献 ChatGPT ChatGPT的api管理平套 ChatGPT Mirai QQ Bot mirai无法登录的临时解决方案 mirai临时登录协议修复插件 go-cqhttp go-cqhttp扫码登陆解决方案   QQ机器人——接入ChatGPT"><meta property="og:type" content="article"><meta property="og:title" content="将ChatGPT接入QQ机器人"><meta property="og:url" content="https://fulequn.github.io/2023/03/Article202303181/index.html"><meta property="og:site_name" content="FuLeQun&#39;s Blog"><meta property="og:description" content="原文链接: https:&#x2F;&#x2F;jijunhao.github.io&#x2F;2023&#x2F;03&#x2F;13&#x2F;article20230313&#x2F;#alipay 参考文献 ChatGPT ChatGPT的api管理平套 ChatGPT Mirai QQ Bot mirai无法登录的临时解决方案 mirai临时登录协议修复插件 go-cqhttp go-cqhttp扫码登陆解决方案   QQ机器人——接入ChatGPT"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://blog-1314109265.cos.ap-nanjing.myqcloud.com/202303131929437.png"><meta property="og:image" content="https://blog-1314109265.cos.ap-nanjing.myqcloud.com/202303132001567.png"><meta property="og:image" content="https://blog-1314109265.cos.ap-nanjing.myqcloud.com/202303132001474.png"><meta property="article:published_time" content="2023-03-18T06:10:09.000Z"><meta property="article:modified_time" content="2024-05-30T00:16:48.000Z"><meta property="article:author" content="Fulequn"><meta property="article:tag" content="ChatGPT"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://blog-1314109265.cos.ap-nanjing.myqcloud.com/202303131929437.png"><title>将ChatGPT接入QQ机器人 - FuLeQun&#39;s Blog</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var CONFIG={hostname:"fulequn.github.io",root:"/",version:"1.9.7",typing:{enable:!0,typeSpeed:60,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!1,follow_dnt:!0,baidu:null,google:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1},gtag:null,tajs:null},search_path:"/local-search.xml",include_content_in_search:!0};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css"><meta name="generator" content="Hexo 7.3.0"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>FuLeQun&#39;s Blog</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/" target="_self"><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/" target="_self"><i class="iconfont icon-archive-fill"></i> <span>归档</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/" target="_self"><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/" target="_self"><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class="nav-item"><a class="nav-link" href="/about/" target="_self"><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/default.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="将ChatGPT接入QQ机器人"></span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2023-03-18 14:10" pubdate>2023年3月18日 下午</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i>5.5k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i>46 分钟</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 id="seo-header">将ChatGPT接入QQ机器人</h1><div class="markdown-body"><blockquote><p>原文链接: <a target="_blank" rel="noopener" href="https://jijunhao.github.io/2023/03/13/article20230313/#alipay">https://jijunhao.github.io/2023/03/13/article20230313/#alipay</a></p><p><strong>参考文献</strong></p><p><a target="_blank" rel="noopener" href="https://chat.openai.com/">ChatGPT</a></p><p><a target="_blank" rel="noopener" href="https://platform.openai.com/account/api-keys">ChatGPT的api管理平套</a></p><p><a target="_blank" rel="noopener" href="https://github.com/lss233/chatgpt-mirai-qq-bot">ChatGPT Mirai QQ Bot</a></p><p><a target="_blank" rel="noopener" href="https://mirai.mamoe.net/topic/223/%E6%97%A0%E6%B3%95%E7%99%BB%E5%BD%95%E7%9A%84%E4%B8%B4%E6%97%B6%E5%A4%84%E7%90%86%E6%96%B9%E6%A1%88">mirai无法登录的临时解决方案</a></p><p><a target="_blank" rel="noopener" href="https://github.com/cssxsh/fix-protocol-version">mirai临时登录协议修复插件</a></p><p><a target="_blank" rel="noopener" href="https://github.com/Mrs4s/go-cqhttp">go-cqhttp</a></p><p><a target="_blank" rel="noopener" href="https://github.com/lss233/chatgpt-mirai-qq-bot/issues/311">go-cqhttp扫码登陆解决方案</a></p></blockquote><h1 id="qq机器人接入chatgpt"><a class="markdownIt-Anchor" href="#qq机器人接入chatgpt"></a> QQ机器人——接入ChatGPT</h1><h2 id="chatgpt简介"><a class="markdownIt-Anchor" href="#chatgpt简介"></a> ChatGPT简介</h2><p><code>ChatGPT</code> 是一种基于人工智能的对话机器人，使用了深度学习技术和自然语言处理技术进行训练和优化。<code>ChatGPT</code> 能够通过和用户的对话来回答各种各样的问题、解决问题和提供建议，支持多种语言和主题，可以用于各种不同的应用领域，如教育、客户服务、娱乐、医疗保健等。由于它可以从数百万条对话中学习并自我改进，因此越来越受欢迎。</p><ul><li><strong>对话</strong>：ChatGPT能够进行普通的聊天对话，并且可以回答一些简单的问题，例如天气、时间等。</li><li><strong>知识问答</strong>：ChatGPT拥有广泛的知识库，可以回答各种问题，例如历史事件、科学知识、地理信息等。</li><li><strong>文本生成</strong>：ChatGPT可以生成各种形式的文本，例如诗歌、小说、新闻报道、文书、代码等。</li><li><strong>语言翻译</strong>：ChatGPT可以进行语言翻译，支持多种语言之间的互译。</li><li><strong>文本分类</strong>：ChatGPT可以将文本进行分类，例如将新闻分类为体育、政治、娱乐等。</li><li><strong>信息检索</strong>：ChatGPT可以根据关键词和上下文进行信息检索，返回相关的结果。</li><li>……</li></ul><p><code>ChatGPT</code> 能够回答各种类型的问题，例如代码生成、Excel 的操作命令、生活小常识、论文写作和翻译等。但对于普通用户来说使用 <code>ChatGPT</code> 的门槛很高，首先得想办法连接外网，其次还得注册官方的账号，最好还得有基础和条件的搭建一个 QQ 机器人。日常生活中想要更加方便的使用 <code>ChatGPT</code>，随时随地的沟通和解决问题，当然是将其设置成微信聊天机器人、QQ 聊天机器人、钉钉机器人、Telegram 机器人等。但一般不建议使用微信机器人，微信与个人信息绑定极为紧密，一个手机号一个身份证只能注册一个微信，并且还有微信钱包等功能，若涉及一些危险言论导致封号，那将是无法挽回的损失。下面给出一个比较优秀的 QQ机器人部署方案。</p><blockquote><p><strong>注</strong>：针对不同人群，每个人都应该有属于自己的使用方案。</p><ul><li>没有 ChatGPT 账号的且不具备软硬件条件的人，仅需要加入已经搭建好的 QQ 机器人群就能使用，但需谨防上当受骗</li><li>拥有 ChatGPT 账号的，请安装 <a target="_blank" rel="noopener" href="https://github.com/lencx/ChatGPT">ChatGPT桌面版</a>，该方案能够便利的在桌面启动和刷新 ChatGPT，并且拥有聊天记录保存和切换AI等多项功能</li><li>有一定代码基础和硬件条件的，熟悉docker、python等常用开发工具的人，可以选择自己搭建一个 QQ 机器人，便利自己且供身边的人使用</li></ul><p>！！无论是哪种方式，使用 <code>ChatGPT</code> 时都要遵守法律法规和相关规定，不得进行危害社会稳定、违反公序良俗的言论和行为。</p></blockquote><h2 id="1-前提准备"><a class="markdownIt-Anchor" href="#1-前提准备"></a> 1. 前提准备</h2><ul><li>需要一个官网注册的，能够正常访问网页的 <code>OpenAI账号</code></li><li>需要一个能够正常交流的 <code>QQ号</code>，建议用小号。（每个手机号可以注册多个QQ）</li><li>需要一台 <code>Linux服务器</code> 或者一台 <code>Windows服务器</code></li><li>如果处于国内，需要一个翻墙工具（例如 <code>Clash</code>、<code>V2ray</code> 等）或者部署在境外的服务器</li></ul><h2 id="2-软件包下载"><a class="markdownIt-Anchor" href="#2-软件包下载"></a> 2. 软件包下载</h2><p><code>chatgpt-mirai-qq-bot</code> 在 <code>github</code> 上已经进行开源，支持在 <code>Liunx</code> 和 <code>window</code> 上部署。</p><p>请进入项目的<a target="_blank" rel="noopener" href="https://github.com/lss233/chatgpt-mirai-qq-bot/releases">Releases</a>下载<strong>最新版</strong>的windows-quickstart安装包或者使用<strong>最新版</strong>的linux一键部署。</p><p><img src="https://blog-1314109265.cos.ap-nanjing.myqcloud.com/202303131929437.png" srcset="/img/loading.gif" lazyload alt="img"></p><blockquote><p><strong>注</strong>：GitHub Release 是一个功能，用于发布和分发软件或项目的版本和发布包，一般来说只需要下载最新版的即可。</p></blockquote><h2 id="3-windows下快速部署"><a class="markdownIt-Anchor" href="#3-windows下快速部署"></a> 3. Windows下快速部署</h2><blockquote><p>作为一个 AI 模型，ChatGPT 并不会直接连接到 QQ 平台发消息。相反，需要借助一些中间软件来实现与 QQ 的通信，如 Mirai 或 Onebot。</p><p>以下是一般情况下连接 ChatGPT 和 QQ 的基本流程：</p><ol><li>初始化：首先需要准备好两个环境，即 Mirai 或 Onebot 的环境和 ChatGPT 的环境。在 Mirai 或 Onebot 环境中，需要安装好对应的插件（例如 Mirai-HTTP 和 Mirai-WebSocket）以及配置文件等。在这个项目中，只需要点击<code>初始化.cmd</code>即可</li><li>配置登录信息：需要编辑配置文件 <code>chatgpt/config.cfg</code>，设置 QQ 号码、密码等登录信息和OpenAI等信息。</li><li>启动 <code>Mirai</code> 或 <code>Onebot</code>：通过命令行启动 Mirai 或 Onebot，使其运行在后台。这样 ChatGPT 就能够通过 API 访问 Mirai 或 Onebot 提供的 QQ 服务了。</li><li>启动 <code>ChatGPT</code>：在 ChatGPT 的环境中，需要编写代码来实现与 Mirai 或 Onebot 的通信。可以使用相应的 SDK 或 API，如 QQbot-sdk 或者 cqhttp-sdk。Mirai 和 chatgpt-mirai-qq-bot 之间则使用 Websocket 进行通信，将两者连接起来。在这个项目里这些都是设定好的。</li><li>连接 QQ 发消息：使用 ChatGPT 的 API，调用 Mirai 或 Onebot 的接口来连接到 QQ 并发送消息。</li></ol><p>需要注意的是，这只是一个基本流程，实际应用中可能还需要进行更多的设置和配置。此外，还需要保证 Mirai 或 Onebot 的稳定性和安全性，防止出现一些不必要的问题。</p></blockquote><p>本地解压下载好的安装包后，会有<code>chagpt</code>、<code>files</code>、<code>mirai</code>和<code>初始化.cmd</code>。双击其中的 <code>初始化.cmd</code> 进行环境初始化，一路回车，期间会跳出来一个<code>conifg.cfg</code>文件，可以直接修改也可以后期修改（在<code>chatgpt/config.cfg</code>里面）</p><h3 id="31-配置文件完整介绍"><a class="markdownIt-Anchor" href="#31-配置文件完整介绍"></a> 3.1 配置文件完整介绍</h3><p>配置文件主要包含 <code>onebot连接信息</code>、<code>mirai连接信息</code>和 <code>OpenAI登录信息</code>三大部分。</p><blockquote><p>**注：**onebot 和 mirai 只要填写一个机器人就行，另一个用#全部注释</p></blockquote><ul><li><code>onebot连接信息</code>（使用的是 <code>go-cqhttp</code> 的扫码登录方式，但 QQ 发送图片会出现bug）</li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs yaml">[<span class="hljs-string">onebot</span>]<br><span class="hljs-comment"># onebot 相关设置</span><br><span class="hljs-string">qq=请修改为你机器人的QQ号</span><br><span class="hljs-string">manager_qq</span> <span class="hljs-string">=</span> <span class="hljs-string">请修改为机器人管理员的QQ号</span><br><span class="hljs-comment"># 此处的  reverse_ws_host 和 reverse_ws_port 对应</span><br><span class="hljs-comment"># go-cqhttp 中的 反向WS Universal 地址，如：ws://localhost:6555/ws</span><br><span class="hljs-string">reverse_ws_host</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;localhost&quot;</span><br><span class="hljs-string">reverse_ws_port</span> <span class="hljs-string">=</span> <span class="hljs-number">6555</span><br></code></pre></td></tr></table></figure><ul><li><code>mirai连接信息</code></li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs yaml">[<span class="hljs-string">mirai</span>]<br><span class="hljs-comment"># Mirai 相关设置</span><br><span class="hljs-string">qq</span> <span class="hljs-string">=</span> <span class="hljs-string">请填写机器人的</span> <span class="hljs-string">QQ</span> <span class="hljs-string">号</span><br><span class="hljs-string">manager_qq</span> <span class="hljs-string">=</span> <span class="hljs-string">请修改为机器人管理员的QQ号</span><br><br><span class="hljs-string">api_key</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;1234567890&quot;</span> <span class="hljs-comment"># mirai-http-api 中的 verifyKey </span><br><span class="hljs-string">reverse_ws_host</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;0.0.0.0&quot;</span>   <span class="hljs-comment"># 0.0.0.0指任意ip</span><br><span class="hljs-string">reverse_ws_port</span> <span class="hljs-string">=</span> <span class="hljs-number">8554</span><br><br><span class="hljs-comment"># # 下面是 mirai api http 正向连接模式</span><br><span class="hljs-comment"># 使用此模式时需注释上面的反向连接模式 </span><br><span class="hljs-comment"># 要么http+ws要么直接反代reverse_w,建议用反代</span><br><span class="hljs-comment"># http_url = &quot;http://localhost:8080&quot;</span><br><span class="hljs-comment"># ws_url = &quot;http://localhost:8080&quot;</span><br></code></pre></td></tr></table></figure><ul><li><code>OpenAI登录信息</code></li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs yaml">[<span class="hljs-string">openai</span>]<br><span class="hljs-comment"># OpenAI 相关设置</span><br><br><span class="hljs-comment"># 第 1 个 OpenAI 账号的登录信息</span><br>[[<span class="hljs-string">openai.accounts</span>]]<br><span class="hljs-comment"># 里面是一些设置</span><br><br><span class="hljs-comment"># 第 2 个 OpenAI 账号的登录信息</span><br>[[<span class="hljs-string">openai.accounts</span>]]<br><span class="hljs-comment"># 里面是一些设置</span><br><br><span class="hljs-comment"># 第 3 个 OpenAI 账号的登录信息</span><br>[[<span class="hljs-string">openai.accounts</span>]]<br><span class="hljs-comment"># 里面是一些设置</span><br></code></pre></td></tr></table></figure><h4 id="311-openai-多账号支持"><a class="markdownIt-Anchor" href="#311-openai-多账号支持"></a> 3.1.1 OpenAI 多账号支持</h4><p>可以登录多个不同的 OpenAI 账号，当机器人开始产生新对话时，会从你登录的账号中选择<strong>一个</strong>来使用 ChatGPT 和用户聊天。</p><p>（这可以降低聊天频率限制出现的概率）</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs yaml">[<span class="hljs-string">openai</span>]<br><span class="hljs-comment"># OpenAI 相关设置</span><br><br><span class="hljs-comment"># 第 1 个 OpenAI 账号的登录信息</span><br>[[<span class="hljs-string">openai.accounts</span>]]<br><span class="hljs-comment"># 里面是一些设置</span><br><br><span class="hljs-comment"># 第 2 个 OpenAI 账号的登录信息</span><br>[[<span class="hljs-string">openai.accounts</span>]]<br><span class="hljs-comment"># 里面是一些设置</span><br><br><span class="hljs-comment"># 第 3 个 OpenAI 账号的登录信息</span><br>[[<span class="hljs-string">openai.accounts</span>]]<br><span class="hljs-comment"># 里面是一些设置</span><br></code></pre></td></tr></table></figure><h4 id="312-openai的设置主要是无浏览器模式的接入点设置不建议使用web"><a class="markdownIt-Anchor" href="#312-openai的设置主要是无浏览器模式的接入点设置不建议使用web"></a> 3.1.2 OpenAI的设置（主要是无浏览器模式的接入点设置，不建议使用Web）</h4><p>2023年3月封禁了大量账户，建议不要用WEB，尽量都使用自己的API。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs yaml">[<span class="hljs-string">openai</span>]<br><span class="hljs-comment"># OpenAI 相关设置</span><br><span class="hljs-comment"># 自定义 ChatGPT 的 browserless 接入点</span><br><span class="hljs-comment"># 自 3月9日 开始，不设置此项将无法正常使用 browserless 模式下的网页版 ChatGPT</span><br><span class="hljs-comment"># browser模式没法用，browserless要endpoint，如果有可以选择自定义</span><br><span class="hljs-string">browserless_endpoint</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;https://bypass.duti.tech/&quot;</span><br><br><span class="hljs-comment"># 自定义 OpenAI 的 API 接口基础地址</span><br><span class="hljs-comment"># 通过此功能，你可以搭建一个 OpenAI 的反向代理来避免网络问题</span><br><span class="hljs-comment"># 例如此项目：https://github.com/Ice-Hazymoon/openai-scf-proxy</span><br><span class="hljs-comment"># api_endpoint = &quot;https://api.openai.com/v1&quot;</span><br></code></pre></td></tr></table></figure><h4 id="313-账号登录模式选择"><a class="markdownIt-Anchor" href="#313-账号登录模式选择"></a> 3.1.3 账号登录模式选择</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml">[[<span class="hljs-string">openai.accounts</span>]]<br><span class="hljs-comment"># 模式选择</span><br><span class="hljs-string">mode</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;browserless&quot;</span><br></code></pre></td></tr></table></figure><p>支持的模式有：</p><ul><li>browser - 浏览器登录。该模式会在你的电脑上启动一个 Chrome 浏览器来登录并验证 OpenAI，该模式成功率较低。</li><li>browserless - 无浏览器模式。该模式将你的<strong>聊天请求</strong>发送到第三方服务器进行认证，从而不需要浏览器，该模式成功率较高。（推荐）</li></ul><h4 id="314-邮箱密码登录"><a class="markdownIt-Anchor" href="#314-邮箱密码登录"></a> 3.1.4 邮箱密码登录</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml">[[<span class="hljs-string">openai.accounts</span>]]<br><span class="hljs-comment"># 你的 OpenAI 邮箱</span><br><span class="hljs-string">email</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;xxxx&quot;</span> <br><span class="hljs-comment"># 你的 OpenAI 密码</span><br><span class="hljs-string">password</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;xxx&quot;</span><br></code></pre></td></tr></table></figure><h4 id="315-session_token-登录"><a class="markdownIt-Anchor" href="#315-session_token-登录"></a> 3.1.5 session_token 登录</h4><p>对于通过 Google 登录或者微软登录的同学，可以使用 session_token 方式进行登录。使用这种方式登录时不需要填写<strong>密码</strong>。</p><p>需要注意的是，session_token 过期比较频繁，过期后需要重新设置。</p><p>session_token 的获取方式可参考：<a target="_blank" rel="noopener" href="https://github.com/lss233/chatgpt-mirai-qq-bot/issues/96">请问怎么获取 session_token</a></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml">[[<span class="hljs-string">openai.accounts</span>]]<br><br><span class="hljs-string">session_token</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;一串 ey 开头的东西&quot;</span><br><span class="hljs-string">email</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;你的邮箱&quot;</span><br></code></pre></td></tr></table></figure><h4 id="316-access_token-登录"><a class="markdownIt-Anchor" href="#316-access_token-登录"></a> 3.1.6 access_token 登录</h4><p>配合 <code>mode=&quot;browserless&quot;</code>使用，这种方式登录时不需要填写邮箱和密码、session_token。<br>这种方法比较适合登录时出现 Unknown error,或者回答问题时出现有关 Access Token报错的情况。<br>你需要自己登录 OpenAI 网站，然后访问 <a target="_blank" rel="noopener" href="https://chat.openai.com/api/auth/session">https://chat.openai.com/api/auth/session</a> ，你可以看到一段类似下面的代码：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>	<span class="hljs-attr">&quot;user&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>		<span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;user-*****&quot;</span><span class="hljs-punctuation">,</span><br>		<span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;***&quot;</span><span class="hljs-punctuation">,</span><br>		<span class="hljs-attr">&quot;email&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;***&quot;</span><span class="hljs-punctuation">,</span><br>		<span class="hljs-attr">&quot;image&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;***&quot;</span><span class="hljs-punctuation">,</span><br>		<span class="hljs-attr">&quot;picture&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;***&quot;</span><span class="hljs-punctuation">,</span><br>		<span class="hljs-attr">&quot;groups&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><br>	<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>	<span class="hljs-attr">&quot;expires&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2023-03-18T09:11:03.546Z&quot;</span><span class="hljs-punctuation">,</span><br>	<span class="hljs-attr">&quot;accessToken&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;eyJhbGciOiJS*****X7GdA&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>获取以上 JSON 中<code>accessToken</code> 后面的值即可，有效期在 30 天左右。过期后需要重新设置。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yaml">[[<span class="hljs-string">openai.accounts</span>]]<br><span class="hljs-string">access_token</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;一串内容为 eyJhbGciOiJS*****X7GdA 的东西&quot;</span><br></code></pre></td></tr></table></figure><h4 id="317-使用正向代理国内搭建的记得开代理"><a class="markdownIt-Anchor" href="#317-使用正向代理国内搭建的记得开代理"></a> 3.1.7 使用正向代理（国内搭建的记得开代理）</h4><p>如果你的网络访问 OpenAI 出现一直弹浏览器的问题，或者你的 IP 被封锁了，可以通过配置代理的方式来连接到 OpenAI。</p><p>支持使用正向代理方式访问 OpenAI，你需要一个 HTTP/HTTPS 代理服务器：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs yaml">[[<span class="hljs-string">openai.accounts</span>]]<br><br><span class="hljs-comment"># 请注意，由于现在 OpenAI 封锁严格，你需要一个</span><br><span class="hljs-comment"># 尽量使用独立的代理服务器，不要使用和其他人共用 IP 的代理</span><br><span class="hljs-comment"># 否则会出现无限弹出浏览器的问题</span><br><span class="hljs-comment"># 在账号下面加入</span><br><br><span class="hljs-string">proxy=&quot;http://127.0.0.1:1080&quot;</span><br></code></pre></td></tr></table></figure><h4 id="318-对话标题自动重命名"><a class="markdownIt-Anchor" href="#318-对话标题自动重命名"></a> 3.1.8 对话标题自动重命名</h4><p>如果你的账号产生了太多的对话，看着不舒服，可以开启配置文件中的标题自动重命名和。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml">[[<span class="hljs-string">openai.accounts</span>]]<br><span class="hljs-comment"># 在账号下面加入</span><br><br><span class="hljs-string">title_pattern=&quot;qq-&#123;session_id&#125;&quot;</span><br></code></pre></td></tr></table></figure><p>当你按照这个格式进行设置之后，新创建的对话将会以 <code>qq-friend-好友QQ</code> 或 <code>qq-group-群号</code> 进行命名。</p><p>这里的 <code>&#123;session_id&#125;</code> 是一个变量，它在程序启动之后会根据聊天信息的发送者动态变化。</p><ul><li>如果是一个好友给机器人发送消息，则 <code>&#123;session_id&#125;</code> 会变成 <code>qq-friend-好友QQ</code></li><li>如果是一个群聊给机器人发送消息，则 <code>&#123;session_id&#125;</code> 会变成 <code>qq-group-群号</code></li></ul><h4 id="319-其他功能自行探索"><a class="markdownIt-Anchor" href="#319-其他功能自行探索"></a> 3.1.9 其他功能自行探索</h4><ul><li>管理员命令</li><li>预设加载</li><li>接入new bing</li><li>……</li></ul><h3 id="32-启动mirai"><a class="markdownIt-Anchor" href="#32-启动mirai"></a> 3.2 启动Mirai</h3><p><strong>简介：</strong><code>Mirai</code>是一个基于Java开发的聊天机器人框架，最初是为QQ平台开发的，但现在也支持其他平台（如微信和Telegram）。Mirai提供了许多插件，如定时发送消息、自动回复、群管理等等，使得开发者可以轻松地定制自己的聊天机器人。</p><p>使用步骤：</p><ul><li>点击 <code>Mirai.cmd</code>，第一次启动会下载很多环境，无需理会。<strong>这个脚本主要用来登录 <code>QQ</code> 机器人账号的</strong></li><li>登录机器人命令：<code>login &lt;机器人QQ账号&gt; &lt;机器人QQ密码&gt; &lt;登录协议&gt;</code></li></ul><blockquote><p>**注：**目前的登录协议有ANDROID_PHONE、ANDROID_PAD、ANDROID_WATCH、IPAD、MACOS</p><p>最新版的Mirai官方建议使用MACOS登录协议，以防止账号无法登录的情况，如45、237、238等</p></blockquote><ul><li>第一次启动后，可以在 <code>mirai/config/Console/AutoLogin.yml</code> 里面设置自动登录（设置好后，下次启动<code>Mirai.cmd</code>就不用输入机器人登录命令了）</li></ul><p>参考如下设置:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">accounts:</span> <br>  <span class="hljs-bullet">-</span> <span class="hljs-comment"># 账号, 现只支持 QQ 数字账号</span><br>    <span class="hljs-attr">account:</span> <span class="hljs-string">输入你的QQ数字账号</span><br>    <span class="hljs-attr">password:</span> <br>      <span class="hljs-comment"># 密码种类, 可选 PLAIN 或 MD5</span><br>      <span class="hljs-attr">kind:</span> <span class="hljs-string">PLAIN</span><br>      <span class="hljs-comment"># 密码内容, PLAIN 时为密码文本, MD5 时为 16 进制</span><br>      <span class="hljs-attr">value:</span> <span class="hljs-string">输入你的密码（密码最好不要超过16位）</span><br>    <span class="hljs-comment"># 账号配置. 可用配置列表 (注意大小写):</span><br>    <span class="hljs-comment"># &quot;protocol&quot;: &quot;ANDROID_PHONE&quot; / &quot;ANDROID_PAD&quot; / &quot;ANDROID_WATCH&quot; / &quot;MACOS&quot; / &quot;IPAD&quot;</span><br>    <span class="hljs-comment"># &quot;device&quot;: &quot;device.json&quot;</span><br>    <span class="hljs-comment"># &quot;enable&quot;: true</span><br>    <span class="hljs-comment"># &quot;heartbeatStrategy&quot;: &quot;STAT_HB&quot; / &quot;REGISTER&quot; / &quot;NONE&quot;</span><br>    <span class="hljs-attr">configuration:</span> <br>      <span class="hljs-attr">protocol:</span> <span class="hljs-string">MACOS</span><br>      <span class="hljs-attr">device:</span> <span class="hljs-string">device.json</span><br>      <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br>      <span class="hljs-attr">heartbeatStrategy:</span> <span class="hljs-string">STAT_HB</span><br></code></pre></td></tr></table></figure><blockquote><p>注意：采用mirai反向代理得配置文件在mirai/config/net.mamoe.mirai-api-http/setting.yml</p><p>验证key和反向代理要与配置文件config/config.cfg中一样才能进行通信</p></blockquote><h3 id="33-启动go-cqhttp这个可以扫码登录qq当使用onebot机器人的时候"><a class="markdownIt-Anchor" href="#33-启动go-cqhttp这个可以扫码登录qq当使用onebot机器人的时候"></a> 3.3 启动go-cqhttp，这个可以扫码登录QQ（当使用Onebot机器人的时候）</h3><p><strong>简介：</strong><code>Onebot</code>是一个基于CQHTTP协议开发的聊天机器人框架，它支持多个平台（如QQ、微信、Telegram等），同时也提供了许多插件和工具，方便开发者创建自己的聊天机器人。Onebot提供了标准化的消息格式和事件处理机制，使得不同平台之间的开发变得更加简单和方便。</p><p><strong>简介：</strong><code>go-cqhttp</code>是一个使用Go语言编写的开源跨平台的机器人的HTTP插件，它通过HTTP协议将机器人接入到第三方平台，例如QQ群、Telegram和Discord等。它支持多个账号、多个协议、多个插件，可以满足各种不同场景下的需求。go-cqhttp提供了方便易用的API，可以帮助开发者快速构建自己的机器人应用。同时，它也支持插件机制，开发者可以通过插件来扩展其功能。由于其开源、跨平台、易用的特点，go-cqhttp已经成为了国内外开发者构建机器人应用的主要工具之一。</p><p>使用步骤：</p><ul><li>进入Releases下载 <a target="_blank" rel="noopener" href="https://github.com/Mrs4s/go-cqhttp/releases">go-cqhttp</a></li></ul><blockquote><p>注意：下载正确对应的版本</p><p>darwin是macos的</p><p>amd是X86架构的CPU，32位版；arm是ARM架构的CPU，32位版</p><p>amd64是X86架构的CPU，64位版；arm64是ARM架构的CPU，64位版</p></blockquote><ul><li>下载安装包到本地，解压后，运行其中的 <code>go-cqhttp.bat</code></li><li>输入<code>3</code>，会生成配置文件：<code>config.yaml</code></li><li>打开配置文件<code>config.yaml</code>，只需要配置两个地方：account和servers</li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">account:</span> <span class="hljs-comment"># 账号相关</span><br>  <span class="hljs-attr">uin:</span> <span class="hljs-string">输入机器人QQ账号</span> <span class="hljs-comment"># QQ账号</span><br>  <br>  <span class="hljs-comment"># 其他保持不动</span><br><br><span class="hljs-attr">servers:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">ws-reverse:</span><br>      <span class="hljs-attr">universal:</span> <span class="hljs-string">ws://localhost:6555/ws</span>  <span class="hljs-comment"># 与onebot信息设置一致才能通信</span><br>      <br>  <span class="hljs-comment"># 其他保持不动</span><br></code></pre></td></tr></table></figure><ul><li>再次运行 <code>go-cqhttp.bat</code>，生成虚拟文件，这一次不用扫码，只是为了生成虚拟设备文件，然后关闭即可</li><li>打开生成的虚拟文件：<code>device.json</code>，将其中的 <code>protocol</code>参数改成2</li><li>再重新启动 go-cqhttp，这时候可以扫码登录 QQ 了（注意 go-cqhttp 的启动网络要与扫码网络保持一致）</li></ul><h3 id="33-启动chatgpt"><a class="markdownIt-Anchor" href="#33-启动chatgpt"></a> 3.3 启动ChatGPT</h3><ul><li>设置好<code>chatgpt/config.cfg</code>点击启动 <code>ChatGPT.cmd</code> ，自动会登录 <code>openai</code></li></ul><p>一个简单的基于mirai启动的配置文件实例：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs yaml">[<span class="hljs-string">mirai</span>]<br><span class="hljs-string">qq</span> <span class="hljs-string">=</span> <span class="hljs-string">请修改为你机器人的QQ号（小号）</span><br><br><span class="hljs-string">manager_qq</span> <span class="hljs-string">=</span> <span class="hljs-string">请修改为机器人管理员的QQ号（大号）</span><br><br><span class="hljs-string">api_key</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;1234567890&quot;</span><br><span class="hljs-string">reverse_ws_host</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;0.0.0.0&quot;</span><br><span class="hljs-string">reverse_ws_port</span> <span class="hljs-string">=</span> <span class="hljs-number">8554</span><br><span class="hljs-comment"># # 下面是 mirai api http 正向连接模式</span><br><span class="hljs-comment"># 使用此模式时需注释上面的反向连接模式</span><br><span class="hljs-comment"># http_url = &quot;http://localhost:8080&quot;</span><br><span class="hljs-comment"># ws_url = &quot;http://localhost:8080&quot;</span><br><br>[<span class="hljs-string">openai</span>]<br><span class="hljs-string">browserless_endpoint</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;https://bypass.duti.tech/&quot;</span><br><br><span class="hljs-comment"># 第一个账号</span><br>[[<span class="hljs-string">openai.accounts</span>]]<br><span class="hljs-string">mode</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;browserless&quot;</span><br><br><span class="hljs-comment"># 你的 OpenAI 邮箱</span><br><span class="hljs-string">email</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;xxxx&quot;</span><br><span class="hljs-comment"># 你的 OpenAI 密码</span><br><span class="hljs-string">password</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;xxx&quot;</span><br><br><span class="hljs-comment"># clash代理的端口号</span><br><span class="hljs-string">proxy=&quot;http://127.0.0.1:7890&quot;</span><br><br><span class="hljs-comment"># 使用 ChatGPT Plus（plus 用户此项设置为 true 使用 legacy 模型）</span><br><span class="hljs-string">paid</span> <span class="hljs-string">=</span> <span class="hljs-literal">false</span><br><br><span class="hljs-comment"># 是否开启标题自动重命名</span><br><span class="hljs-string">title_pattern=&quot;qq-&#123;session_id&#125;&quot;</span><br><br><span class="hljs-comment"># 是否自动删除旧的对话，开启后用户发送重置对话时会自动删除以前的会话内容</span><br><span class="hljs-string">auto_remove_old_conversations</span> <span class="hljs-string">=</span> <span class="hljs-literal">true</span><br><br><span class="hljs-comment"># 第二个账号</span><br>[[<span class="hljs-string">openai.accounts</span>]]<br><br><span class="hljs-string">api_key=&quot;sk-xxxxx&quot;</span><br><br><span class="hljs-string">proxy=&quot;http://127.0.0.1:7890&quot;</span><br><br><span class="hljs-comment"># 是否开启标题自动重命名</span><br><span class="hljs-string">title_pattern=&quot;qq-&#123;session_id&#125;&quot;</span><br><br><span class="hljs-comment"># 是否自动删除旧的对话，开启后用户发送重置对话时会自动删除以前的会话内容</span><br><span class="hljs-string">auto_remove_old_conversations</span> <span class="hljs-string">=</span> <span class="hljs-literal">true</span><br><br>[<span class="hljs-string">baiducloud</span>]<br><span class="hljs-comment">#是否启动百度云内容安全审核</span><br><span class="hljs-string">check</span> <span class="hljs-string">=</span> <span class="hljs-literal">false</span><br><br><span class="hljs-comment">#百度云API_KEY 24位英文数字字符串</span><br><span class="hljs-string">baidu_api_key</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-comment">#百度云SECRET_KEY 32位的英文数字字符串</span><br><span class="hljs-string">baidu_secret_key</span> <span class="hljs-string">=&quot;&quot;</span><br><br><span class="hljs-comment">#不合规消息自定义返回</span><br><span class="hljs-string">illgalmessage</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;[百度云]请珍惜机器人，当前返回内容不合规&quot;</span><br><br>[<span class="hljs-string">system</span>]<br><span class="hljs-comment"># 是否自动同意进群邀请</span><br><span class="hljs-string">accept_group_invite</span> <span class="hljs-string">=</span> <span class="hljs-literal">false</span><br><span class="hljs-comment"># 是否自动同意好友请求</span><br><span class="hljs-string">accept_friend_request</span> <span class="hljs-string">=</span> <span class="hljs-literal">false</span><br><br>[<span class="hljs-string">presets</span>]<br><span class="hljs-comment"># 切换预设的命令： 加载预设 猫娘</span><br><span class="hljs-string">command</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;加载预设 (\\w+)&quot;</span><br><span class="hljs-string">loaded_successful</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;预设加载成功！&quot;</span><br><span class="hljs-string">scan_dir</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;./presets/&quot;</span><br><br>[<span class="hljs-string">presets.keywords</span>]<br><span class="hljs-comment"># 预设关键词 &lt;-&gt; 实际文件</span><br><span class="hljs-string">&quot;正常&quot;</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;presets/default.txt&quot;</span><br><span class="hljs-string">&quot;猫娘&quot;</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;presets/catgirl.txt&quot;</span><br><span class="hljs-comment"># &quot;default&quot; = &quot;presets/default.txt&quot; # 默认预设，开启后所有的会话都会先读这个预设，谨慎使用！</span><br></code></pre></td></tr></table></figure><ul><li>登录成功后，说明 <code>QQ</code> 机器人已经连接上了 <code>ChatGPT</code>，此时即可跟机器人聊天了</li></ul><h2 id="4-linux下一键快速部署"><a class="markdownIt-Anchor" href="#4-linux下一键快速部署"></a> 4. Linux下一键快速部署</h2><p>在linux服务器上输入最新版的命令即可，命令基于docker容器技术，会自动安装docker并拉取最新版的镜像。</p><p>配置文件路径和功能与Windows几乎一致，请参考前文的配置信息。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># chatgpt-qq下的文件</span><br>tree<br>.<br>├── config.cfg<br>├── docker-compose.yaml<br>└── mirai<br>    ├── config<br>    │   ├── Console<br>    │   │   ├── AutoLogin.yml<br>    │   │   ├── Command.yml<br>    │   │   ├── Logger.yml<br>    │   │   ├── PermissionService.yml<br>    │   │   └── PluginDependencies.yml<br>    │   └── net.mamoe.mirai-api-http<br>    │       └── setting.yml<br>    └── data<br>        └── xyz.cssxsh.mirai.mirai-device-generator<br></code></pre></td></tr></table></figure><ul><li><code>config.cgf</code> 是配置 openai 和 QQ 的文件（修改文件后重新运行即可<code>docker-compose up -d</code>）</li><li><code>docker-compose.yml</code> 指定了需要启动的容器、服务、映像等信息</li><li><code>AutoLogin.yml</code> 是 mirai 的自动登录配置</li><li><code>setting.yml</code> 是包含 mirai 的 api 接口信息</li></ul><p>一键安装命令本质是执行一个shell脚本，用于自动部署chatgpt-mirai-qq-bot程序。下面是脚本的功能：</p><ul><li>自动检测curl，docker和docker-compose是否已安装，如果未安装，则提示安装并安装；</li><li>下载docker-compose.yaml和config.cfg文件；</li><li>对config.cfg文件进行相应修改；</li><li>创建setting.yml文件；</li></ul><p>需要用户输入的信息有：</p><ul><li>OpenAI的API Key;</li><li>OpenAI的邮箱地址和密码;</li><li>QQ机器人账号和密码;</li><li>……</li></ul><p>如果程序已经安装，则提示无法重复安装，并提供升级和重装的命令。</p><p>如果用户选择升级，则进行 <code>docker-compose pull</code>和 <code>docker-compose up -d</code> 操作。</p><ul><li><code>docker-compose up -d</code> 后台启动所有容器（在 docker-compose.yaml 里面都写好）</li><li><code>docker-compose logs chatgpt -f</code> 来查看chatgpt的实时日志</li></ul><h2 id="5-其他"><a class="markdownIt-Anchor" href="#5-其他"></a> 5. 其他</h2><h3 id="51-常用命令"><a class="markdownIt-Anchor" href="#51-常用命令"></a> 5.1 常用命令</h3><h4 id="511-切换ai-xxx"><a class="markdownIt-Anchor" href="#511-切换ai-xxx"></a> 5.1.1 切换AI xxx</h4><p>切换至另一个 AI 引擎。<br>目前支持的有：</p><ul><li>chatgpt-web - OpenAI ChatGPT 网页版</li><li>chatgpt-api - OpenAI ChatGPT API 版</li><li>bing-c - New Bing (新必应对话风格-创造力)</li><li>bing-p - New Bing (新必应对话风格-精确)</li><li>bing-b - New Bing (新必应对话风格-平衡)</li></ul><h4 id="512-文本模式"><a class="markdownIt-Anchor" href="#512-文本模式"></a> 5.1.2 文本模式</h4><p>开启后，接下来的消息都用文字的方式回复。</p><h4 id="513-图片模式"><a class="markdownIt-Anchor" href="#513-图片模式"></a> 5.1.3 图片模式</h4><p>开启后，接下来的消息都用图片的方式回复。</p><h4 id="514-重置会话"><a class="markdownIt-Anchor" href="#514-重置会话"></a> 5.1.4 重置会话</h4><p>清空机器人的记忆，重新开始聊天。</p><h4 id="515-回滚会话"><a class="markdownIt-Anchor" href="#515-回滚会话"></a> 5.1.5 回滚会话</h4><p>相当于撤回消息，让机器人忘记你最后一次发的内容。</p><h4 id="516-加载预设-xxx"><a class="markdownIt-Anchor" href="#516-加载预设-xxx"></a> 5.1.6 加载预设 xxx</h4><p>让机器人加载某个特定的预设。 对于预设的玩法，请见右侧菜单。</p><h4 id="517-画-xxx-或-画-一张图片"><a class="markdownIt-Anchor" href="#517-画-xxx-或-画-一张图片"></a> 5.1.7 画 xxx 或 画 + 一张图片</h4><p>最低版本: 2.2.0</p><p>通过 DALL.E 进行 AI 画图(<strong>需要你设置 OpenAI 的 api_key</strong>)</p><h3 id="52-管理员命令"><a class="markdownIt-Anchor" href="#52-管理员命令"></a> 5.2 管理员命令</h3><h4 id="521-重新加载配置文件"><a class="markdownIt-Anchor" href="#521-重新加载配置文件"></a> 5.2.1 .重新加载配置文件</h4><p>让机器人的配置文件重新加载</p><h4 id="522-设置额度"><a class="markdownIt-Anchor" href="#522-设置额度"></a> 5.2.2 设置额度</h4><h2 id="安装后效果示例"><a class="markdownIt-Anchor" href="#安装后效果示例"></a> 安装后效果示例</h2><p><img src="https://blog-1314109265.cos.ap-nanjing.myqcloud.com/202303132001567.png" srcset="/img/loading.gif" lazyload alt="img"></p><p><img src="https://blog-1314109265.cos.ap-nanjing.myqcloud.com/202303132001474.png" srcset="/img/loading.gif" lazyload alt="img"></p><h2 id="常见错误分析"><a class="markdownIt-Anchor" href="#常见错误分析"></a> 常见错误分析</h2><p>在连接 ChatGPT 和 QQ 的过程中，可能会出现以下一些错误：</p><ol><li>环境配置错误：Mirai 或 Onebot 的环境配置不正确，例如缺少依赖库、配置文件格式错误等，都可能导致启动失败。</li><li>登录信息错误：在配置文件中输入的 QQ 号码或密码错误，或者验证码输入错误，都可能导致登录失败。</li><li>网络连接错误：在与 QQ 进行通信的过程中，可能会出现网络连接问题，例如服务器繁忙、网络延迟等，导致消息发送失败或响应超时。</li><li>API 使用错误：在调用 API 的过程中，可能会出现参数不正确、接口不存在、API 版本不匹配等问题，导致请求失败。</li><li>安全问题：如果 Mirai 或 Onebot 的权限设置不当，可能会导致账号信息泄露、恶意攻击等安全问题。</li><li>代码错误：在编写 ChatGPT 的代码时，可能会出现语法错误、逻辑错误等问题，导致程序无法正常运行。</li></ol><p>针对这些错误，可以通过仔细检查配置文件、排查网络连接问题、检查 API 使用等方式来解决。同时，也可以参考github中的解决方案和文档，以及向相关技术人员寻求帮助。</p><blockquote><p>注意抓住几个核心问题：</p><ul><li>在哪一步报错的</li><li>报什么错</li><li>有可能是什么原因导致的</li></ul></blockquote><h2 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h2><p>以上就是部署QQ机器人的流程，当然还有很多功能等着大家探索，可以根据自己的喜好调整，自己探索把。</p></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/%E6%8A%80%E6%9C%AF%E5%B7%A5%E5%85%B7/" class="category-chain-item">技术工具</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/ChatGPT/" class="print-no-link">#ChatGPT</a></div></div><div class="license-box my-3"><div class="license-title"><div>将ChatGPT接入QQ机器人</div><div>https://fulequn.github.io/2023/03/Article202303181/</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>Fulequn</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2023年3月18日</div></div><div class="license-meta-item"><div>许可协议</div><div><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/2023/03/Article202303182/" title="如何修改Conda默认虚拟环境路径和缓存路径"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">如何修改Conda默认虚拟环境路径和缓存路径</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/2023/03/Article202303054/" title="如何判断树莓派通过GPIO与5G模块成功连接？"><span class="hidden-mobile">如何判断树莓派通过GPIO与5G模块成功连接？</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>目录</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t,e){var i=Fluid.plugins.typing,n=e.getElementById("subtitle");n&&i&&i(n.getAttribute("data-typed-text"))}(window,document)</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js",(function(){var t=jQuery("#toc");if(0!==t.length&&window.tocbot){var i=jQuery("#board-ctn").offset().top;window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-i},CONFIG.toc)),t.find(".toc-list-item").length>0&&t.css("visibility","visible"),Fluid.events.registerRefreshCallback((function(){if("tocbot"in window){tocbot.refresh();var t=jQuery("#toc");if(0===t.length||!tocbot)return;t.find(".toc-list-item").length>0&&t.css("visibility","visible")}}))}}))</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",(function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback((function(){if("anchors"in window){anchors.removeAll();var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}}))}))</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",(function(){Fluid.plugins.fancyBox()}))</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>